# A06:2021 الثغرات و الانظمة الغير قابلة للتحديثات

## العوامل

| ربطها مع CWEs | الحد الأقصى للحدوث | متوسط معدل الحدوث | التغطية القصوى | متوسط معدل التغطية | متوسط استغلال الثغرات | متوسط التأثير | إجمالي التكرار | إجمالي نقاط الضعف CVEs |
|---------------|--------------------|-------------------|----------------|--------------------|-----------------------|---------------|----------------|------------------------|
| 3             | 27.96%             | 8.77%             | 51.78%         | 22.47%             | 5.00                  | 5.00          | 30,457         | 0                      |



## نظرة عامة


كانت تحتل المرتبة الثانية في عملية الاستطلاع التي تم اجراءها في قطاع الامن السيبراني ولكنها أيضا تمتلك بيانات كافية لتصبح من أعلى عشر مخاطر من خلال تحليل البيانات. يعتبر تصنيف "الثغرات والانظمة الغير قابلة للتحديثات" من المشاكل المعروفة التي نواجه صعوبات من اجل اختبارها وتقييم مخاطرها وتعتبر التصنيف الوحيدة التي لا يتضمن CVEs مرتبطة بـ CWEs. لذلك تم استخدام معيار الاستغلال أو التأثير بالقيم الافتراضية وهي 5.0. ومن الملحوظ ان نقاط CWEs هي (CWE - 1104) وهي مرتبطة باستخدام مكونات الطرف الثالث والتي لم يتم الاشراف عليها وهي مرتبطة بأعلى عشر مخاطر لعامي 2013  و2017.
.

## الوصف 

من المحتمل ان تكون عرضة للاختراق: 

-   إذا كنت لا تعرف إصدارات جميع المكونات التي تستخدمها (من جانب المستخدم ومن جانب الخادم). وهذا يتضمن المكونات التي تستخدمها مباشرةً بالإضافة إلى المكونات الفرعية المستخدمة.

-   إذا كان البرنامج عرضة للاختراق أو غير مدعوم أو قديم. يتضمن ذلك نظام التشغيل وخادم الويب أو التطبيقات ونظام إدارة قواعد البيانات (DBMS) والتطبيقات وواجهات برمجة التطبيقاتAPI وجميع المكونات وبيئات التي تعمل مع التشغيل (runtime) والمكتبات.

-   إذا لم تقم بالمسح الأمني عن الثغرات بانتظام والاشتراك في نشرات الأمن المتعلقة بالمكونات التي تستخدمها.

-   • إذا لم تقم بإصلاح أو ترقية النظام الأساسي والأطر والتبعيات الأساسية بطريقة قائمة على تقييم المخاطر وفي الوقت المناسب. يحدث هذا عادةً في البيئات التي يكون فيها اغلاق الثغرات وتنصيب التحديثات مهمة شهرية أو ربع سنوية تحت إدارة التغييرات، مما يترك المؤسسات عرضة للمدة أيام أو شهور من عدم تحديث الثغرات الضرورية.

-   إذا لم يقم مطورو البرامج باختبار توافق المكتبات المحدثة أو المصححة

-   إذا لم تقم بتأمين الاعدادات بالشكل السليم. (انظر A05: 2021 – الاعدادات الخاطئة).

## كيفية الحماية منها 

يجب أن تكون هناك عملية لإدارة اغلاق الثغرات وذلك لتلبية ما يلي:

-   إزالة المكونات الغير المستخدمة والميزات والملفات والوثائق الغير الضرورية.

-   عمل جرد بشكل دوري لإصدارات كل من جانب المستخدم والمكونات من جانب الخادم (على سبيل المثال، أطر العمل والمكتبات) ومكوناتها باستخدام أدوات مثل versions, OWASP Dependency Check, retire.js، وما إلى ذلك، مراقبة المصادر باستمرار مثل CVE وNVD بحثًا عن الثغرات في المكونات. وقم باستخدام أدوات تحليل اعدادات البرامج لأتمتة العملية. وقم بالاشتراك في تنبيهات البريد الإلكتروني الخاصة بالثغرات الأمنية المتعلقة بالمكونات التي تستخدمها.

-   الحصول على المكونات من المصادر الرسمية فقط عبر الروابط الآمنة. يفضل التأكد من ان الحزم موقعه رقمياً لتقليل فرصة تثبيت مكونات معدلة وضارة (انظر A08: 2021- فشل سلامة البيانات والبرمجيات).

-   مراقبة المكتبات والمكونات التي لا يتم صيانتها أو التي لا تقوم بعمل تحديثات الأمان للإصدارات الأقدم. إذا لم يكن عملية سد الثغرات ممكنًا، ففكر في انشاء آلية افتراضي لمراقبة تلك المكونات ورصد المحاولات الضارة والحماية منها.

يجب أن تضمن كل مؤسسة خطة مستمرة للمراقبة، وتصنيف، وتطبيق التحديثات أو تغيير الاعدادات طوال الحياة الافتراضية للتطبيقات.

## أمثلة على سيناريوهات الهجوم

**سيناريو #1:** 
تعمل المكونات عادةً بنفس الامتيازات التي يتمتع بها التطبيق نفسه، لذا فإن العيوب في أي مكون يمكن أن تؤدي إلى تأثير خطير.  يمكن أن تكون هذه العيوب عرضية (على سبيل المثال، الأخطاء البرمجية) أو عيوب مقصودة (على سبيل المثال، باب خلفي في أحد المكونات).  بعض الأمثلة على ثغرات المكونات القابلة للاستغلال التي تم اكتشافها هي:

-  تم إلقاء اللوم على CVE-2017-5638، وهي ثغرة أمنية في تنفيذ التعليمات البرمجية عن بُعد لـ Struts 2 والتي تتيح تنفيذ تعليمات برمجية عشوائية على الخادم، والتي تسبب اختراقات خطيرة.

-  على الرغم من صعوبة أو استحالة تحديث إنترنت الأشياء (IoT)، إلا أن أهمية تحديثها يمكن ان يكون له أهمية كبيرة (مثل الأجهزة الطبية).

هناك أدوات آلية لمساعدة المهاجمين في العثور على أنظمة غير محدثة أو معدة بشكل خاطئ.  على سبيل المثال، يمكن أن يساعدك محرك بحث Shodan IoT في العثور على الأجهزة التي لا تزال تعاني من الثغرة الأمنية Heartbleed والتي تم سدها وتحديثها في أبريل من عام 2014.

## المصادر

-   OWASP Application Security Verification Standard: V1 Architecture,
    design and threat modelling

-   OWASP Dependency Check (for Java and .NET libraries)

-   OWASP Testing Guide - Map Application Architecture (OTG-INFO-010)

-   OWASP Virtual Patching Best Practices

-   The Unfortunate Reality of Insecure Libraries

-   MITRE Common Vulnerabilities and Exposures (CVE) search

-   National Vulnerability Database (NVD)

-   Retire.js for detecting known vulnerable JavaScript libraries

-   Node Libraries Security Advisories

-   [Ruby Libraries Security Advisory Database and Tools]()

-   https://safecode.org/publication/SAFECode_Software_Integrity_Controls0610.pdf

## قائمة الربط مع إطار CWEs

CWE-937 OWASP Top 10 2013: Using Components with Known Vulnerabilities

CWE-1035 2017 Top 10 A9: Using Components with Known Vulnerabilities

CWE-1104 Use of Unmaintained Third Party Components
