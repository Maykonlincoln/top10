# A09:2021 – فشل عملية تسجيل الاحداث والمراقبة 

## العوامل

| ربطها مع CWEs | الحد الأقصى للحدوث | متوسط معدل الحدوث | التغطية القصوى | متوسط معدل التغطية | متوسط استغلال الثغرات | متوسط التأثير | إجمالي التكرار | إجمالي نقاط الضعف CVEs |
|---------------|--------------------|-------------------|----------------|--------------------|-----------------------|---------------|----------------|------------------------|
| 4             | 19.23%             | 6.51%             | 53.67%         | 39.97%             | 6.87                  | 4.99          | 53,615         | 242                    |



## نظرة عامة

شهد تسجيل ومراقبه الاحداث ارتفاع بسيط من المرتبة العاشرة في اعلى عشره مخاطر لعام 2017 الى المرتبة التاسعة في استطلاع الذي تم اجرائه في قطاع الامن السيبراني. حيث يشكل تسجيل ومراقبه الاحداث تحديا لإيجاد طريقة لاختباره، غالبا ما يتطلب ‏مقابلات او واستفسارات ما ان كانت الهجمات تم اكتشفها اثناء اختبار الاختراق. لا يوجد لهذا التصنيف الكثير من بيانات في قاعدتي بيانات cve/cvss,، ولكن عملية الاكتشاف والرصد والاستجابة لهذا التصنيف امر في غاية الأهمية. مع ذلك يمكن ان يكون مؤثرا عدم فعالية المراقبة للأحداث على الانتباه للإنذارات والتي قد تسبب الحوادث او عند القيام بالتحاليل الجنائي 
هذا التصنيف يرتبط بي CWE-778  وكذلك CWE-117  و CWE-223 وCWE-532. 


## الوصف 

وعند العودة الى أعلى عشر مخاطر لعام 2021، يقوم هذا التصنيف بالمساعدة على رصد واكتشاف والاستجابة للثغرات النشطة او لعمليات الاختراق التي تحدث، ومن غير عملية تسجيل الاحداث ومراقبتها، لن تستطيع اكتشاف او رصد او حتى الاستجابة للاختراقات التي تحدث، لذلك وجود عملية تسجيل الاحداث ومراقبتها يساعد على الاستجابة في أي وقت:

-   الاحداث القابلة لإجراءات التدقيق والمتابعة، مثل عمليات تسجيل الدخول الفاشلة والناجحة منها وكذلك عمليات النقل العالية التي لم يتم تسجيلها.

-   التنبيهات والانذارات لا يتم تسجيلها او يتم تسجيلها من دون وصف واضح او رساله واضحها.

-   لا يتم متابعة وتسجيل الاحداث ومراقبتها للتطبيقات او واجهة برمجة التطبيقات API لأي أنشطة ضارة.

-   يتم تخزين سجلات الاحداث محليا فقط 

-   وضع معايير مناسبه للتنبيهات الأمنية مثل ( حد للعمليات تسجيل الدخول) ،وكذلك إيجاد سياسة واضحة لعملية تصعيد التنبيهات الأمنية والعمل عليها بالشكل الصحيح.

-   عدم وجود أي إنذارات عند اجراء اختيارات الاختراق او الفحص بواسطة أداة DAST مثل OWASP ZAP 

-   التطبيقات لا تستطيع اكتشاف وتصعيد او حتى عملية التنبيه عند وجود أنشطة ضارة تحدث في الوقت الحالي.

انت معرض لتسريب البيانات والمعلومات في حال عدم ضبطك لعملية تسجيل الاحداث والتنبيهات بالشكل الصحيح والتي قد تسمح للمستخدم  او حتى المهاجم من مشاهدتها انظر الى (A02- تخطي صلاحيات الوصول.)

## كيفية الحماية منها 

يجب على المطورين تطبيق بعض  او جميع عناصر التحكم التالية والذي يعتمد على مدى استهداف ومخاطر التطبيق:

-   يجب التأكيد على ان جميع عمليات الدخول، التحكم بالوصول، والمدخلات التي تحدث على جانب الخادم مسجلة بطريقة صحيح وواضحة، وذلك لكشف عمليات الضارة التي تساعدك فيما بعد في عملية التحليل الجنائي الرقمي.

-   التأكد ان عمليات تسجيل الاحداث تتم بشكل منسق وصحيح وذلك لكي يتم ادارتها بشكل صحيح.

-   التأكد من ان البيانات مشفرة بالشكل الصحيح وذلك للحماية من عمليات الحقن او الهجمات التي قد تحدث على انظمة المراقبة.

-   التأكد من ان عمليات نقل البيانات الحساسة تتم مراقبتها وكذلك التأكد من سلامتها وذلك لسلامتها من التخريب او التلاعب او الحذف.

-   يجب ان يكون لدى فريق DevSecOps آلية فعالة لعملية المراقبة والتي تقوم بعملية الاكتشاف والاستجابة للتنبيهات، مثل الأنشطة الضارة. ومن اهم المرتكزات هي سرعة الاكتشاف والاستجابة لها.

-   قم بإيجاد خطة للاستجابة للحوادث السيبرانية وتستطيع الاعتماد على NIST 800-61r2 او النسخ الاحدث ان توفرت.

هناك تطبيقات و اطر  مفتوحة المصدر وتجارية مثل (OWASP ModSecurity Core Rule Set,، open-source log) وهنا كذلك منصات تقوم بعملية جمع وربط الاحداث مثل منصة ELK stack والتي تتيح لك مميزات إضافية منها لوح للمراقبة وكذلك تنبيهات.

##  أمثلة على سيناريوهات الهجوم

**سيناريو #1:** ‎المشغّل لموقع تابع لشركة تؤمّن خطط التأمين الطبي للأطفال لم يتمكن من اكتشاف ثغرة امنية لعدم توفر أدوات تسجيل الاحداث الأمنية ومراقبتها. حيث قام أحد الأطراف الخارجية بإبلاغ شركة التأمين الطبي عن وجود هجمة سيبرانية تضمنت الدخول والتعديل على آلاف السجلات الصحية لأكثر من 3.5 مليون طفل. وفي التقرير المعدّ بعد الهجمة وُجِد أن مطوّري موقع الويب أهملوا نقاط ضعف امنية مهمّة. ولعدم وجود أدوات تسجيل الاحدث الأمنية ومراقبتها، قد يكون تسريب البيانات قد حدث من بداية عام 2013 وامتد الى أكثر من 7 سنوات.

**سيناريو #2:** ‎ واجهت شركة طيران هندية كبرى تسريب بيانات يضم بيانات جُمعت لأكثر من عشر سنوات لمعلومات مسافريها الشخصية مما يتضمن بيانات الجوازات والبطاقات البنكية. تسريب البيانات حدث في خدمة تخزين سحابية من موفّر خدمات سحابية والذي قام بدوره بتنبيه شركة الطيران بوجود التسريب بعد مدة.

**سيناريو #3:** ‎عانت شركة طيران أوروبية كبرى من تسريب ضمن لائحة النظام العام لحماية البيانات (GDPR). وقد عُلم أن التسريب حدث بسبب ثغرات في نظام الدفع تم استغلالها من قبل منفذي الهجوم والذين جمعوا سجلات الدفع لأكثر من 400,000 عميل. نتيجة لذلك، قام مشرّع الخصوصية بتغريم شركة الطيران 20  مليون باوند.

## المصادر

-   [OWASP Proactive Controls: Implement Logging and
    Monitoring](https://owasp.org/www-project-proactive-controls/v3/en/c9-security-logging.html)

-   [OWASP Application Security Verification Standard: V8 Logging and
    Monitoring](https://owasp.org/www-project-application-security-verification-standard)

-   [OWASP Testing Guide: Testing for Detailed Error
    Code](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/01-Testing_for_Error_Code)

-   [OWASP Cheat Sheet:
    Logging](https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html)

-   [Data Integrity: Recovering from Ransomware and Other Destructive
    Events](https://csrc.nist.gov/publications/detail/sp/1800-11/final)

-   [Data Integrity: Identifying and Protecting Assets Against
    Ransomware and Other Destructive
    Events](https://csrc.nist.gov/publications/detail/sp/1800-25/final)

-   [Data Integrity: Detecting and Responding to Ransomware and Other
    Destructive
    Events](https://csrc.nist.gov/publications/detail/sp/1800-26/final)

## قائمة الربط مع إطار CWEs

CWE-117 Improper Output Neutralization for Logs

CWE-223 Omission of Security-relevant Information

CWE-532 Insertion of Sensitive Information into Log File

CWE-778 Insufficient Logging
