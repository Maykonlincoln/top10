
# مقدمة الى   أعلى عشر مخاطر لعام 2021 حسب تصنيف منظمة آواسب 


مرحبا بكم في أحدث اصدار من اعلى عشر مخاطر من منظمة آواسب وهي النسخة الحديثة لعام 2021، والتي تأتي بشكل جديد كلياً ومدعمة برسومات انفوجرافيك التي تستطيع طابعتها واستخدامها ويمكن الحصول عليها من صفحتنا الرئيسية.

كما نتقدم بالشكر الجزيل لكل من ساهم بوقته وبياناته من اجل الخروج بهذا الجهد الذي لا يمكن الخروج به لولا دعمكم. 
شكراً لك 



## ماهي التغيرات التي طرأت على أعلى عشر مخاطر لعام 2021

بشكل عام تم اضافة 3 تصنيفات جديدة، و 4 تصنيفات تم تغير الاسم وكذلك النطاق الخاص بها، وبعض عمليات الدمج التي تأتي مع TOP 10  لعام 2021


<img src="./assets/image1.png" style="width:6.5in;height:1.78889in" alt="Mapping of the relationship between the Top 10 2017 and the new Top 10 2021" />

**A01:2021-تخطي صلاحيات الوصول**احتل (تخطي صلاحيات الوصول) المرتبة الأولى بعد ان كان في الترتيب الخامس، حيث انه تم اجراء اختبار لنقاط الضعف وكانت النسبة هي 94% من التطبيقات مصابه بتخطي صلاحيات الوصول، ان تخطي صلاحيات الوصول والمرتبط بـ34 CWEs هو من اكثر الثغرات التي تحدث على مستوى التطبيقات. 

**A02:2021-فشل آلية التشفير** يأتي فشل آلية التشفير في المرتبة رقم #2 والتي كانت تعرف بالبيانات الحساسة الغير محمية او المكشوفة، والتي قد تكون أسبابها متعددة دون ان تعود جميعها لسبب جذري واحد، ويأتي التركيز هنا بشكل متجدد على حالات الفشل في الطرق المتعلقة بالتشفير والتي غالباً ما تؤدي الى كشف غير مصرح به الى بيانات حساسة او اختراق الأنظمة. 

**A03:2021-الحقن** تتراجع الحقن الى الخطر رقم 3. حيث انه تم اجراء اختبار لنقاط الضعف وكانت النسبة هي 94% من التطبيقات مصابه بثغرات الحقن. ان ثغرة الحقن والمرتبطة بـ 33 CWEs تعتبر ثاني اعلى ثغرة من الثغرات التي من الممكن إصابة التطبيقات بها. والجدير بالذكر ان ثغرات XSS تم دمجها هنا مع ثغرة الحقن في هذه النسخة.

**A04:2021-التصميم الغير الامن** هو تصنيف جديد تم أضافته في هذه النسخة لعام 2021، والتي تركز على المخاطر المتعلقة بعيوب وأخطاء التصميم. وإذا أردنا التحرك لأثبات أهمية التصميم الامن فنحن بحاجة الى نمذجة التهديدات وطرق التصميم الأمنه وكذلك وجود بنية التحتية مبنية على افضل المراجع وامتثالات. 

**A05:2021-الاعدادات الخاطئة** بعد ان كان هو الخطر رقم #6 الان نراه في المرتبة #4، حيث انه تم اجراء اختبار لنقاط الضعف وكانت النسبة هي 90% من التطبيقات كانت توجد بها أخطاء في طريقة الاعدادات الصحيحة. وهذا يحدث مع البرمجيات الحديثة والتي تستلزم تغير الاعدادات بشكل مستمر مما يجعل نسبة الخطاء في ارتفاع وهذا الذي جعل (الاعدادات الخاطئة) ترتفع من المرتبة السادسة الى الرابعة. والجدير بالذكر انه تم ضم " XML External Entities XXE" لهذا النوع من الإعدادات الخاطئة.

**A06:2021-الثغرات و الانظمة الغير قابلة للتحديثات** سابقاً كانت تعرف بـ “استخدام الأنظمة والمنتجات ذات ثغرات معروفة". وبناء على استطلاع كانت هي #2 اعلى ثغرة على مستوى خطر المنتجات. ومن خلال التحليل للبيانات وبعد ان كانت هي الخطر رقم #9 في الإصدار السابق لعام #2017 ارتفعت في اصدار #2021 الى الخطر رقم #6. وعند النظر الى معايير CVEs او CWEs لا نرى لها أي تصنيف للخطورة. ولذلك يتم تصنيف خطورتها بشكل افتراضي بناء على مستوى التأثير وهو 5.0.

**A07:2021-الهوية و فشل عملية التحقق** والتي كانت تعرف في الإصدارات السابقة "فشل المصادقة" وبعد ان كانت كذلك هي الخطر رقم #2. وبعد عملية ربطها مع إطار CWEs وتسميتها بـ “فشل عملية التحقق". وكما نقول ان زيادة المعايير ادت الى تقليل المخاطر ولكن ليس بشكل كامل لذلك نراها من ضمن أعلى عشر مخاطر هنا.

**A08:2021-فشل سلامة البيانات والبرمجيات** تم إضافتها حديثاً في هذا الاصدار 2021. والتي تركز بشكل كبير على تحديث البرمجيات والبيانات مع التأكيد على عدم تأثر سلامة دورة حياة CI/CD. وعند النظر الى تقييم للمخاطر المحتملة حسب تصنيف CVE/CVSS وارتباطها مع CWEs نجد ان تقييم الخطر هو 10 ويعتبر مرتفع جداً. الجدير بالذكر ان "Insecure Deserialization" اصبحت جزء من هذا التصنيف. 

**A09:2021-فشل عملية تسجيل الاحداث والمراقبة** والتي كانت تعرف سابقاً بـ “تسجيل الاحداث والمراقبة بشكل غير صحيح". وبعد عمل الاستطلاع رقم 3. تم صعودها مرتبه واحده بعد ان كانت في المرتبة 10. الجدير بالذكر ان هناك العديد من عمليات الفشل التي تحدث في المراقبة وتسجيل الاحداث تم ضمها هنا.  وحينما نرى CVE/CVSS لا نرى لها اي تصنيف واضح ولكن مع القصور في عمليات المراقبة وتسجيل الاحداث والتي تشكل تأثيرًا بالغاً في عملية التغطية على مستوى الأنظمة، والتنبيه في حال وجود حوادث او الاستفادة منها في عمليات التحقيق الجنائي الرقمي.

**A10:2021-تزوير الطلبات من جانب الخادم SSRF** تم اضافة هذا التصنيف بناءً على الاستطلاع رقم #1. وتظهر البيانات حسب الاختبارات التي تم اجراءها ان هذا التصنيف معدل الاصابة به فوق المتوسط مع ارتفاع منخفض. ومدى ارتباطه بمعدل التأثير وإمكانية الاستغلال. ويفيد المختصين في المجال ان وجود هذا التصنيف من ضمن المخاطر هو امر مهم جداً حتى وان كانت البيانات الحالية غير متكاملة في الوقت الحالي.

## المنهجية

لأول مره يتم الاعتماد على البيانات في تصنيف أعلى عشر مخاطر ويجب التنويه انها لا تعتمد على البيانات بشكل كلي. حيث تم اختيار ثمان تصنيفات من أصل عشرة بناء على البيانات واثنين منهم بناء على الاستطلاع الذي تم اجراءه في نطاق المخاطر. وتقوم منظمة آواسب بالاعتماد على البيانات السابقة أكثر من أي من المصادر أخرى وذلك بسبب ان الباحثين في امن التطبيقات يستغرقون وقت وجهد كبيرين في إيجاد الثغرات او طرق جديدة لاستغلالها. مما يجعل عملية التحقق من النتائج والأدوات والطرق المستخدمة يستغرق وقت أكبر وقد تصل الى سنوات. ولتحقيق التوازن قمنا باستخدام استطلاع على المخاطر التي تستهدف صناعة امن التطبيقات وقمنا بتوجيه أسئلة للمختصين عن نقاط الضعف التي قد لا تظهرها البيانات.

وكما ان هناك بعض التغيرات الجوهرية التي تم اعتمادها من قبل منظمة آواسب لمواصلة المنهجية المتبعة في تصنيف أعلى عشر مخاطر. 


### كيف يتم تنظيم التصنيفات

تم تغيير بعض التصنيفات من الإصدار السابق لأعلى عشر مخاطر وهنا ملخص لما تم تغيره على مستوى التصنيفات

تركز الجهود المبذولة في جمع البيانات على مجموعات فرعية من CWEs بعدد 30 مجال مع الاخذ بالاعتبار ان بعض التصنيفات الفرعية تحتاج الى بيانات ونتائج إضافية.
لذلك قررت المنظمة انها ستقوم بالتركيز على 30 تصنيف من CWEs بشكل أساسي وقد يتطلب التركيز في بعض الأحيان النظر في التصنيفات المتفرعة منها وسيكون في نطاق محدود وضيق. وكالعادة قمنا بطلب البيانات وبدون أي قيود على CWEs. وقمنا بطلب عدد من التطبيقات التي تم اختبارها لسنوات محددة (بدءًا من عام 2017)، او التطبيقات التي تم تقييمها بإصابتها بأحد CWEs على الأقل. وتسمح لنا هذه الطريقة معرفة مدى ارتباط التطبيقات بتصنيفات CWEs. مع الاخذ بعين الاعتبار اننا تجاهلنا التكرار لأسباب معينة مع الاخذ بالاعتبار انه في بعض الحالات يكون ضرورياً الاخذ به والذي قد يؤثر في بعض الأحيان في حال كان التطبيق منتشر ومشهور ومستخدم بكثرة. والجدير بالذكر ان مهما كان التطبيق مصاب سواء كان مصاب بـ 4 من CWEs او 4,000 فهذا لا يؤثر على آلية احتساب أعلى عشر مخاطر لدينا. ولقد كان لدينا تقريباً حوالي 400 CWEs وقمنا بحصرها وتقليلها الى 30 CWEs وذلك من خلال تحليل مجموعة من البيانات. وكما نخطط في المستقبل في اجراء تحليلات إضافية والتي بدورها ستنعكس على إضافة بعض من CWEs وقد يكون هناك تغير كذلك على هيكلة وتصنيف أعلى عشر مخاطر.


لقد أمضينا عدة أشهر في تجميع وتصنيف CWEs وكان من الممكن أن نستمر لأشهر إضافية. ولكن كان علينا التوقف عند نقطة ما. كما ان هناك أنواع في CWEs ما يسمى بـ “سبب جذري" و "الاعراض". وعلى سبيل المثال على "سبب جذري" كفشل التشفير او الاعدادات الخاطئة والذي يتم اقرانه بالأعراض مثل بيانات حساسة مكشوفة او حجب الخدمة. لذلك قررنا ان نركز على "السبب الجذري" قدر الإمكان وذلك لتوفر التوصيات والارشادات وطرق تلافي تلك الأسباب. كما ان التركيز على الأسباب الجذرية أكثر من الاعراض ليس مفهوم جديد، كما ان أعلى عشر مخاطر جات بشكل مختلط ما بين "الأسباب الجذرية" و "الاعراض" وهو الأسلوب المتبع في CWEs كذلك. وهدفنا ان نكون متوازنين. ان متوسط التصنيفات حسب CWEs هو 19.6 حيث حصلت A10 تزوير الطلبات من جانب الخادم SSRF على 1 CWEs و 40 CWEs لصالح A04:2021-التصميم الغير الامن . ان التحديث الذي تم على التصنيفات مفيد جداً للمنظمات من ناحية التركيز على منافع الاستفادة من التدريب على CWEs واستخدمها كلغة عمل وأطار.

### كيف يتم استخدام البيانات لبعض التصنيفات المختارة

في الإصدار السابق لعام 2017، جعلنا التصنيفات مبنيه على معدل الحدوث لتحديد احتماليتها. بعد ذلك قمنا بتصنيفهم من خلال مجموعة نقاش المبني على عقود من الخبرات في الاختراق والاستغلال والاكتشاف واحتمالية حدوثها ايضاً وماهوا الأثر التقني الذي سيحدث. لذلك أردنا في النسخة الجديدة من عام 2021 من الاستفادة من بيانات الاستغلال والأثر ان امكن ذلك.

قمنا بتنزيل " OWASP Dependency Check" واستخرجنا نتائج CVSS للاختراق والأثر التي تم جمعها سابقاً من CWEs ذات العلاقة. ولا يخفى عليكم ان هذا الجهد من البحث اخذ قدر لا باس به لان جميع CVEs لديها درجات من CVSSv2 كذلك. ولكن هنا بعض الخلل ما بين CVSSv2 وCVSSv3 والذي يجب معالجته. وسنرى في القريب ان جميع CVEs ستقوم باستخدام CVSSv3. ونود ان نلفت الانتباه ان معادلة CVSSv2 وCVSSv3 والدرجات متغيرة ومتحدثة.

في CVSSv2، من الممكن ان يصل الأثر و الاستغلال الى 10.0، ولكن بعد استخدام المعادلة قد تنخفض الى 60%  لاستغلال و 40% للتأثير. وفي CVSSv3 كان الحد الأعلى هو 6.0  للاستغلال و 4.0 للأثر. مع الاخذ بالاعتبار مدى ثقل أحدهما. وعند النظر الى CVSSv3 نرى ان الأثر ارتفع حوالي نقطة ونصف، والاستغلال انخفض بمقدر النصف نقطة تقريباً.

هناك أكثر من 125 ألف سجل من CVE تم ربطها مع CWEs في منصة NVD والتي تم استخدمها في " OWASP Dependency Check". وهناك أكثر من 241 تصنيف فرعي فريد في CWEs تم ربطها في أكثر من CVE. وهناك أكثر من 62 ألف من CWE تم ربطها في CVSSv3. والتي تمثل نصف البيانات التي تم حصرها.

في قائمة أعلى عشر مخاطر، قمنا بحساب متوسط نقاط الاستغلال والأثر بالطرق التالية. قمنا بتجميع درجات CVEs مع CVSS بواسطة CWE وقمنا بتقييم كل من الأثر والاستغلال باستخدام النسبة مئوية الموجودة في CVSSv3 بالإضافة الى جميع ما يوجد في CVSSv2 لاحتساب المتوسط الإجمالي. وبعد ذلك قمنا بربط المتوسط بـ CWEs في قاعدة البيانات وذلك لاستخدمها لتقييم درجات الأثر والاستغلال والاستفادة منها كذلك في احتساب المخاطر بناء على المعادلة المستخدمة.

## لماذا لا تكون مجرد بيانات إحصائية بحتة؟

تقتصر النتائج بشكل أساسي على ما يمكننا اختباره بشكل آلي. وحينما تتحدث الى أحد المختصين المحترفين في مجال امن التطبيقات سيخبرونك ان بعض المخرجات والاحصائيات لا يوجد لها بيانات بعد. ومع ذلك فإعداد منهجيات الاختبار تستغرق فترة من الزمن ومن ثم انت بحاجة الى المزيد من الوقت لكي تقوم بأتمتة تلك الاختبارات وتشغيلها على مجموعة كبيرة من التطبيقات. 

ولذلك قمنا باختيار ثماني تصنيفات من أصل عشرة من البيانات بسبب عدم اكتمال ونضج البيانات، التصنيفان الباقية قمنا بعمل استطلاع في صناعة الامن السيبراني. مما يسمح للمختصين بالتصويت لما يرونه من المخاطر تستحق ان تضاف الى قائمة أعلى عشر مخاطر والتي قد لا يكون لها بيانات او بيانات غير متناسقة ومناسبه.

## لماذا معدل الحدوث بدلا من التكرار؟

هناك ثلاثة مصادر أساسية للبيانات. نحددها على أنها الانسان يساعد الأدوات (HaT) ، او الأدوات تساعد الإنسان (TaH) ، او الأدوات من غير أي تعديلات.

تقوم HaT والأدوات بعمليات اكتشاف على مستوى عالي. حيث ان الأدوات تبحث عن نقاط ضعف محددة مع تجربة جميع الاحتمالات المتوقعة لاكتشاف الثغرة. وعند النظر الى ثغرة XSS والتي بالعادة اما ان تكون منخفضة الخطورة او بسيطة والتي تأتي بسبب أخطاء الأنظمة او أخطاء في عملية التصفية. وعندما تكون الثغرة بسبب خطاء في الأنظمة ترتفع نسبت تكرار الاكتشاف لهذه الثغرة والتي من الممكن ان تؤثر على مخرجات التقرير او البيانات.

ومن ناحية أخرى نجد ان TaH أخرجت لنا نطاق واسع من الثغرات ولكن مع تكرار اقل بكثير بسبب ضيق الوقت. وذلك بسبب عندما يقومون المختصين بفحص التطبيقات ويرون في بعض الأحيان مثل XSS سيقومون بإيجاد ٣ او ٤ وبعد ذلك يتوقفون عن البحث عنها وإيجاد سبب الخطاء وكتابة تقرير عنها والتوصيات الممكنة لكي تقوم بإصلاحها والتي ستقوم بإصلاح جميع التطبيق. وليس هناك حاجة او وقت للعثور على جميع الثغرات بشكل متكرر.

لنفترض اننا اخذنا مجموعتي بيانات مميزة وغير متشابهة وحاولنا دمجهما على مستوى التكرار. في هذه الحالة سنجد ان البيانات الدقيقة المستخرجة من الأدوات وHaT غير قابلة للملاحظة مع بيانات TaH. وهذا يظهر في بعض الأحيان بشكل إيجابي في بعض الثغرات مثل ثغرة XSS والذي في بعض الأحيان يقوم برفع مستوى التصنيف من منخفض الى متوسط بسبب العدد الهائل من النتائج. (ثغرات مثل XSS  من السهل اختبارها والخروج بنتائج معقولة)

في عام 2017 قمنا باستخدام معدل الحدوث بدل من القاء نظرة مره أخرى على البيانات ودمجها بشكل مناسب مع البيانات المستخرجة من الأدوات وHaT وTaH.  حيث يكون معدل الحدوث يعتمد على نسبة التطبيقات التي لديها نوع من أنواع الثغرات. وحقيقة نحن في المنظمة لا نهتم في حال كانت الثغرة واحدة معدل حدوثها متكرر. وهدفنا هو معرفة عدد التطبيقات التي لديها ثغرة واحده على الأقل. وهذا يعطينا تصور واضح من نتائج الاختبار والتي هي لدينا أفضل من اغراق البيانات بتكرار غير ذا فائدة.

## ما هي عملية جمع البيانات وتحليلها؟

We formalized the OWASP Top 10 data collection process at the Open
Security Summit in 2017. OWASP Top 10 leaders and the community spent
two days working out formalizing a transparent data collection process.
The 2021 edition is the second time we have used this methodology.

We publish a call for data through social media channels available to
us, both project and OWASP. On the [OWASP Project
page](https://owasp.org/www-project-top-ten/#div-data_2020), we list the
data elements and structure we are looking for and how to submit them.
In the [GitHub
project](https://github.com/OWASP/Top10/tree/master/2020/Data), we have
example files that serve as templates. We work with organizations as
needed to help figure out the structure and mapping to CWEs.

We get data from organizations that are testing vendors by trade, bug
bounty vendors, and organizations that contribute internal testing data.
Once we have the data, we load it together and run a fundamental
analysis of what CWEs map to risk categories. There is overlap between
some CWEs, and others are very closely related (ex. Cryptographic
vulnerabilities). Any decisions related to the raw data submitted are
documented and published to be open and transparent with how we
normalized the data.

We look at the eight categories with the highest incidence rates for
inclusion in the Top 10. We also look at the industry survey results to
see which ones may already be present in the data. The top two votes
that aren't already present in the data will be selected for the other
two places in the Top 10. Once all ten were selected, we applied
generalized factors for exploitability and impact; to help rank the Top
10 in order.

## العوامل المستخدمة مع البيانات

There are data factors that are listed for each of the Top 10
Categories, here is what they mean:

-   *CWEs Mapped*: The number of CWEs mapped to a category by the Top 10
    team.

-   *Incidence Rate*: Incidence rate is the percentage of applications
    vulnerable to that CWE from the population tested by that org for
    that year.

-   (Testing) *Coverage*: The percentage of applications tested by all
    organizations for a given CWE.

-   *Weighted Exploit*: The Exploit sub-score from CVSSv2 and CVSSv3
    scores assigned to CVEs mapped to CWEs, normalized, and placed on a
    10pt scale.

-   *Weighted Impact*: The Impact sub-score from CVSSv2 and CVSSv3
    scores assigned to CVEs mapped to CWEs, normalized, and placed on a
    10pt scale.

-   *Total Occurrences*: Total number of applications found to have the
    CWEs mapped to a category.

-   *Total CVEs*: Total number of CVEs in the NVD DB that were mapped to
    the CWEs mapped to a category.

## علاقات التصنيفات لعام 2021 مع تصنيفات عام 2017

There has been a lot of talk about the overlap between the Top Ten
risks. By the definition of each (list of CWEs included), there really
isn't any overlap. However, conceptually, there can be overlap or
interactions based on the higher-level naming. Venn diagrams are many
times used to show overlap like this.

<img src="./assets/image2.png" style="width:4.31736in;height:3.71339in" alt="Diagram Description automatically generated" />

The Venn diagram above represents the interactions between the Top Ten
2017 risk categories. While doing so, a couple of essential points
became obvious:

1.  One could argue that Cross-Site Scripting ultimately belongs within
    Injection as it's essentially Content Injection. Looking at the 2021
    data, it became even more evident that XSS needed to move into
    Injection.

2.  The overlap is only in one direction. We will often classify a
    vulnerability by the end manifestation or "symptom," not the
    (potentially deep) root cause. For instance, "Sensitive Data
    Exposure" may have been the result of a "Security Misconfiguration";
    however, you won't see it in the other direction. As a result,
    arrows are drawn in the interaction zones to indicate which
    direction it occurs.

3.  Sometimes these diagrams are drawn with everything in *A06:2021
    Using Components with Known Vulnerabilities*. While some of these
    risk categories may be the root cause of third-party
    vulnerabilities, they are generally managed differently and with
    different responsibilities. The other types are typically
    representing first-party risks.

# شكراً لكل من ساهم معنا في جمع هذه البيانات

The following organizations (along with some anonymous donors) kindly
donated data for over 500,000 applications to make this the largest and
most comprehensive application security data set. Without you, this
would not be possible.


| | | | |
| :---: | :---: | :---: | :---: |
| AppSec Labs | GitLab | Micro Focus | Sqreen |
| Cobalt.io | HackerOne | PenTest-Tools | Veracode |
| Contrast Security | HCL Technologies | Probely | WhiteHat (NTT) |
