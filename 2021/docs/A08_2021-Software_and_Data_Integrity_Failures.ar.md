# A08:2021 – فشل سلامة البرامج والبيانات

## العوامل

| CWEs Mapped | Max Incidence Rate | Avg Incidence Rate | Max Coverage | Avg Coverage | Avg Weighted Exploit | Avg Weighted Impact | Total Occurrences | Total CVEs |
|:-------------:|:--------------------:|:--------------------:|:--------------:|:--------------:|:----------------------:|:---------------------:|:-------------------:|:------------:|
| 10          | 16.67%             | 2.05%              | 75.04%       | 45.35%       | 6.94                 | 7.94                | 47,972            | 1,152      |

## نظرة عامة

تصنيف جديدة لعام 2021 تركز على وضع افتراضات تتعلق بتحديثات البرامج والبيانات الحساسة او تطبيق معايير CI/CD pipeline   من دون التحقق من سلامتها. ان أحد أكبر التأثيرات الكبيرة والموجودة في قواعد بيانات CVE /CVSSكالتالي: CWE-502الغاء تسلسل البيانات الغير موثوقة، :CWE-829تتضمن  الوظائف من مجال التحكم غير الموثوقة،  CWE-494: تحميل الشفرة المصدرية بدون التحقق من سلامتها.  

## الوصف 

فشل سلامة البيانات والبرامج تتعلق بالشفرة المصدرية والبنية التحتية الغير محمية من الانتهاكات التي تتعلق بسلامتها. على سبيل المثال، يتم ترميز وتسلسل الكائنات أو البيانات في هيكل يمكن للمهاجم أن يرى ويمكنه أيضا من اجراءات التعديلات الغير مصرح بها. مثال اخر هو عندما يعتمد التطبيق على اضافات اخرى اومكتبات او بعض الانماط الغير موثوقة او من خلال استخدام شبكات توصيل المحتوى CDNs غير الموثوق بها، ويمكن أن يودي CI / CIC الغير آمن الى إمكانية الوصول غير المصرح به او تنزيل برمجية خبيثة أو اختراق النظام. أخيرا، تتضمن العديد من التطبيقات الآن وظيفة التحديث التلقائي، حيث يتم تنزيل التحديثات دون التحقق من السلامة بشكل كافي وتثبيتها على التطبيقات التي تم الوثوق بها سابقاً. مما يمكن المهاجمين أن يقوموا بتحميل تحديثاتهم الخاصة ليتم تثبيتها وتشغيلها على جميع الأجهزة. 

##  كيفية الحماية منها 

-   تأكد من عدم إرسال البيانات المتسلسلة او الغير موقعة أو الغير المشفرة إلى عملاء غير موثوقين بدون شكل من أشكال التحقق من سلامة أو وجود توقيع رقمي لاكتشاف التلاعب بالبيانات.

-   التحقق من سلامة البرامج أو البيانات من المصدر المتوقع عبر التواقيع أو آليات مشابهة لضمان سلامة البيانات

-   تأكد من أن المكتبات والمكونات، مثل npm أو Maven، تستخدم مصادر موثوقة.

-   تأكد من استخدام أدوات الحماية عند استخدام برمجيات الطرف الثالث، مثل OWASP Dependency Check أو OWASP CycloneDX ، والتي تقوم بالتأكد من عدم وجود اي ثغرات أمنية 

-   تأكد من أن   CI / CD لديه الاعدادات المناسبة والتحكم المناسب للوصول للبرامج والبيانات لتأكد من سلامتها خلال آلية الإنشاء والنشر.

## أمثلة على سيناريوهات الهجوم

**سيناريو #1 إلغاء التسلسل الغير الآمن:** يستدعي تطبيق React مجموعة من الخدمات المصغرة لـ Spring Boot. فقد حاول المبرمجين بالتأكد من أن الشفرة المصدرية الخاص بهم غير قابل للتغيير. الحل الذي توصلوا إليه هو إجراء تسلسل لحالة المستخدم وتمريرها ذهابًا وإيابًا مع كل طلب. فقد لاحظ المهاجم توقيع كائن جافاR00 يمكنه من استخدام أداة Java Serial Killer للحصول على إمكانية التنفيذ عن بعد. 

**سيناريو #2 التحديث بدون التأكد من التواقيع:** العديد من أجهزة الموجهات المنزلية والبرامج الثابتة firmware  وغيرها لا تتحقق من صحة التواقيع الرقمية للتحديثات. تعد البرامج الثابتة غير الموقعة هدفًا للمهاجمين. فالخطر هنا أنه لا توجد آلية لإصلاحه بل انتظار الإصلاح في إصدار قادم وانتظار نهاية صلاحية الإصدارات السابقة.

**سيناريو #3 التحديثات التي استهدفت SolarWinds**: يقوم المهاجمون المتقدمون باستهداف آلية التحديث للأنظمة. ومن خلال ملاحظة الهجمة الحديثة التي استهدفت SolarWinds Orion. حيث قامت الشركة بتطوير آلية وسياسة لتأكد من سلامة عملية التحديث وامنها. ومع ذلك فقد يستطيع المهاجمون استغلالها، وقد حدث ذلك واستغلوا المهاجمين تلك الالية ولمدة أشهر حيث قاموا بحقن برمجيات التحديثات للأنظمة التي أثرت على أكثر من 18,000 نظام لأكثر من 100 منظمة حول العالم. حيث يعتبر هذا الهجوم من أخطر الهجمات التي حدثت حتى يومنا هذا. 

## المصادر

-   [OWASP Cheat Sheet: Deserialization](https://www.owasp.org/index.php/Deserialization_Cheat_Sheet)

-   [OWASP Cheat Sheet: Software Supply Chain Security]()

-   [OWASP Cheat Sheet: Secure build and deployment]()

-   [SAFECode Software Integrity Controls](https://safecode.org/publication/SAFECode_Software_Integrity_Controls0610.pdf)

-   [A 'Worst Nightmare' Cyberattack: The Untold Story Of The SolarWinds Hack](https://www.npr.org/2021/04/16/985439655/a-worst-nightmare-cyberattack-the-untold-story-of-the-solarwinds-hack)

-   <https://www.manning.com/books/securing-devops>

## قائمة الربط مع إطار CWEs

CWE-345 Insufficient Verification of Data Authenticity

CWE-353 Missing Support for Integrity Check

CWE-426 Untrusted Search Path

CWE-494 Download of Code Without Integrity Check

CWE-502 Deserialization of Untrusted Data

CWE-565 Reliance on Cookies without Validation and Integrity Checking

CWE-784 Reliance on Cookies without Validation and Integrity Checking in
a Security Decision

CWE-829 Inclusion of Functionality from Untrusted Control Sphere

CWE-830 Inclusion of Web Functionality from an Untrusted Source

CWE-915 Improperly Controlled Modification of Dynamically-Determined
Object Attributes
